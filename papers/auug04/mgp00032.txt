
OpenSSH shows how complicated this can get


46 message types.  Very strict rules for when each is allowed.



www.citi.umich.edu/u/provos/papers/privsep.pdf


