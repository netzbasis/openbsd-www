<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html>
<head>
<title>OpenBSD -current Changelog</title>
<meta name="description" content="OpenBSD -current changes">
<meta name="copyright" content="This document copyright 1996-2019 by OpenBSD.">
<meta name="viewport" content="width=device-width, initial-scale=1">
<link rel="stylesheet" type="text/css" href="openbsd.css">
<link rel="canonical" href="https://www.openbsd.org/plus.html">
</head>

<body bgcolor="#ffffff" text="#000000" link="#23238e">

<h2>
<a href="index.html">
<font color="#0000ff"><i>Open</i></font><font color="#000084">BSD</font></a>
<font color="#e00000">-current Changelog</font>
</h2>
<hr>

<p>
This selection is intended to include all important
and all user-visible changes.
For a complete record of all changes, please see the "source-changes"
mailing list, called "OpenBSD CVS"
in the <a href="mail.html#Archives">archives</a>,
or use <a href="anoncvs.html#CVS">CVS</a>.

<p>
For changes in other releases, click below:<br>
<a href="plus20.html">2.0</a>,
<a href="plus21.html">2.1</a>,
<a href="plus22.html">2.2</a>,
<a href="plus23.html">2.3</a>,
<a href="plus24.html">2.4</a>,
<a href="plus25.html">2.5</a>,
<a href="plus26.html">2.6</a>,
<a href="plus27.html">2.7</a>,
<a href="plus28.html">2.8</a>,
<a href="plus29.html">2.9</a>,
<a href="plus30.html">3.0</a>,
<a href="plus31.html">3.1</a>,
<a href="plus32.html">3.2</a>,
<a href="plus33.html">3.3</a>,
<a href="plus34.html">3.4</a>,
<a href="plus35.html">3.5</a>,
<a href="plus36.html">3.6</a>,
<br>
<a href="plus37.html">3.7</a>,
<a href="plus38.html">3.8</a>,
<a href="plus39.html">3.9</a>,
<a href="plus40.html">4.0</a>,
<a href="plus41.html">4.1</a>,
<a href="plus42.html">4.2</a>,
<a href="plus43.html">4.3</a>,
<a href="plus44.html">4.4</a>,
<a href="plus45.html">4.5</a>,
<a href="plus46.html">4.6</a>,
<a href="plus47.html">4.7</a>,
<a href="plus48.html">4.8</a>,
<a href="plus49.html">4.9</a>,
<a href="plus50.html">5.0</a>,
<a href="plus51.html">5.1</a>,
<a href="plus52.html">5.2</a>,
<a href="plus53.html">5.3</a>,
<br>
<a href="plus54.html">5.4</a>,
<a href="plus55.html">5.5</a>,
<a href="plus56.html">5.6</a>,
<a href="plus57.html">5.7</a>,
<a href="plus58.html">5.8</a>,
<a href="plus59.html">5.9</a>,
<a href="plus60.html">6.0</a>,
<a href="plus61.html">6.1</a>,
<a href="plus62.html">6.2</a>,
<a href="plus63.html">6.3</a>,
<a href="plus64.html">6.4</a>,
<a href="plus65.html">6.5</a>.
<br>

<p>
<h3><font color="#0000e0">Changes made between OpenBSD 6.5 and -current</font></h3>
<p>

<ul>
<!-- 2019/04/28 -->
<li>Added a check to <a href="https://man.openbsd.org/ospfd">ospfd(8)</a> and <a href="https://man.openbsd.org/ospf6d">ospf6d(8)</a> that any "depend on" interfaces are in the same rdomain.
<li>Changed default Ruby version in <a href="https://man.openbsd.org/ports">ports(7)</a> to 2.6.
<li>Removed the KERNEL_LOCK from the <a href="https://man.openbsd.org/bridge">bridge(4)</a> output fast-path.
<li>Cranked BUFCACHEPERCENT back down to 20 after the increase to 80 exposed a few problems.
<li>Started a cleanup of boot media creation and made the process use the new <a href="https://man.openbsd.org/vnconfig">vnconfig(8)</a> vnd-auto-allocate mode.
<li>Removed the need for the -A option from <a href="https://man.openbsd.org/vnconfig">vnconfig(8)</a>.
<li>Silenced all of the OKs from <a href="https://man.openbsd.org/signify">signify(1)</a> while it is verifying the install sets for <a href="https://man.openbsd.org/sysupgrade">sysupgrade(8)</a>.
<!-- 2019/04/27 -->
<!-- 2019/04/26 -->
<li>Modified <a href="https://man.openbsd.org/syspatch">syspatch(8)</a> to default to using cdn.openbsd.org if there isn't a proper /etc/installurl.
<li>Changed <a href="https://man.openbsd.org/sysupgrade">sysupgrade(8)</a> to re-verify the signature only for SHA256 when checking the old files.
<li>Regenerated <a href="https://man.openbsd.org/moduli">moduli(5)</a>.
<li>Imported libdrm 2.4.98.
<!-- 2019/04/25 -->
<li>Removed <a href="https://man.openbsd.org/vnconfig">vnconfig(8)</a> functionality from <a href="https://man.openbsd.org/mount_vnd">mount_vnd(8)</a>.
<li>Added <a href="https://man.openbsd.org/sysupgrade">sysupgrade(8)</a>, a tool to upgrade OpenBSD to the next release or a new snapshot.
<li>Split <a href="https://man.openbsd.org/vnconfig">vnconfig(8)</a> out of <a href="https://man.openbsd.org/mount_vnd">mount_vnd(8)</a>.
<li>Extended the maximum size of the <a href="https://man.openbsd.org/bgpd">bgpd(8)</a> shutdown communication message to 255 bytes. Made the same adjustment to <a href="https://man.openbsd.org/bgpctl">bgpctl(8)</a>.
<li>Fixed a potential panic in <a href="https://man.openbsd.org/inteldrm">inteldrm(4)</a> caused by an interrupt coming in before the interrupt handler is set up.
<li>Adjusted <a href="https://man.openbsd.org/tmux">tmux(1)</a> to automatically scroll when dragging to create a selection with the mouse when the cursor reaches the top or bottom line.
<!-- 2019/04/24 -->
<li>Added support for the USB serial adapter found in Juniper SRX 300 to <a href="https://man.openbsd.org/uslcom">uslcom(4)</a>.
<li>Used <a href="https://man.openbsd.org/unveil">unveil(2)</a> to restrict file system access in <a href="https://man.openbsd.org/relayd">relayd(8)</a> to read only.
<li>Added a watchdog for unattended upgrade to reboot after 30 minutes in case the script halts.
<li>Changed most bootloaders to boot from /bsd.upgrade if it is present.
<li>Implemented SIOCGIFSFFPAGE in <a href="https://man.openbsd.org/bnxt">bnxt(4)</a> so that <a href="https://man.openbsd.org/ifconfig">ifconfig(1)</a> can get transceiver information from it.
<!-- 2019/04/23 -->
<li>Added the <a href="https://man.openbsd.org/pci">pci(4)</a> product id for the VMware <a href="https://man.openbsd.org/nvme">nvme(4)</a> interface.
<li>Added support for <a href="https://man.openbsd.org/ccp">ccp(4)</a> at <a href="https://man.openbsd.org/acpi">acpi(4)</a>.
<li>Added <a href="https://man.openbsd.org/pinctrl">pinctrl(4)</a> support for 'pinconf-single' devices and support for bias and drive-strength properties, needed for HiSilicon SoCs. 
<li>Added the <a href="https://man.openbsd.org/octiic">octiic(4)</a> driver for OCTEON two-wire serial interfaces.
<li>Removed file name and line number output from <a href="https://man.openbsd.org/witness">witness(4)</a>, along with the wrapper for mutexes.
<li>Added -no-clear variants of copy-selection and copy-pipe to <a href="https://man.openbsd.org/tmux">tmux(1)</a> which do not clear the selection after copying.
<li>Checked for linkstate instead of IF_STA_POINTTOPOINT for originating router LSAs for P2P interfaces in <a href="https://man.openbsd.org/ospfd">ospfd(8)</a>, making 'passive' work on P2P interfaces.
<!-- 2019/04/22 -->
<li>Modified <a href="https://man.openbsd.org/vmm">vmm(4)</a> to flush guest TLB entries if the guest disables paging.
<li>Began to change only the clock frequency and skip setting voltage on arm64 systems supporting DVFS which do not expose a regulator.
<li>Added support for official Linux device tree bindings and the 'stub' clocks handling CPU clock frequency on the Hi3670.
<li>Stopped prompting for disks that do not contain a root partition during upgrades. This defaults to the correct disk when full disk encryption is in use, and will be useful for future unattended upgrades.
<!-- 2019/04/21 -->
<li>Set <a href="https://man.openbsd.org/vlan">vlan(4)</a> to use if_vinput instead of if_input, bypassing ifiqs and improving vlan input speeds.
<li>Added if_vinput so pseudo (ethernet) interfaces can bypass ifiqs, running interface input handlers directly rather than queuing the packets for a nettq to run and improving performance.
<li>Disabled <a href="https://man.openbsd.org/OpenBSD-6.4/mobileip">mobileip(4)</a>.
<li>Added support for rxprio to <a href="https://man.openbsd.org/gre">gre(4)</a>.
<li>Implemented the <a href="https://man.openbsd.org/roff">roff(7)</a> .break request, preventing infinite loops.
<li>Built <a href="https://man.openbsd.org/clang">clang(1)</a> on powerpc.
<li>Used IPL_TTY to prevent 'locking against myself' panics for drm/i915.
<li>Fixed crashes seen with the 'intel' X driver with the new <a href="https://man.openbsd.org/inteldrm">inteldrm(4)</a> kernel driver by fixing rbtree_postorder_for_each_entry_safe() implementation.
<li>Fixed unreliable 'ifconfig mode' with some wireless drivers by interpreting ENETRESET from ifm_change() as success in ifmedia_ioctl().
<!-- 2019/04/20 -->
<li>Added stdio <a href="https://man.openbsd.org/pledge">pledge(2)</a> to <a href="https://man.openbsd.org/nl">nl(1)</a> after opening a file but before doing operations.
<li>Completed conversion of <a href="https://man.openbsd.org/rdsetroot">rdsetroot(8)</a> to -lelf on alpha.
<li>Adjusted dma-range bufcache to 80% from 20%, to learn the downsides of this change based on user reports.
<li>Avoided an underflow in the rip6 delivered counter in <a href="https://man.openbsd.org/netstat">netstat(1)</a>.
<li>Fixed <a href="https://man.openbsd.org/netstat">netstat(1)</a> statistics so 'netstat -s -f inet6 -p rip6' correctly copies out rip6counters, not ip6counters.
<!-- 2019/04/19 -->
<li>Adapted radeon_detach_kms() to struct drm_device being split from drm softc. Avoids uvm_fault() when firmware is missing and <a href="https://man.openbsd.org/radeondrm">radeondrm(4)</a> is forcibly detached.
<li>Added a subsystem lock for vfs_lockf.c, allowing calling lf_advlock() and lf_purgelocks() without the kernel lock.
<li>Implemented factored-out txprio and rxprio checks.
<li>Implemented rxprio in <a href="https://man.openbsd.org/mpw">mpw(4)</a>, <a href="https://man.openbsd.org/mpe">mpe(4)</a> and <a href="https://man.openbsd.org/mpip">mpip(4)</a>. Added rxprio support to <a href="https://man.openbsd.org/etherip">etherip(4)</a> and <a href="https://man.openbsd.org/bpe">bpe(4)</a>.
<!-- 2019/04/18 -->
<li>Added support to <a href="https://man.openbsd.org/ifconfig">ifconfig(8)</a> for getting and setting rxprio, finishing support for RFC 2983. Implemented configuring rxprio in <a href="https://man.openbsd.org/vlan">vlan(4)</a>.
<li>Modified <a href="https://man.openbsd.org/pfctl">pfctl(8)</a> to always check for namespace collisions on table commands.
<li>Fixed <a href="https://man.openbsd.org/pfctl">pfctl(8)</a> table definition parsing as unprivileged user, printing a brief notice if -v was given to help find duplicate definitions by hand.
<li>Modified <a href="https://man.openbsd.org/sshd">sshd(8)</a> -T to assume any attribute not provided by -C does not match, allowing it to work when <a href="https://man.openbsd.org/sshd_config">sshd_config(5)</a> contains a Match directive with or without -C.
<!-- 2019/04/17 -->
<li>Released OpenSSH 8.0.
<li>Switched powerpc to big PIC to allow <a href="https://man.openbsd.org/clang">clang(1)</a> to build libc++abi and libc++.
<!-- 2019/04/16 -->
<li>Used txprio to control the use of exp as a priority field for <a href="https://man.openbsd.org/mpw">mpw(4)</a>, <a href="https://man.openbsd.org/mpip">mpip(4)</a> and <a href="https://man.openbsd.org/mpe">mpe(4)</a>. Intermediate LSPs can use the exp field to manage prioritization of encapsulated traffic.
<li>Prevented attaching drivers to devices for which a driver was attached early with simplebus on armv7 and arm64.
<li>Adjusted <a href="https://man.openbsd.org/myx">myx(4)</a> i2c reads to read only one byte at a time, increasing reliability.
<li>Fixed sff page reads for <a href="https://man.openbsd.org/myx">myx(4)</a> devices on little endian architectures.
<li>Rewrote <a href="https://man.openbsd.org/rdsetroot">rdsetroot(8)</a> using <a href="https://man.openbsd.org/libelf">libelf(3)</a>.
<!-- 2019/04/15 -->
<li>Imported xf86-video-amdgpu 19.0.1 for amd64 and i386.
<li>Implemented tx mitigation by calling the hardware transmit routine per several packets rather than for individual packets. Defers calls to the transmit routine to a network taskq, or until a backlog of packets has built up.
<li>Introduced 'pfctl -FR' to reset <a href="https://man.openbsd.org/pfctl">pfctl(8)</a> settings to defaults.
<li>Removed old -vlan and -vlandev code from <a href="https://man.openbsd.org/ifconfig">ifconfig(8)</a>, using these instead as aliases for -vnetid and -parent.
<!-- 2019/04/14 -->
<li>Added basic support to <a href="https://man.openbsd.org/ifconfig">ifconfig(8)</a> to display xfp and qsfp+ information.
<li>Implemented SIOCGIFSFFPAGE to allow <a href="https://man.openbsd.org/ifconfig">ifconfig(8)</a> to get transceiver information from <a href="https://man.openbsd.org/myx">myx(4)</a> devices.
<li>Applied <a href="https://man.openbsd.org/strvis">strvis(3)</a> to strings from USB devices in <a href="https://man.openbsd.org/usbdevs">usbdevs(8)</a>.
<li>Removed the potential for double-frees in copied cipher data by zeroing and freeing following EVP_CIPHER_CTX_copy() in <a href="https://man.openbsd.org/evp">evp(3)</a>. Used <a href="https://man.openbsd.org/calloc">calloc(3)</a> when allocating cipher_data to avoid use of uninitialized memory.
<li>Updated shared drm code, <a href="https://man.openbsd.org/inteldrm">inteldrm(4)</a> and <a href="https://man.openbsd.org/radeondrm">radeondrm(4)</a> to linux 4.19.34. This adds support for Intel Broxton/Apollo Lake, Amber Lake, Gemini Lake, Coffee Lake, Whiskey Lake, Cannon Lake and Ice Lake hardware.
<li>Stopped using <a href="https://man.openbsd.org/splnet">splnet(9)</a> when running the network stack now that it is using the NET_LOCK for protection, reducing latency spikes.
<!-- 2019/04/13 -->
<li>Increased information displayed for -v and -vv options for <a href="https://man.openbsd.org/tcpdump">tcpdump(8)</a> during md5 authentication.
<li>Added missing compatibles for newer Linux kernel bindings to <a href="https://man.openbsd.org/mvpinctrl">mvpinctrl(4)</a>.
<li>Fixed a leak in SSL_dup_CA_list() in <a href="https://man.openbsd.org/man3/ssl.3">ssl(3)</a>.
</ul>
<p>

</body>
</html>
