<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><title>11 - The X Window System</title>

<meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1">
<meta name="resource-type" content="document">
<meta name="description" content="OpenBSD FAQ 11 - The X Window System">
<meta name="keywords" content="openbsd,faq11">
<meta name="distribution" content="global">
<meta name="copyright" content="This document copyright 1998-2015 by OpenBSD.">
</head>

<body bgcolor="#ffffff" text="#000000">

<a href="../index.html">
<img alt="[OpenBSD]" src="../images/smalltitle.gif" border="0" height="30" width="141">    
</a>
<p>
<font color="#0000e0">
<a href="index.html">[FAQ Index]</a>
<a href="faq10.html">[To Section 10 - System Management]</a>
<a href="faq12.html">[To Section 12 - Hardware and Platform-Specific Questions]</a>
</font>

<h1><font color="#e00000">11 - The X Window System</font></h1>
<hr>

<p>
<h3>Table of Contents</h3>
<ul>
<li><a href="#Intro">11.1 - Introduction to X</a>
<li><a href="#ConfigX">11.2 - Configuring X</a>
<!-- <li><a href="#amd64i386">11.3 - Configuring X on amd64 and i386</a> -->
<li><a href="#StartingX">11.4 - Starting X</a>
<li><a href="#CustomizingX">11.5 - Customizing X</a>
</li>
</ul>

<hr>

<h2 id="Intro">11.1 - Introduction to X</h2>

The X Window System (sometimes just called "X", other times, incorrectly
called "X Windows") is the environment which provides graphics services
to OpenBSD and other Unix-based systems.
However, by itself, X provides very little: one also must have a "Window
Manager", to present a user interface.
Most of the "personality" one will feel from X will be due to the 
window manager, rather than X itself.
OpenBSD ships with a free version of the
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=fvwm&amp;sektion=1">fvwm(1)</a>
and 
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=cwm&amp;sektion=1">cwm(1)</a>
window managers, although you may wish to use any of the other window managers
that are in <a href="faq15.html">packages</a>.
Search using a key of "<tt>window manager</tt>" for a list of the many window
managers available.

<p>
X is considered a "client-server" structured protocol, however the 
terminology is sometimes confusing.
The computer with the graphics on the screen is the "X Server".
The application which directs the X server what to put on its screen
is the "X Client", even though it may be a much more powerful computer
in a data center.
This model can be used to have large, processor intensive applications
(X clients) running on a very powerful machine, using the X Server
running on a small, low power machine on your desk for their user 
interface.

<p>
It is possible to run X clients on a system without any graphical
support.
For example, one could have an application (the X client) running on an
armv7 system, displaying its output on a SPARC's graphical display (the X
server).
Since X is a well-defined, cross-platform protocol, it is even possible
to have an X application running on (for example) a Solaris machine 
use an OpenBSD machine for its display.

<p>
The client and server can also be running on the same machine, and for 
most of this section, that will be the assumption.

<h3>11.1.1 - How much computer do I need to run X?</h3>
X itself is a pretty large program, a fast computer will be appreciated
if you are starting it and stopping it regularly.
However, once running, it performs pretty responsively on a very modest
computer.
To get responsive display performance on some platforms, even for just
text, you will want to run X.
These platforms, such as <a href="../sparc.html">sparc</a> and
<a href="../sparc64.html">sparc64</a>, were intended to be used with a
graphical interface, and the text console performance is very poor.

<p>
That being said, the point of running X is usually to run X
applications.
Some X applications are very lean, others will seemingly take and use
all the processor and RAM you can give them.
Of course, some users just like to use X to provide a large number of 
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=xterm&amp;sektion=1">xterm(1)</a>s,
which can be done on very modest hardware.

<h3>11.1.2 - Can I have any kind of graphics without X?</h3>
Assuming you won't accept
<a href="http://en.wikipedia.org/wiki/ASCII_Art">ASCII graphics</a>,
that requires some kind of framebuffer console driver.
Some operating systems provide this, but there is not currently one for
OpenBSD, nor is there much interest among developers for one.

<h2 id="ConfigX">11.2 - Configuring X</h2>
<b>Good news:  In the vast majority of hardware in most platforms, X
requires no configuration at all, it Just Works.</b>

<p>
The details of manual configuration of X varies considerably from
platform to platform.
In all cases, there will be instructions and other platform-specific
information in <tt>/usr/X11R6/README</tt> in the installed system.

<p>
Several platforms require the 
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=xf86&amp;sektion=4">xf86(4)</a>
X aperture driver, which provides access to the memory and I/O 
ports of a VGA board and the PCI configuration registers required 
by the X servers.
This driver must be enabled before it is used, either by answering 
"yes" to this question during install:

<blockquote><pre>
Do you expect to run the X window System [no]
</pre></blockquote>

or by changing the value of <tt>machdep.allowaperture</tt> to the
appropriate non-zero value in <tt>/etc/sysctl.conf</tt> for your
platform, and rebooting the machine (this sysctl cannot be changed
after boot has been completed for security reasons).
There are security implications to this, so do not do this if you 
do not need it.


<h3>11.2.1 - alpha</h3>
No X server, only X clients.

<h3>11.2.2 - amd64</h3>
<a href="http://cvsweb.openbsd.org/cgi-bin/cvsweb/~checkout~/xenocara/distrib/notes/README.amd64"
>/usr/X11R6/README</a> for amd64.

<p>
In some cases, set <tt>machdep.allowaperture=2</tt> in <tt>/etc/sysctl.conf</tt>.
If needed, this is usually prompted for by the installer.

<p>
For the vast majority of users, X on amd64 auto-configures successfully,
so no further configuration is needed.

<h3>11.2.3 - armish</h3>
No X servers, only X clients.

<h3>11.2.5 - hppa</h3>
No X server, only X clients.

<h3>11.2.6 - i386</h3>
<a href="http://cvsweb.openbsd.org/cgi-bin/cvsweb/~checkout~/xenocara/distrib/notes/README.i386"
>/usr/X11R6/README</a> for i386.

<p>
In some cases, set <tt>machdep.allowaperture=2</tt> in <tt>/etc/sysctl.conf</tt>.
If needed, this is usually prompted for by the installer.

<p>
For the vast majority of users, X on i386 auto-configures successfully,
so no further configuration is needed.

<h3>11.2.7 - landisk</h3>
No X servers, only X clients.

<h3>11.2.8 - loongson</h3>
No configuration needed.

<h3>11.2.9 - luna88k</h3>
<a href="http://cvsweb.openbsd.org/cgi-bin/cvsweb/~checkout~/xenocara/distrib/notes/README.luna88k"
>/usr/X11R6/README</a> for luna88k.

<h3>11.2.10 - macppc</h3>
<a href="http://cvsweb.openbsd.org/cgi-bin/cvsweb/~checkout~/xenocara/distrib/notes/README.macppc"
>/usr/X11R6/README</a> for macppc.
   
<p>
Set <tt>machdep.allowaperture=2</tt> in <tt>/etc/sysctl.conf</tt>.

<p> 
Supported Macintosh PPC systems can be run in one of two different ways:
"accelerated" and "framebuffer" (unaccelerated).

<p>
In the "framebuffer" mode, the system will be running with 8 bits per
pixel, and the video resolution is controlled by the Macintosh
environment, so you will probably want to keep a small MacOS section on
your disk to adjust these settings.
This mode has the advantage of "Just Working", however it can be 
frustratingly inflexible (for example, altering resolution may require
booting MacOS).

<p>
If your Macintosh has an ATI-based video system, it can run using an 
accelerated X server, which gives better performance and more control
in the OpenBSD environment.
The NVIDIA video cards in some macppc systems will also work in many
cases.
The README file has details on configuring the accelerated driver, start
by using the sample file there.

<p>
While the README file details using the standard Apple one-button mouse
with X, unless you are using a laptop, it is highly recommended that you
just buy a modern third-party USB mouse with three or more buttons.

<h4>CRT iMacs and X</h4>
iMacs have a very unusual (in this day) CRT, in that it has a fixed
horizontal scan frequency.
Attempting to use a horizontal sweep speed outside a very narrow range
will cause the monitor to not light up.
The following lines, added to xorg.conf in the <tt>Section
"Monitor"</tt> area seem to make a lot of CRT-based iMacs in the 333MHz
to 500MHz range (and possibly more!) work well:

<blockquote><pre>
        HorizSync       60.0 - 60.0
        VertRefresh     43.0 - 117.0 
</pre></blockquote>

You may wish to restrict the lower limit of <tt>VertRefresh</tt> to
values that you are more likely to find acceptable, for example 70.

<h3>11.2.13 - sgi</h3>
X runs on the O2 system's frame buffer in unaccelerated mode.

<h3>11.2.14 - sparc</h3>
<a href="http://cvsweb.openbsd.org/cgi-bin/cvsweb/~checkout~/xenocara/distrib/notes/README.sparc"
>/usr/X11R6/README</a> for sparc.

<p>
With a single supported framebuffer, there is no configuration needed.
If you wish to use a multi-headed configuration, see the above README file
for details.

<p>
Resolution is controlled by the firmware before booting OpenBSD.

<h3>11.2.15 - sparc64</h3>
<a href="http://cvsweb.openbsd.org/cgi-bin/cvsweb/~checkout~/xenocara/distrib/notes/README.sparc64"
>/usr/X11R6/README</a> for sparc64.

<p>
Most simple configurations now "Just Work".
If yours does not or you wish to get fancy, see the above README file.

<h3>11.2.16 - vax</h3>
No X servers, only X clients.

<h3>11.2.17 - zaurus</h3>
<a href="http://cvsweb.openbsd.org/cgi-bin/cvsweb/~checkout~/xenocara/distrib/notes/README.zaurus"
>/usr/X11R6/README</a> for zaurus.

<p>
No configuration needed, X "Just Works".

<!--
<h2 id="amd64i386">11.3 - Configuring X on amd64 and i386</h2>
 be nice to see this section rewritten...
-->
<h2 id="StartingX">11.4 - Starting X</h2>
There are two common ways to run X:

<h3>11.4.1 - On Demand:</h3>
Log in to a console as normal, then run
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=startx&amp;sektion=1">startx(1)</a>.

<h3>11.4.2 - Boot directly into X:</h3>
This is done using
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=xdm&amp;sektion=1">xdm(1)</a>,
the X Display Manager.
xdm(1) is started as root, normally by <a href="faq10.html#rc">rc</a>,
and presents a login prompt.
Upon successful login, it starts an X session for that user.
If or when that X session should be terminated (including by hitting 
CTRL-ALT-Backspace), xdm(1) will return, prompting the user to login again.
For this reason, do NOT attempt to start xdm(1) from
<tt>/etc/rc.conf.local</tt> until you have verified X works as you wish,
or your machine may become very difficult to manage!
(worst case: boot single user, as if you <a href="faq8.html#LostPW">lost
your password</a>, and edit out the xdm_flags line in your
<tt>/etc/rc.conf.local</tt> file.)

<p>
On some platforms, you will need to disable the console
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=getty&amp;sektion=8">getty(8)</a>
to use xdm(1).

<h2 id="CustomizingX">11.5 - Customizing X</h2>

<h3>11.5.1 - Introduction</h3>
OpenBSD's default X environment is fully functional, but you may wish to
customize it.
You may wish to change the background pattern or color, or you may wish
to change the Window Manager (the program that most defines your X
environment), or change the applications that are started when X starts.

<p>
The default window manager in OpenBSD is
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=fvwm&amp;sektion=1">fvwm(1)</a>.
Fvwm is a good, general purpose window manager, but it is hardly your
only choice; it isn't even the only window manager included with OpenBSD
(see
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=cwm&amp;sektion=1">cwm(1)</a>
and
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=twm&amp;sektion=1">twm(1)</a>).
A large number of window managers are also available through
<a href="faq15.html">packages</a>.

<p>
Similar to the <a href="faq10.html#rc">system startup script</a>,
X has a process it goes through to set up the user environment.
More accurately, it has more than one process; which process is used
depends on how you <a href="#StartingX">start X</a>.
Understanding how X starts will help you understand how to customize
your work environment the way you wish it to be.

<p>
Note that you can customize the environment on both a system-wide and
user level.
It is probably best to do user level changes rather than to change the
system defaults, as the user scripts are stored in the user's home
directory, so you will have less merging of files to do when upgrading
to a new version of OpenBSD.


<h3>11.5.2 - startx(1) startup</h3>
startx(1) looks for the file <tt>.xinitrc</tt> in the user's home
directory.
<tt>.xinitrc</tt> is usually a shell script, which can start as many
X "client" (applications that use X) programs as desired.
When this script exits, the X server shuts down.
Generally, most of the programs run by this script should run in the
background, though the last one should run in the foreground (typically
the window manager); when it exits, the script will exit, and X will be
shutdown.

<p>
In the simplest case, this can be as little as just the name of the
window manager you wish to invoke:

<blockquote><pre>
cwm
</pre></blockquote>

Or you can get a little more fancy:

<blockquote><pre>
xconsole -geometry -0+0 -fn 5x7 &
oclock -geometry 75x75-0-0 &
xsetroot -solid grey &
cwm
</pre></blockquote>

That will start the
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=xconsole&amp;sektion=1">xconsole(1)</a>
which provides a copy of any text that the kernel would have sent to the
console (which is now covered by the graphical screen), an analog clock,
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=oclock&amp;sektion=1">oclock(1)</a>,
and sets the background to a solid grey background with
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=xsetroot&amp;sektion=1">xsetroot(1)</a>
all before invoking the
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=cwm&amp;sektion=1">cwm(1)</a>
window manager.
Note that only the window manager is not "backgrounded" with an "&amp;"
character.
This means that X will stay running until cwm(1) exits.

<p>
If a user's home directory does not have a <tt>.xinitrc</tt> file in it,  
the system's <tt>/etc/X11/xinit/xinitrc</tt> file is used.
This file can provide you some additional ideas for your .xinitrc
script.


<h3>11.5.3 - xdm(1) startup</h3>
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=xdm&amp;sektion=1">xdm(1)</a>
is usually started by the <a href="faq10.html#rc">system startup
scripts</a>, but for testing purposes (recommended, until you know your
have your X config right!), it can be run as root.

<p>
xdm(1) has a lot of other functionality that won't be touched on here,
but for our purposes, xdm will present the user with a login screen, get
and verify a user name and password, and then give the user their X
environment.
When X shuts down, either deliberately or accidently, xdm will start it   
back up again.
This is why you want to make sure X is configured properly before using
xdm(1), and certainly before having xdm(1) start at boot, otherwise, you
may have some difficulty getting control of the machine.

<p>
When xdm(1) starts, it runs the <tt>/etc/X11/xdm/Xsession</tt>, which
will check to see if the user has a <tt>.xsession</tt> file in their
home directory.
So, if you wish to change your default window manager, simply invoke it
(and maybe other things) in <tt>.xsession</tt>.
Again, any programs you want started with X (for example, maybe three
xterm(1)s) can be placed here, but all should be backgrounded except
for your window manager, as again, when that exits, your X session
will be ended.
In this case, xdm(1) will restart X and bring you back to a login
screen.

<h3>11.5.4 - Trying a new window manager</h3>
You can invoke a particular window manager when you load X without
altering any defaults like this:

<blockquote><pre>
$ startx /usr/local/bin/fluxbox
</pre></blockquote>

Several window managers (including cwm(1) and fvwm(1)) offer the ability
to change window managers on the fly, without restarting X or any of
your applications.
Your new window manager replaces your old one; exiting the newly-loaded
window manager terminates X, it does not return you back to your
previous window manager.
fvwm(1) allows you to start a different window manager by left clicking
on the background ("root window"), chose "(Re)Start", then pick your
preferred window manager (however, note that you will need to add
your alternative window managers to your <tt>.fvwmrc</tt> file (the
system-wide default is <tt>/usr/X11R6/lib/X11/fvwm/.fvwmrc</tt>)).
cwm(1) allows you to invoke another window manager by hitting
Ctrl-Alt-w, and typing in the manager you wish to switch to.

<p>
Once you have found a window manager you like, you can set it as the final
program run by your startup scripts as described above.

<p>
<hr>
<p>
<a href= "index.html">[FAQ Index]</a>
<a href= "faq10.html">[To Section 10 - System Management]</a>
<a href= "faq12.html">[To Section 12 - Hardware and Platform-Specific Questions]</a>
</body>
</html>
