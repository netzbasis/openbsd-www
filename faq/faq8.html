<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html>
<head>

<!-- If you make edits to any FAQ documents, please start each sentence
     on a new line, and try to keep the general formatting consistent
     with the rest of the pages -->

<title>OpenBSD FAQ: General Questions</title>
<meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1">
<meta name= "copyright"     content= "This document copyright 1998-2016
                                      by OpenBSD.">
<meta name="viewport" content="width=device-width, initial-scale=1">
<link rel="stylesheet" type="text/css" href="../openbsd.css">
<link rel="canonical" href="http://www.openbsd.org/faq/faq8.html">
</head>

<body bgcolor= "#ffffff" text= "#000000">

<h2>
<a href="../index.html">
<font color="#0000ff"><i>Open</i></font><font color="#000084">BSD</font></a>
<font color="#e00000">FAQ - General Questions</font>
<small>
<a href="index.html" style="font-weight:normal; float:right">[FAQ Index]</a>
</small>
</h2>
<hr>

<ul>
<li><a href="#LostPW"    >I forgot my root password</a>
<li><a href="#Bootloader">OpenBSD's bootloader</a>
<li><a href="#ksh"       >ksh does not appear to read my .profile</a>
<li><a href="#Journaling">Does OpenBSD support any journaling filesystems?</a>
<li><a href="#NTPerror"  >Why is my clock off by twenty-some seconds?</a>
<li><a href="#TimeZone"  >Time zones</a>
<li><a href="#RevDNS"    >Reverse DNS</a>
<li><a href="#SKey"      >Using S/Key on your OpenBSD system</a>
<li><a href="#GenNotConf">A device is recognized but says "not configured" in
                          dmesg</a>
<li><a href="#GenSupport">I have a card listed as supported but it doesn't
                          work!</a>
</ul>

<hr>

<h2 id="LostPW">I forgot my root password</h2>

The basic process to regain root is to boot into single user mode, mount
the relevant partitions (<tt>/</tt> and <tt>/usr</tt>), run
<a href="http://man.openbsd.org/passwd">passwd(1)</a>
to change the root password.
You can then boot and login normally.

<p>
The detailed process:
<ul>
<li><b>Boot into single user mode.</b>
This part of the process varies from <a href="../plat.html">platform</a>
to platform.
For amd64 and i386 platforms, the
<a href="faq14.html#BootAmd64">second stage boot loader</a>,
<a href="http://man.openbsd.org/OpenBSD-current/i386/boot">boot(8)</a>,
pauses for a few seconds to give you a chance to provide parameters
to the kernel.
The boot prompt looks like this:

<blockquote><pre>
probing: pc0 com0 com1 apm mem[636k 190M a20=on]
disk: fd0 hd0+
>> OpenBSD/i386 BOOT 3.26
boot>
</pre></blockquote>

At this point, enter <tt>boot -s</tt> to bring the system up in single
user mode:

<blockquote><pre>
boot> <b>boot -s</b>
</pre></blockquote>

Most other platforms send parameters to the kernel via the boot ROM.

<p>
Of course the problem before this will probably be getting the system to
shut down.
Most likely, this will involve hitting the reset button or the power button.
While hardly desirable, there usually isn't any alternative.
Don't worry too much, OpenBSD's file system is very robust.

<li><b>Mount the partitions.</b>
Both <tt>/</tt> and <tt>/usr</tt> will need to be mounted read-write.
Assuming they are on separate partitions (as they should be), the following
will work:

<blockquote><pre>
# <b>fsck -p / &amp;&amp; mount -uw /</b>
# <b>fsck -p /usr &amp;&amp; mount /usr</b>
</pre></blockquote>

<li><b>Run <a href="http://man.openbsd.org/passwd">passwd(1)</a>
to change the root password.</b>
As you already have root privileges (from being in single-user mode), it
will not ask you to provide your current password.

<li><b>Boot into multiuser mode.</b>
This can be done by either entering "CTRL-D" to resume the normal boot process,
or by entering the
<a href="http://man.openbsd.org/reboot">reboot(8)</a>
command.

</ul>

If this is a non-personal machine, you should probably use
<a href="http://man.openbsd.org/doas">doas(1)</a>
to give multiple (trusted) people the ability to execute root commands.

<p>
<b>"Wait.  That looked too easy!  That isn't very secure!"</b>
If an attacker has physical access to your system, they win, regardless of the
OS on the computer.
There are ways to force the use of a password on single-user mode, see
<a href="http://man.openbsd.org/ttys">ttys(5)</a>,
or eliminate the pause on i386/amd64, see
<a href="http://man.openbsd.org/OpenBSD-current/i386/boot">boot.conf(8)</a>.
Getting around those tricks is also pretty easy.
One way would be to boot from a CD or USB drive and edit (or replace) the
password file.
You can try to prevent that, but then someone will pull the hard disk out of
your computer.
Making your computer difficult to manage properly isn't real security,
and if you don't have the physical machine secured, you have no real security.

<p>
Note: many "remote management" systems give most of the functionality of
physical access to the computer, and that needs to be considered.
Don't tell yourself the system is secure if there is a way for an attacker
to grab console, insert a virtual floppy and force a reboot of the machine.
They might as well have physical access to the system.
The console management system is likely not as secure as OpenBSD.

<h2 id="Bootloader">OpenBSD's bootloader</h2>

When booting your OpenBSD system, you have probably noticed the boot prompt.

<blockquote><pre>
boot>
</pre></blockquote>

For most people, you won't have to do anything here.
It will automatically boot if no commands are given.
But sometimes problems arise, or special functions are needed.
That's where these options will come in handy.
To start off, you should read through the
<a href="http://man.openbsd.org/OpenBSD-current/i386/boot">boot(8)</a>
man page.
Here we will go over the most commonly used commands for the bootloader.

<p>
To start off, if no commands are issued, the bootloader will
automatically try to boot <tt>/bsd</tt>.
If that fails, it will try <tt>/obsd</tt>, and if that fails, it will try
<tt>/bsd.old</tt>.
You can specify a kernel by typing:

<blockquote><pre>
boot> <b>boot hd0a:/bsd</b>
</pre></blockquote>

or

<blockquote><pre>
boot> <b>b /bsd</b>
</pre></blockquote>

This will boot the kernel named <tt>bsd</tt> from the 'a' partition of
the first BIOS recognized hard disk.

<p>
Here is a brief list of options you can use with the OpenBSD kernel.
<ul>
  <li><tt>-a</tt>:
    This will allow you to specify an alternate root device after booting
    the kernel.
  <li><tt>-c</tt>:
    This allows you to enter the boot time configuration.
    Check the <a href="faq5.html#BootConfig">Boot Time Config</a> section
    of the FAQ.
  <li><tt>-s</tt>:
    This is the option to boot into single user mode.
  <li><tt>-d</tt>:
    This option is used to dump the kernel into ddb.
    Keep in mind that you must have DDB built into the kernel.
</ul>

<p>
These are entered in the format of: <b>boot [ image [-acds]]</b>

<p>
For further information you can read
<a href="http://man.openbsd.org/OpenBSD-current/i386/boot">boot(8)</a>.

<h2 id="ksh">ksh does not appear to read my <tt>.profile</tt></h2>

There are two likely reasons for <a href="http://man.openbsd.org/ksh">ksh(1)</a>
to seemingly ignore a user's <tt>.profile</tt> file.

<ul>
<li><tt>.profile</tt> is not owned by the user.
To fix for <b>username</b>,

<blockquote><pre>
# <b>chown username ~username/.profile</b>
</pre></blockquote>

<li>You are using ksh(1) from within the X Window System
<p>
Under <a href="http://man.openbsd.org/xterm">xterm(1)</a>,
<tt>argv[0]</tt> for ksh(1) is not prepended with a dash.
Prepending a dash to <tt>argv[0]</tt> will cause
<a href="http://man.openbsd.org/csh">csh(1)</a>
and ksh(1) to know they should interpret their login files.
For csh(1) that's <tt>.login</tt>, with a separate <tt>.cshrc</tt>
that is always run when csh(1) starts up.
With ksh(1), this is more noticeable because there is only one
startup script, <tt>.profile</tt>.
This file is ignored unless the shell is a login shell.
<p>
To fix this, add the line <tt>XTerm*loginShell: true</tt> to the file
<tt>.Xdefaults</tt> in your home directory.
Note, this file does not exist by default, you may have to create it.

<blockquote><pre>
$ <b>echo "XTerm*loginShell: true" >> ~/.Xdefaults</b>
</pre></blockquote>

You may not have had to do this on other systems, as some installations
of the X Window System come with this setting as default.
OpenBSD has chosen to follow the X.org behavior.
</ul>

<h2 id="Journaling">Does OpenBSD support any journaling filesystems?</h2>

No it doesn't.
We use a different mechanism to achieve similar results called soft updates.
Please read the FAQ section on <a href="faq14.html#SoftUpdates">soft updates</a>
to get more details.

<h2 id="NTPerror">Why is my clock off by twenty-some seconds?</h2>

When using
<a href="http://man.openbsd.org/rdate">rdate(8)</a>
to synchronize your clock to a NTP server, you may find your clock is
off by twenty-some seconds from your local definition of time.

<p>
This is caused by a difference between UTC (Coordinated Universal
Time, based on astronomical observations) and TAI (International
Atomic Time, based on atomic clocks).
To compensate for variations in the earth's rotation, "leap seconds" are
inserted into UTC, but TAI is unadjusted.
These leap seconds are the cause of this discrepancy.
For a more detailed description, search the web for <tt>leap seconds
UTC TAI</tt>.

<p>
Addressing the problem is fairly simple.
In most countries you will get the correct time if you use the <tt>-c</tt>
parameter to
<a href="http://man.openbsd.org/rdate">rdate(8)</a>
and use a time zone out of the directory <tt>/usr/share/zoneinfo/right</tt>.
For example, if you are located in Germany, you could use these commands:

<pre>
     # <b>cd /etc && ln -sf /usr/share/zoneinfo/right/CET localtime</b>
     # <b>rdate -ncv ptbtime1.ptb.de</b>
</pre>

In other countries, the rules may differ.

<h2 id="TimeZone">Time zones</h2>

By default, OpenBSD assumes your hardware clock is set to UTC (Universal
Coordinated Time) rather than local time, assumed by some other
operating systems, which can cause problems when
<a href="faq4.html#Multibooting">multibooting</a>.

<p>
Many other operating systems can be configured to do the same, which avoids
this problem altogether.

<p>
If having the hardware clock set to UTC is a problem, you can change the
default behavior of OpenBSD using
<a href="http://man.openbsd.org/config">config(8)</a>.
For example, to configure OpenBSD to use a hardware clock set to
US/Eastern (5 hours behind UTC, so 300 minutes):

<blockquote><pre>
# <b>config -ef /bsd</b>
[...]
Enter 'help' for information
ukc> <b>timezone 300</b>
timezone = 300, dst = 0
ukc> <b>quit</b>
Saving modified kernel.
</pre></blockquote>

See
<a href="http://man.openbsd.org/options">options(4)</a>
and search for option "TIMEZONE=value" for more information.

<p>
Normally, the time zone is set during install.
If you have need to change the time zone, you can create a new symbolic
link to the appropriate time zone file in <tt>/usr/share/zoneinfo</tt>.
For example, to set the machine to use EST5EDT as the new local time
zone:

<blockquote><pre>
# <b>ln -fs /usr/share/zoneinfo/EST5EDT /etc/localtime</b>
</pre></blockquote>

See also:
<ul>
<li><a href="http://man.openbsd.org/date">date(1)</a>
<li><a href="faq6.html#OpenNTPD">OpenBSD's NTPD</a>
</ul>

<h2 id="RevDNS">Reverse DNS</h2>

Many new users to OpenBSD experience a two minute login delay when using
services such as
<a href="http://man.openbsd.org/ssh">ssh(1)</a> or
<a href="http://man.openbsd.org/ftp">ftp(1)</a>.
This can also be experienced when using a proxy, such as
<a href="http://man.openbsd.org/ftp-proxy">ftp-proxy(8)</a>,
or when sending mail.

<p>
This is almost always due to a reverse-DNS problem.
DNS is the Domain Name Service, the system the Internet uses to convert a name,
such as "www.openbsd.org", into a numeric IP address.
Another task of DNS is the ability to take a numeric address and convert it
back to a name.
This is known as a Reverse DNS entry.

<p>
In order to provide better logging, OpenBSD performs a reverse DNS
lookup on any machine that attaches to it in many different ways,
including
<a href="http://man.openbsd.org/ssh">ssh(1)</a>,
<a href="http://man.openbsd.org/ftp">ftp(1)</a>,
<a href="http://man.openbsd.org/ftp-proxy">ftp-proxy(8)</a>.
Unfortunately, in some cases, the machine that is making the connection
does not have a proper reverse DNS entry.

<h3>An example of this situation:</h3>

A user sets up an OpenBSD box as a firewall and gateway to their
internal home network, mapping all their internal computers to one
external IP using <a href="pf/nat.html">NAT</a>.
They may also use it as an outbound mail relay.
They follow the installation guidelines, and are very happy with the results,
except for one thing -- every time they try to attach to the box in any way,
they end up with a two minute delay before things happen.

<h3>What is going on:</h3>

From a workstation behind the NAT of the gateway with an
<a href="http://tools.ietf.org/html/rfc1918">unregistered IP</a>
address of 192.168.1.35, the user uses
<a href="http://man.openbsd.org/ssh">ssh(1)</a>
to access the gateway system.
The <a href="http://man.openbsd.org/ssh">ssh(1)</a>
client prompts for username and password, and sends them to the gateway box.
The gateway then tries to figure out who is trying to log in by performing a
reverse DNS lookup of 192.168.1.35.
The problem is 192.168.0.0 addresses are for private use, so a properly
configured DNS server outside your network knows it should have no information
about those addresses.
Some will quickly return an error message.
In these cases, OpenBSD will assume there is no more information to be gained,
and it will quickly give up and just admit the user.
Other DNS servers will not return ANY response.
In this case, you will find yourself waiting for the OpenBSD name resolver to
time out, which takes about two minutes before the login will be permitted to
continue.
In the case of
<a href="http://man.openbsd.org/ftp-proxy">ftp-proxy(8)</a>,
some ftp clients will timeout before the reverse DNS query
times out, leading to the impression that ftp-proxy isn't working.

<p>
This can be quite annoying.
Fortunately, it is an easy thing to fix.

<h3>Fix, using <tt>/etc/hosts</tt>:</h3>

The simplest fix is as follows:
Populate your
<a href="http://man.openbsd.org/hosts">hosts(5)</a>
file with all the workstations you have in your internal network.
Make sure that your
<a href="http://man.openbsd.org/resolv.conf">resolv.conf(5)</a>
file contains the line <tt>lookup file bind</tt>.
This tells the resolver to start with the
<a href="http://man.openbsd.org/hosts">hosts(5)</a> file,
and failing that, to use the DNS servers specified by the <tt>nameserver</tt>
lines in your
<a href="http://man.openbsd.org/resolv.conf">resolv.conf(5)</a> file.

<p>
Your <tt>/etc/hosts</tt> file will look something like this:

<blockquote><pre>
::1 localhost.in.example.org localhost
127.0.0.1 localhost.in.example.org localhost
192.168.1.1 gw.in.example.org gw
192.168.1.20 scrappy.in.example.org scrappy
192.168.1.35 shadow.in.example.org shadow
</pre></blockquote>

Your <tt>/etc/resolv.conf</tt> file will look something like this:

<blockquote><pre>
search in.example.org
nameserver 24.2.68.33
nameserver 24.2.68.34
lookup file bind
</pre></blockquote>

A common objection to this is "But, I use DHCP for my internal network!
How can I configure my <tt>/etc/hosts</tt>?"
Rather easily, actually.
Just enter lines for all the addresses your DHCP server is going to
give out, plus any static devices:

<blockquote><pre>
::1 localhost.in.example.org localhost
127.0.0.1 localhost.in.example.org localhost
192.168.1.1 gw.in.example.org gw
192.168.1.20 scrappy.in.example.org scrappy
192.168.1.35 shadow.in.example.org shadow
192.168.1.100 d100.in.example.org d100
192.168.1.101 d101.in.example.org d101
192.168.1.102 d102.in.example.org d102
         [... snip ...]
192.168.1.198 d198.in.example.org d198
192.168.1.199 d199.in.example.org d199
</pre></blockquote>

This case assumes you have the DHCP range set to 192.168.1.100
through 192.168.1.199, plus the three static definitions as listed at
the top of the file.

<p>
If your gateway must use DHCP for configuration, you may well find you
have a problem --
<a href="http://man.openbsd.org/dhclient">dhclient(8)</a>
will overwrite your <tt>/etc/resolv.conf</tt> every time the lease is
renewed, which will remove the <tt>lookup file bind</tt> line.
This can be solved by putting the line <tt>lookup file bind</tt> in the file
<tt>/etc/resolv.conf.tail</tt>.

<h3>Fix, using a local DNS server</h3>

Details on this are somewhat beyond the scope of this document, but the
basic trick is to set up your favorite DNS server, and make sure it knows
it is authoritative for both forward and reverse DNS resolution for all
nodes in your network, and make sure your computers (including your
gateway) know to use it as a DNS server.

<h2 id="SKey">Using S/Key on your OpenBSD system</h2>

S/Key is a "one-time password" authentication system.
It generates a sequence of one-time (single use) passwords from a user's
secret passphrase along with a challenge received from the server, by means of a
hash function:
<a href="http://man.openbsd.org/md5">md5</a>,
<a href="http://man.openbsd.org/sha1">sha1</a> or
<a href="http://man.openbsd.org/rmd160">rmd160</a>.

<blockquote>
<b>WARNING:</b>
One-time password systems only protect authentication information.
They do not prevent network eavesdroppers from gaining access to private
information.
Furthermore, if you are accessing a secure system A, it is recommended that
you do this from another trusted system B, to ensure nobody is gaining access
to system A by logging your keystrokes or by capturing and/or forging input
and output on your terminal devices.
</blockquote>

<h3>Setting up S/Key</h3>

To start off, the directory <tt>/etc/skey</tt> must exist.
If this directory doesn't exist, have the superuser create it by doing:

<blockquote><pre>
# <b>skeyinit -E</b>
</pre></blockquote>

Then use
<a href="http://man.openbsd.org/skeyinit">skeyinit(1)</a>
to initialize your S/Key.
You will first be prompted for your login password, then you will be asked for
your S/Key secret passphrase, which must be at least 10 characters long:

<blockquote><pre>
$ <b>skeyinit</b>
Reminder - Only use this method if you are directly connected
           or have an encrypted channel.  If you are using telnet,
           exit with no password and use skeyinit -s.
Password:
[Adding ericj with md5]
Enter new secret passphrase:
Again secret passphrase:

ID ericj skey is otp-md5 100 oshi45820
Next login password: HAUL BUS JAKE DING HOT HOG
</pre></blockquote>

Notice the information in the last two lines.
The program used to create your S/Key password is
<a href="http://man.openbsd.org/otp-md5">otp-md5(1)</a>,
the sequence number is <tt>100</tt> and the secret key is <tt>oshi45820</tt>.
The six small words <tt>HAUL BUS JAKE DING HOT HOG</tt> constitute the S/Key
password with sequence number <tt>100</tt>.

<h3>Generating S/Key passwords</h3>
To generate the S/Key password for the next login, use
<a href="http://man.openbsd.org/skeyinfo">skeyinfo(1)</a>
to find out what command to run:

<blockquote><pre>
$ <b>skeyinfo -v</b>
otp-md5 95 oshi45820
$ <b>otp-md5 95 oshi45820</b>
Reminder - Do not use this program while logged in via telnet.
Enter secret passphrase:
NOOK CHUB HOYT SAC DOLE FUME
</pre></blockquote>

In order to generate a list of S/Key passwords, do:

<blockquote><pre>
$ <b>otp-md5 -n 5 95 oshi45820</b>
Reminder - Do not use this program while logged in via telnet.
Enter secret passphrase:
91: SHIM SET LEST HANS SMUG BOOT
92: SUE ARTY YAW SEED KURD BAND
93: JOEY SOOT PHI KYLE CURT REEK
94: WIRE BOGY MESS JUDE RUNT ADD
95: NOOK CHUB HOYT SAC DOLE FUME
</pre></blockquote>

<h3>Using S/Key to log in</h3>

Here is an example session using S/Key to log in to an ftp server on
<tt>localhost</tt>.
To perform an S/Key login, you append <tt>:skey</tt> to your login name.

<blockquote><pre>
$ <b>ftp localhost</b>
Connected to localhost.
220 oshibana.shin.ms FTP server (Version 6.5/OpenBSD) ready.
Name (localhost:ericj): <b>ericj:skey</b>
331- otp-md5 93 oshi45820
331 S/Key Password: <b>JOEY SOOT PHI KYLE CURT REEK</b>
[...]
230 User ericj logged in.
Remote system type is UNIX.
Using binary mode to transfer files.
ftp> <b>quit</b>
221 Goodbye.
</pre></blockquote>

Similarly, for
<a href="http://man.openbsd.org/ssh">ssh(1)</a> or
<a href="http://man.openbsd.org/telnet">telnet(1)</a>:

<blockquote><pre>
$ <b>ssh -l ericj:skey localhost</b>
otp-md5 91 oshi45821
S/Key Password: <b>SHIM SET LEST HANS SMUG BOOT</b>
Last login: Thu Apr  7 12:21:48 on ttyp1 from 156.63.248.77
$
</pre></blockquote>

<h2 id="GenNotConf">My device is recognized but says "not configured"
in dmesg</h2>

In short, it means your device is not supported by the kernel you are using,
so you will not be able to use it.

<p>
PCI and many other types of devices offer identifying information so that
the OS can properly recognize and support devices.
Adding recognition is easy, adding support is often not.
Here are two examples of "not configured" devices:

<blockquote><pre>
[...]
vendor "Intel", unknown product 0x5201 (class network subclass ethernet,
rev 0x03) at pci2 dev 9 function 1 not configured
[...]
"Intel EE Pro 100" rev 0x03 at pci2 dev 10 function 0 not configured
[...]
</pre></blockquote>

The first one (a network adapter) had its vendor code identified and the
general type of card was determined, but not the precise model of the card.
The second example is another network adapter, this one a developer had
seen and entered into the identification file that is used to identify
the card.
In both cases, however, the cards will be non-functional, as both are
shown as <tt>not configured</tt>, meaning no driver has attached to the card.

<h4>What can I do about a "not configured" device?</h4>

<ul>
<li>If the device or card you are seeing is not one you need, you can safely
ignore the <tt>not configured</tt> devices, they will not hurt your system.
Some "special purpose" devices are deliberately left unconfigured so the
system's BIOS will handle them.

<li>In some cases, it is just a variation of an already supported device,
in which case, it may be relatively easy for a developer to add support
for the new card.
In other cases, it may be a totally unsupported chip set or implementation
(such as the above examples).
In that case, a new driver would have to be written, which may not even
be possible if the device is not fully documented.
You are certainly welcome to write a driver for the device yourself.

<li>If you are running an install kernel, the device may not be supported
by the install media you used, but may be supported by a different boot disk.

<li>If you are running a modified kernel, you may have removed support for
a device you now need.
In general, removing devices from a kernel is a bad idea.
This is one reason why.

<li>Before reporting a <tt>not configured</tt> device, make sure you
have first tested the most recent <a href="faq5.html#Flavors">snapshot</a>,
as support may already have been added, and check the <a href="../mail.html">
mailing list archives</a> to see if the issue has been discussed already.
Remember, however, if you are using an older version of OpenBSD, you
will generally have to upgrade to get the benefit of any new drivers.
</ul>

<h2 id="GenSupport">I have a card listed as supported but it doesn't work!</h2>

Unfortunately, many manufacturers use product model numbers to indicate
marketplace position, rather than the technical nature of a product.
For this reason, you may buy a product with the same name or model number
as a product listed in the <a href="../plat.html">platform pages</a>, but
end up with a totally different product that may not work with OpenBSD.

<p>
For example, many early wireless network adapters were based on the Prism2
chipset, using the <a href="http://man.openbsd.org/wi">wi(4)</a>
driver, but later, when lower-cost chips became available, many manufacturers
changed their product to use chips for which no open source drivers exist,
but never changed their model numbers.
Wireless network adapters, unfortunately, are far from the only example
of this.

<p>
</body>
</html>
