<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html>
<head>
<title>Following -current</title>
<meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1">
<meta name= "resource-type" content= "document">
<meta name= "description"   content= "the OpenBSD FAQ page">
<meta name= "keywords"      content= "openbsd,faq">
<meta name= "distribution"  content= "global">
<meta name= "copyright"     content= "This document copyright 2005-2014 by OpenBSD">
</head>

<body bgcolor= "#ffffff" text= "#000000">
<a href="../index.html">
<img alt="[OpenBSD]" height=30 width=141 src="../images/smalltitle.gif" border="0">
</a>
<p>
<font color= "#0000e0">
<a href= "index.html">[FAQ Index]</a>
</font>

<p>

<h1><font color="#e00000">Following <i>-current</i></font></h1>
<hr>

<h3>Table of Contents</h3>
<p>
<ul>
<li><a href="#Intro">Introduction</a>
<!-- Oldest on top... -->
<!-- New additions go on the bottom, please -->
<li><a href="#20140813">2014/08/13 - X resource files moved to /usr/X11R6/share/X11</a>
<li><a href="#20140822">2014/08/22 - BIND has moved to ports</a>
<li><a href="#20140826">2014/08/26 - openssl(1) moved to /usr/bin</a>
<li><a href="#20140826b">2014/08/26 - nginx has moved to ports</a>
<li><a href="#20140829">2014/08/29 - puppetdb split single config file into multiple files</a>
<li><a href="#20140908">2014/09/08 - procfs removed</a>
<li><a href="#20140915">2014/09/15 - sendmail moved to packages, updated</a>
<li><a href="#20140919">2014/09/19 - rc.conf(8) moved to the base set</a>
<li><a href="#20140925">2014/09/25 - [ports] collectd updated to 5.4.1</a>
<li><a href="#20141013">2014/10/13 - lkm removed</a>
<li><a href="#20141030">2014/10/30 - [ports] symon package split</a>
<li><a href="#20141031">2014/10/31 - libressl renamed to libtls</a>
<li><a href="#20141031b">2014/10/31 - [ports] sendmail port uid/gid change</a>
<li><a href="#20141106">2014/11/06 - [ports] php version bump</a>
<li><a href="#20141117">2014/11/17 - /var/tmp becomes a symlink to /tmp</a>
<li><a href="#20141120">2014/11/20 - login.conf and crypt changes</a>
<li><a href="#20141123">2014/11/23 - sparc64 switched to new installboot(8)</a>
</ul>

<hr>

<!-- XXXversion -->
<h2 id="Intro">Introduction</h2>
This document is for people who wish to follow <i>-current</i>.
It contains information about changes from 5.6-release to <i>-current</i>,
and should NOT be used by anyone upgrading from 5.5 or earlier, or people
wishing to follow <a href="../stable.html"><i>-stable</i></a>.

<p>
If you wish to upgrade to 5.6-release or 5.6-stable from previous
versions, see the <a href="upgrade56.html">upgrade guide</a>.

<p>
Make sure you have read and understood
<a href="faq5.html">FAQ 5 - Building the System from Source</a>
before using -current and the instructions below.

<p>
You should ALWAYS use a snapshot as the starting point for running
<i>-current</i>.
Upgrading by compiling your own source code is not supported.

<p>
Most of these changes will have to be performed as root.

<h3 id="20140813">2014/08/13 - X resources files moved to /usr/X11R6/share/X11/</h3>
The X resource files have moved their installation directory
from <tt>/etc/X11/app-defaults/</tt>
to <tt>/usr/X11R6/share/X11/app-defaults/</tt>
<tt>/etc/X11/app-defaults</tt> stays 1st in the libXt search path so, people
and ports can put customized versions there if needed.
If you didn't customize the versions in <tt>/etc/X11/app-defaults</tt>, they
should be removed to avoid future issues when one file changes:
<pre>
	cd /etc/X11/app-defaults
	rm Beforelight Bitmap Bitmap-color Bitmap-nocase Chooser Clock-color 
	rm Editres Editres-color KOI8RXTerm SshAskpass UXTerm Viewres
	rm Viewres-color XCalc XCalc-color XClipboard XClock
	rm XClock-color XConsole XFontSel XLoad XLock XLogo
	rm XLogo-color XMore XSm XTerm XTerm-color Xedit
	rm Xedit-color Xfd Xgc Xgc-color Xmag Xman Xmessage
	rm Xmessage-color Xsystrace Xvidtune
</pre>

<h3 id="20140822">2014/08/22 - BIND has moved to ports</h3>
named(8) a.k.a. BIND has been removed from the base OS.
In many cases, unbound(8) and nsd(8) will make good replacements,
however users with some configurations (for example split horizon
DNS) may find it simpler to continue with BIND (which is available
in packages). The old binaries and manual pages should be removed:
<pre>
	rm -f /etc/rc.d/named
	rm -f /usr/sbin/dnssec-keygen
	rm -f /usr/sbin/dnssec-signzone
	rm -f /usr/sbin/named
	rm -f /usr/sbin/named-checkconf
	rm -f /usr/sbin/named-checkzone
	rm -f /usr/sbin/nsupdate
	rm -f /usr/sbin/rndc
	rm -f /usr/sbin/rndc-confgen
	rm -f /usr/share/man/man5/named.conf.5
	rm -f /usr/share/man/man5/rndc.conf.5
	rm -f /usr/share/man/man8/dnssec-keygen.8
	rm -f /usr/share/man/man8/dnssec-signzone.8
	rm -f /usr/share/man/man8/named.8
	rm -f /usr/share/man/man8/named-checkconf.8
	rm -f /usr/share/man/man8/named-checkzone.8
	rm -f /usr/share/man/man8/nsupdate.8
	rm -f /usr/share/man/man8/rndc-confgen.8
	rm -f /usr/share/man/man8/rndc.8
</pre>
If you would like to move to BIND from packages, install it:
<pre>
	pkg_add isc-bind
</pre>
This will run as a different user id ("_bind" instead of "named"),
so check that file and directory permissions permit access - in many
cases, this should work:
<pre>
	find /var/named -group named -print0 | xargs -r0 chgrp _bind
</pre>
To enable startup at boot time:
<pre>
	rcctl enable isc_named
</pre>
<b>Caution</b>: as this is from a package, it will start relatively late
in the boot process, so if you normally have 'nameserver 127.0.0.1' or
similar in resolv.conf and require working name resolution during system
startup, you may need to make alternative arrangements.
Options include running unbound on localhost only, or adding a fallback
server to /etc/resolv.conf.

<h3 id="20140826">2014/08/26 - openssl(1) has moved to /usr/bin</h3>
The openssl(1) binary has moved from /usr/sbin to /usr/bin.
As such, the old binary should be removed:
<pre>
	rm -f /usr/sbin/openssl
</pre>

<h3 id="20140826b">2014/08/26 - nginx has moved to ports</h3>
nginx(8) has been removed from the base OS.
The old binaries and manual pages should be removed:
<pre>
	rm -f /etc/rc.d/nginx
	rm -f /usr/sbin/nginx
	rm -f /usr/share/man/man8/nginx.8
	rm -f /usr/share/man/man5/nginx.conf.5
</pre>
If you would like to move to nginx from packages, install it:
<pre>
	pkg_add nginx
</pre>
To enable startup at boot time:
<pre>
	rcctl enable nginx
</pre>
<b>Caution</b>: as the nginx package is using the same rc.d script that was
used by the base system it is mandatory to remove the old nginx rc.d script
to avoid installation issues of the nginx packages.

<h3 id="20140829">2014/08/29 - puppetdb split single config file into multiple files</h3>
With puppetdb-2.1.0p1 the single puppetdb.ini file was split into multiple
.ini files. The configuration needs to be adapted after upgrade. More
information in the puppetdb package README.

<h3 id="20140908">2014/09/08 - procfs removed</h3>
procfs has been removed, thus the binary and manual page should be deleted:
<pre>
	rm -f /sbin/mount_procfs
	rm -f /usr/share/man/man8/mount_procfs.8
</pre>

<h3 id="20140915">2014/09/15 - sendmail moved to packages, updated</h3>
Sendmail has moved from the base OS to packages.
The following binaries, libraries, headers, and manual pages should
be deleted:
<pre>
	rm -rf /usr/include/libmilter
	rm -rf /usr/libdata/perl5/site_perl/`uname -p`-openbsd/libmilter
	rm -rf /usr/libexec/sendmail
	rm -rf /usr/share/sendmail  # preserve mc files first if needed
	
	rm -f /etc/rc.d/sendmail
	rm -f /usr/lib/{libmilter.a,libmilter.so.3.0,libmilter_p.a}
	rm -f /usr/libexec/smrsh
	rm -f /usr/sbin/{editmap,mailstats,praliases}
	rm -f /usr/share/man/man1/{hoststat.1,praliases.1,purgestat.1}
	rm -f /usr/share/man/man8/{editmap.8,mailq.8,mailstats.8,smrsh.8}
	rm -f /var/log/sendmail.st

	rmdir /usr/libexec/sm.bin

	userdel smmsp
	groupdel smmsp
</pre>

If you are going to continue to use sendmail, install it from packages
and adjust permissions:

<pre>
	pkg_add sendmail
	chown -R _smmsp:_smmsp /var/spool/clientmqueue
</pre>

If you will be moving to another MTA, for example <a href="http://www.openbsd.org/cgi-bin/man.cgi/OpenBSD-current/man8/smtpd.8">smtpd(8)</a>,
check that there is nothing you need to keep (e.g. unsent messages in the
queue), then the following files can be removed:

<pre>
	rm -f /etc/mail/{README,access,access.db,genericstable,genericstable.db}
	rm -f /etc/mail/{helpfile,local-host-names,localhost.cf,mailertable}
	rm -f /etc/mail/{mailertable.db,relay-domains,sendmail.cf,submit.cf}
	rm -f /etc/mail/{trusted-users,virtusertable,virtusertable.db}

	rm -rf /var/spool/clientmqueue
	rm -rf /var/spool/mqueue
</pre>

<h3 id="20140919">2014/09/19 - rc.conf(8) moved to the base set</h3>
/etc/rc.conf has moved away from the <i>etc</i> to the <i>base</i> set.<br><br>
Effectively this means that:<br>
<b>any manual changes made to /etc/rc.conf will be lost
at next upgrade.
If such changes were made, they must be merged into /etc/rc.conf.local</b>.<br><br>
Note that a backup version of rc.conf(8) can be found under /var/backups/.

<h3 id="20140925">2014/09/25 - [ports] collectd updated to 5.4.1</h3>
<tt>sysutils/collectd</tt> has been updated to version 5.4.1, users of previous
4.10.1 version should review this
<a href="https://collectd.org/wiki/index.php/V4_to_v5_migration_guide">upgrade guide</a>
to migrate their existing setups.

<h3 id="20141013">2014/10/13 - lkm removed</h3>
The lkm interface has been removed; thus several binaries, manual pages,
the lkm directory, and the group _lkm should be removed:
<pre>
	rm -rf /usr/lkm /usr/share/lkm /dev/lkm
	rm -f /usr/bin/modstat
	rm -f /sbin/mod{,un}load
	rm -f /usr/share/man/man8/mod{stat,load,unload}.8
	rm -f /usr/share/man/man4/lkm.4
	rm -f /usr/share/mk/bsd.lkm.mk /usr/include/sys/lkm.h
	groupdel _lkm
</pre>


<h3 id="20141030">2014/10/30 - [ports] symon package split</h3>
The split between subpackages for symon has been adjusted.
Depending on which subpackage you installed previously, you may lose
the "symux" monitor after a pkg_add -u, if so, just run "pkg_add symux".


<h3 id="20141031">2014/10/31 - libressl renamed to libtls</h3>
The libressl library has been renamed to libtls to avoid confusion and to make
it easier to distinguish between LibreSSL (the project) and libressl (the
library). There are several files that should be removed post update:
<pre>
	rm -f /usr/include/ressl.h
	rm -f /usr/lib/libressl.* /usr/lib/libressl_*
	rm -f /usr/share/man/man3/ressl_*
</pre>

<h3 id="20141031b">2014/10/31 - [ports] sendmail port uid/gid change</h3>
<!-- XXX bug in post-5.6 port; doesn't affect 5.6->5.7 so skip for upgrade57.html -->
The uid and gid used by the enqueuer have changed.
<pre>
	/etc/rc.d/sendmail stop
	groupmod -g 745 _smmsp
	usermod -u 745 -g 745 _smmsp
	chown -R _smmsp:_smmsp /var/spool/clientmqueue
	chgrp _smmsp /usr/local/libexec/sendmail/sendmail
	chmod g+s /usr/local/libexec/sendmail/sendmail
	/etc/rc.d/sendmail start
</pre>

<h3 id="20141106">2014/11/06 - [ports] php version bump</h3>
The default version of PHP has been switched to 5.5.
After updating to new packages when they are available, you will need
to move the configuration across from 5.4.
Check for local changes in /etc/php-5.4.ini and apply them to php-5.5.ini,
and create new symbolic links for any required extensions in /etc/php-5.5.
For the common case where you would like to keep existing extensions
you can do this:

<pre>
	cd /etc/php-5.4
	for i in *; do ln -s ../php-5.5.sample/$i ../php-5.5/; done
</pre>

pecl-APC does not support newer PHP versions and has been retired;
xcache is still available, or you can use the new opcode cache built-in
to 5.5:

<pre>
	ln -s ../php-5.5.sample/opcache.ini /etc/php-5.5
</pre>

<h3 id="20141117">2014/11/17 - /var/tmp becomes a symlink to /tmp</h3>
/var/tmp is now a symlink to /tmp.  Recommend updating the
/etc/daily script (with sysmerge or by hand), since the /tmp
purge has been adjusted for vi.recover, and extended to 7 days.

<pre>
	rm -r /var/tmp
	ln -s /tmp /var/tmp
</pre>

<h3 id="20141120">2014/11/20 - login.conf and crypt changes</h3>
Support for creating DES hashed passwords has been removed from most userland
utilities. <em>login.conf</em> only supports the blowfish option; this
was previously the default for <em>localcipher</em>. Additionally, the
<em>ypcipher</em> capability is no longer used; the localcipher cap will
be used for both local and YP passwords. These changes should not affect default
installations.

<h3 id="20141123">2014/11/23 - sparc64 switched to new installboot(8)</h3>
The sparc64 architecture has been switched to the new installboot(8)
implementation /usr/sbin/installboot. Old installboot files can be removed:

<pre>
	rm /usr/mdec/installboot /usr/share/man/man8/sparc64/installboot.8
</pre>


<br>
<hr>
<small>$OpenBSD: current.html,v 1.578 2014/12/02 07:03:51 bentley Exp $</small>

</body>
</html>
