<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html>
<head>
<title>Following -current</title>
<meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1">
<meta name= "description"   content= "the OpenBSD FAQ page">
<meta name= "copyright"     content= "This document copyright 2005-2015 by OpenBSD">
<link rel="canonical" href="http://www.openbsd.org/faq/current.html">
</head>

<body bgcolor= "#ffffff" text= "#000000">
<a href="../index.html">
<img alt="[OpenBSD]" height=30 width=141 src="../images/smalltitle.gif" border="0">
</a>
<p>
<font color= "#0000e0">
<a href= "index.html">[FAQ Index]</a>
</font>

<p>

<h1><font color="#e00000">Following <i>-current</i></font></h1>
<hr>

<h3>Table of Contents</h3>
<p>
<ul>
<li><a href="#Intro">Introduction</a>
<!-- Oldest on top... -->
<!-- New additions go on the bottom, please -->
<li><a href="#20150404">2015/04/04 - [ports] rc script name changes</a>
<li><a href="#20150424">2015/04/24 - tip(1) removed</a>
<li><a href="#20150427">2015/04/27 - _file user added</a>
<li><a href="#20150428">2015/04/28 - sshd default changed to PermitRoot no</a>
<li><a href="#20150502">2015/05/02 - pf_rules and ipsec_rules removed from rc.conf(5)</a>
<li><a href="#20150515">2015/05/15 - [ports] www/apache-httpd update to 2.4.12</a>
<li><a href="#20150517">2015/05/17 - isatty(3) depends on new feature in fcntl(2)</a>
<li><a href="#20150518">2015/05/18 - spamd(8) PF rule change: rdr-to to divert-to</a>
<li><a href="#20150523">2015/05/23 - ipsec.conf(5) default Diffie-Hellman group change</a>
<li><a href="#20150528">2015/05/28 - CUPS GTK+2 plugin is now in a separate package</a>
<li><a href="#20150601">2015/06/01 - alpha switches to <i>secureplt</i></a>
<li><a href="#20150602">2015/06/02 - sparc switches to PIE</a>
<li><a href="#20150605">2015/06/05 - [ports] default PHP version switched to 5.6</a>
</ul>

<hr>

<!-- XXXversion -->
<h2 id="Intro">Introduction</h2>
This document is for people who wish to follow <i>-current</i>.
It contains information about changes from 5.7-release to <i>-current</i>,
and should NOT be used by anyone upgrading from 5.6 or earlier, or people
wishing to follow <a href="../stable.html"><i>-stable</i></a>.

<p>
If you wish to upgrade to 5.7-release or 5.7-stable from previous
versions, see the <a href="upgrade57.html">upgrade guide</a> instead,
as what is here does not apply to 5.7.

<p>
Make sure you have read and understood
<a href="faq5.html">FAQ 5 - Building the System from Source</a>
before using -current and the instructions below.

<p>
You should ALWAYS use a snapshot as the starting point for running
<i>-current</i>.
Upgrading by compiling your own source code is not supported.

<p>
Most of these changes will have to be performed as root.


<h3 id="20150404">2015/04/04 - [ports] rc script name changes</h3>
The rc scripts for some ports have changed their name to better match
the original upstream names and/or binary name:
<ul>
  <li><tt>dbus_daemon</tt> &#8594; <tt>messagebus</tt></li>
  <li><tt>puppetmasterd</tt> &#8594; <tt>puppetmaster</tt></li>
  <li><tt>puppetd</tt> &#8594; <tt>puppet</tt></li>
</ul>

Modify <tt>/etc/rc.conf.local</tt> accordingly:
<pre>
	perl -pi -e 's/dbus_daemon/messagebus/;' -e 's/puppetmasterd/puppetmaster/;' -e 's/puppetd/puppet/;' /etc/rc.conf.local
</pre>

<h3 id="20150424">2015/04/24 - tip(1) removed</h3>
tip(1) has been removed in favour of cu(1):

<pre>
	rm /usr/bin/tip /usr/share/man/man1/tip.1
</pre>

<h3 id ="20150427">2015/04/27 - _file user added</h3>
A new <em>_file</em> user and group have been added to support privilege
separation in file(1). sysmerge(8) should be run to ensure it is added. 

<h3 id ="20150428">2015/04/28 - sshd default changed to PermitRootLogin no</h3>
sshd no longer allows root logins by default.
If you rely on this, you can reinstate it by adding "PermitRootLogin
without-password" or "PermitRootLogin yes" to /etc/ssh/sshd_config, and
reloading sshd configuration ("rcctl reload sshd").
Beware that root is a common target of password-guessing attacks,
so consider your options carefully before deviating from the default.

<h3 id ="20150502">2015/05/02 - pf_rules and ipsec_rules removed from rc.conf(5)</h3>
The pf_rules and ipsec_rules variables have been removed from rc.conf(5): rc(8) will
now always use the default paths: <tt>/etc/pf.conf</tt> and <tt>/etc/ipsec.conf</tt>).
<br>
If you were relying on those to set a custom configuration path for
<a href="http://www.openbsd.org/cgi-bin/man.cgi/OpenBSD-current/man8/pfctl.8">pfctl(8)</a>
or
<a href="http://www.openbsd.org/cgi-bin/man.cgi/OpenBSD-current/man8/ipsecctl.8">ipsecctl(8)</a>.
you must move your configuration to the standard path or create a default configuration
that will include your custom one.
For example:
<pre>
    echo 'include "/path/to/custom/pf.conf"' >/etc/pf.conf
</pre>

<h3 id ="20150515">2015/05/15 - [ports] www/apache-httpd updated to 2.4.12</h3>
Apache HTTPD is now at 2.4.12. When upgrading from 2.2.x releases manual
configuration changes may be required. See the <a href="http://httpd.apache.org/docs/2.4/upgrading.html"/>Apache HTTPD 2.4 upgrade guide</a> for details.
<br>
The ap2-mod_fastcgi and ap2-mod_fcgid ports have been superseded by
mod_proxy_fcgi which ships with Apache HTTPD 2.4 out of the box.

<h3 id ="20150517">2015/05/17 - isatty(3) depends on new feature in fcntl(2)</h3>
An F_ISATTY feature was added to fcntl(2), and isatty(3) requires it.
Build a new kernel before updating libc.

<h3 id="20150518">2015/05/18 - spamd(8) PF rule change: rdr-to to divert-to</h3>
pf(4) rules for spamd(8) must be changed from rdr-to to divert-to rules; a
simple replacement should work.  Additionally, spamd(8) now listens on 127.0.0.1
by default instead of 0.0.0.0.

<h3 id="20150523">2015/05/23 - ipsec.conf(5) default Diffie-Hellman group change</h3>
Automatic keying rules in ipsec.conf(5) now default to the modp3072
Diffie-Hellman group in both main mode and quick mode.  isakmpd(8)
will fail to negotiate flows and security associations unless both
sides use the same cryptographic parameters.  To make <i>old</i>
setups that still use the previous defaults communicate with the
new parameters, add "main group modp3072" and "quick group modp3072"
to the rules.
For example:
<pre>
    ike from 192.168.1.1 to 192.168.1.2 \
        main group modp3072 quick group modp3072
</pre>

<h3 id="20150528">2015/05/28 - CUPS GTK+2 plugin is now in a separate package</h3>
The plugin to allow printer selection from GTK+2 applications, previously in
the main GTK+2 package, has now been separated.
To be able to use CUPS printers from these applications (including GIMP,
Firefox, etc), install the gtk+2-cups package.

<h3 id="20150601">2015/06/01 - alpha switches to <i>secureplt</i></h3>
The toolchain of the alpha port has been updated to produce binaries with a
faster and smaller plt format.
In order to support this format, <tt>ld.so</tt> and <tt>libc.so</tt> need to
be updated before any of the new binaries can run.
While upgrading from a snapshot remains the preferred way to update, it is
possible to update by source by following this order:
<ul>
<li>Make sure your Makefile machinery is up-to-date:
<pre>
# cd /usr/src/share/mk
# make install
</pre>
<li>Build and install a new <tt>ld.so</tt>:
<pre>
# cd /usr/src/libexec/ld.so
# make cleandir &amp;&amp; make obj &amp;&amp; make depend &amp;&amp; make &amp;&amp; make install
</pre>
<li>Build and install a new <tt>libc.so</tt>:
<pre>
# cd /usr/src/lib/libc
# make cleandir &amp;&amp; make obj &amp;&amp; make depend &amp;&amp; make NOMAN= NOPROFILE= &amp;&amp; make NOMAN= NOPROFILE= install
</pre>
<li>Build, but do not install, new binutils:
<pre>
# cd /usr/src/gnu/usr.bin/binutils-2.17
# make -f Makefile.bsd-wrapper cleandir &amp;&amp; make -f Makefile.bsd-wrapper obj &amp;&amp; make -f Makefile.bsd-wrapper
</pre>
<li>Build and install the compiler:
<pre>
# cd /usr/src/gnu/usr.bin/cc
# make cleandir &amp;&amp; make obj &amp;&amp; make &amp;&amp; install
</pre>
<li>Install new binutils:
<pre>
# cd /usr/src/gnu/usr.bin/binutils-2.17
# make -f Makefile.bsd-wrapper install
</pre>
</ul>
You can then proceed to rebuild your system as usual.

<h3 id="20150602">2015/06/02 - sparc switches to PIE</h3>
The sparc port is now using PIE binaries.
To upgrade by source, follow these steps:
<ul>
<li>Make sure your Makefile machinery is up-to-date:
<pre>
# cd /usr/src/share/mk
# make install
</pre>
<li>Build, but do not install, new binutils:
<pre>
# cd /usr/src/gnu/usr.bin/binutils-2.17
# make -f Makefile.bsd-wrapper cleandir &amp;&amp; make -f Makefile.bsd-wrapper obj &amp;&amp; make -f Makefile.bsd-wrapper
</pre>
<li>Build and install the compiler:
<pre>
# cd /usr/src/gnu/usr.bin/cc
# make cleandir &amp;&amp; make obj &amp;&amp; make &amp;&amp; install
</pre>
<li>Install new binutils:
<pre>
# cd /usr/src/gnu/usr.bin/binutils-2.17
# make -f Makefile.bsd-wrapper install
</pre>
</ul>
You can then proceed to rebuild your system as usual.

<h3 id="20150605">2015/06/05 - [ports] default PHP version switched to 5.6</h3>

The default version of PHP has been switched to 5.6.
After updating to new packages, you will need to move the configuration
across from 5.5.
Check for local changes in /etc/php-5.5.ini and apply them to php-5.6.ini,
and create new symbolic links for any required extensions in /etc/php-5.6.
For the common case where you would like to keep existing extensions
you can do this:
<pre>
# cd /etc/php-5.5
# for i in *; do ln -s ../php-5.6.sample/$i ../php-5.6/; done
</pre>
Note that pkg_add -u will <b>not</b> move to the newer php-fpm release
version; most users will need to manually pkg_delete php-fpm and then
pkg_add the new version.<p>
Additionally note that there have been <a href="http://php.net/manual/en/migration56.openssl.php">changes
to PHP 5.6's SSL/TLS support</a>.
When a PHP script makes an SSL/TLS client connection, peer certificates
re now verified by default, which was not the case previously.
Since the standard CA certificate bundle is outside the chroot jail
frequently used with PHP on OpenBSD, you may need to copy this across
to allow client connections to function.
<pre>
# mkdir -p /var/www/etc/ssl
# cp /etc/ssl/cert.pem /var/www/etc/ssl/
</pre>

<p>
<hr>
<small>$OpenBSD: current.html,v 1.614 2015/07/02 05:49:04 bentley Exp $</small>

</body>
</html>
