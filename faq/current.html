<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html>
<head>
<title>Following -current and using snapshots</title>
<meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1">
<meta name="copyright" content="This document copyright 2005-2017 by OpenBSD">
<meta name="viewport" content="width=device-width, initial-scale=1">
<link rel="stylesheet" type="text/css" href="../openbsd.css">
<link rel="canonical" href="https://www.openbsd.org/faq/current.html">
</head>

<body bgcolor= "#ffffff" text= "#000000">

<h2>
<a href="../index.html">
<font color="#0000ff"><i>Open</i></font><font color="#000084">BSD</font></a>
<font color="#e00000">Following -current and using snapshots</font>
<small>
<a href="index.html" style="font-weight:normal; float:right">[FAQ Index]</a>
</small>
</h2>
<hr>
<p>

Active OpenBSD development is known as the
<a href="faq5.html#Flavors">-current</a> branch.
These sources are frequently compiled into releases known as <i>snapshots</i>.

<p>
Aggressive changes are sometimes pushed in this branch, and complications can
arise when building the latest code or upgrading from a previous point in time.
Some of the steps for getting over these hurdles are explained on this page.
Make sure you've read and understand how to
<a href="faq5.html">build the system from source</a> before using -current
and the instructions below.

<p>
In general, it's far easier to use snapshots, as developers will have gone
through much of the trouble for you already.

<p>
You should <b>always</b> use a snapshot as the starting point for running
-current.
This process typically consists of downloading (and verifying) the appropriate
<a href="faq4.html#bsd.rd">bsd.rd</a> file from the <tt>/snapshots/</tt>
directory of your preferred <a href="../ftp.html">mirror</a>, booting from it,
and choosing <tt>(U)pgrade</tt> at the prompt.
Any installed packages should then be
<a href="faq15.html#PkgUpdate">upgraded</a> after booting into the new system.

<p>
Upgrading to -current by compiling your own source code is not supported.

<p>
Most of these changes will have to be performed as root.


<h3 id="r20180404">2018/04/04 - PF_TRANS_ALTQ removed</h3>

The obsolete <tt>PF_TRANS_ALTQ</tt> has been removed from <tt>net/pfvar.h</tt>.
Several userland programs will need to be recompiled together with the kernel.
Using a snapshot is highly recommended.  To update from source, the following
steps are needed:

<ol>
<li>
Build and install the kernel but do <b>NOT</b> reboot.

<li>
Rebuild the affected programs:

<pre class="cmdbox">
# <b>cd /usr/src && make includes</b>
# <b>cd /usr/src/sbin/pfctl && make clean && make && make install</b>
# <b>cd /usr/src/usr.sbin/authpf && make clean && make && make install</b>
# <b>cd /usr/src/usr.sbin/ftp-proxy && make clean && make && make install</b>
# <b>cd /usr/src/usr.sbin/relayd && make clean && make && make install</b>
# <b>cd /usr/src/usr.sbin/tftp-proxy && make clean && make && make install</b>
</pre>

<li> Reboot.
</ol>


<h3 id="r20180411">2018/04/11 - meaning of listen on * port 80 changed
in httpd(8)</h3>

The meaning of <tt>listen on * port 80</tt> changed from "listen on
all IPv4 addresses" to "listen on all IPv4 <b>and</b> all IPv6 addresses".
If <tt>listen on * port 80</tt> is present, <tt>listen on :: port 80</tt>
needs to be removed.
For example,

<pre class="cmdbox">
listen on * port 80
listen on :: port 80
</pre>

must be changed to:

<pre class="cmdbox">
listen on * port 80
</pre>


<h3 id="r20180420">2018/04/20 - [packages] security/kc storage format change</h3>

The storage format of keychains has changed in a backward incompatible way.
Dump all your keychains to xml before updating:

<pre class="cmdbox">
$ <b>kc -k ~/.kc/default.kcd</b>
Password:
&lt;example_chain% &gt; <b>dump kcdump</b>
Dump OK
&lt;example_chain% &gt; <b>quit</b>
</pre>

After updating follow the instructions in
<tt>/usr/local/share/doc/kc/Changelog</tt>.


<h3 id="r20180503">2018/05/03 - [packages] sysutils/apcupsd has SMTP client removed</h3>

The <tt>${PREFIX}/sbin/smtp</tt> was removed from apcupsd package
in favor of <a href="https://man.openbsd.org/smtp.1">smtp(1)</a>.
The programs are not option-compatible, so any scripts using &quot;smtp&quot;
command require adjustment.


<h3 id="r20180522">2018/05/22 - [packages] PHP default version changed</h3>
<!-- XXX 6.4: merge with r20180527 -->
With a few exceptions, most packages using PHP have switched to
using PHP 7.0 dependencies by default.
Because extension modules (now including PECL modules) are packaged
for multiple PHP versions, most existing PHP programs will work as-is,
but to avoid confusion and benefit from improvements to PHP you should
switch your system across:

<ol>
  <li>Merge local configuration changes from <tt>/etc/php-5.6.ini</tt> to
  <tt>/etc/php-7.0.ini</tt>.
  It may be useful to <a href="https://man.openbsd.org/diff">diff(1)</a>
  against the original file in
  <tt>/usr/local/share/examples/php-5.6/php.ini-production</tt>.

  <li>Create new symlinks for extension modules as described in
  the "extension modules" section of
  <tt>/usr/local/share/doc/pkg-readmes/php-7.0*</tt>.

  <li>Switch to running the new version. If using php-fpm:
  <pre class="cmdbox">
  # <b>rcctl disable php56_fpm; rcctl enable php70_fpm</b>
  # <b>rcctl stop php56_fpm; rcctl start php70_fpm</b><!--
  --></pre>
  If using the module for Apache httpd, update the symlink for
  <tt>/var/www/conf/modules/php.conf</tt> as shown in the pkg-readme.
</ol>


<h3 id="r20180524">2018/05/24 - smtpd.conf(5) grammar has changed in smtpd(8)</h3>

The <a href="https://man.openbsd.org/smtpd.conf.5">smtpd.conf(5)</a> file needs to
be adapted to use the new grammar.

<p>
The change is mostly mechanical and requires splitting current rules into actions
and matching patterns, examples are available in the man page.

<p>
Authenticated users are no longer considered as local users,
if your configuration file allows remote users to authenticate and send mail,
an explicit rule must be written to match these.

<p>
<a href="https://man.openbsd.org/smtpd.8">smtpd(8)</a> supported LMTP both as a
relaying protocol and as a local delivery method.
The local delivery method was implemented within the daemon and not as an MDA,
it no longer does and must be used through the 'mda' action:

<pre class="cmdbox">
action lmtp-local mda "/usr/libexec/mail.lmtp [...]"
</pre>

The <a href="https://man.openbsd.org/mail.lmtp.8">mail.lmtp(8)</a> MDA provides
all the features that used to be supported interally by
<a href="https://man.openbsd.org/smtpd.8">smtpd(8)</a>.


<h3 id="r20180527">2018/05/27 - [packages] PHP packaging changes</h3>

The PHP module for Apache HTTPD has moved from the main PHP package
into a separate "php-apache" package.
If you use this module, install the relevant version (<tt>pkg_add php-apache%7.0</tt>
or <tt>pkg_add php-apache%5.6</tt>).
FPM and CLI remain in the main PHP package.


<h3 id="r20180530">2018/05/30 - smtpd.conf(5) LMTP action introduced</h3>

With the recent grammar change, LMTP support was re-implemented as an external
mail delivery agent and required being configured using the 'mda' action:

<pre class="cmdbox">
action lmtp-local mda "/usr/libexec/mail.lmtp [...]"
</pre>

The grammar has been extended to provide an LMTP action hiding the details
behind the <a href="https://man.openbsd.org/mail.lmtp.8">mail.lmtp(8)</a> MDA.
The LMTP action is documented in <a href="https://man.openbsd.org/smtpd.conf.5">smtpd.conf(5)</a>
and looks as follow:

<pre class="cmdbox">
action lmtp-local lmtp localhost:25
</pre>

In addition, the unix: and inet: prefixes which were used in LMTP destinations
to distinguish between a UNIX socket or a network socket have been removed.


<h3 id="r20180601">2018/06/01 - smtpd.conf(5) 'set' and 'limit' removed as main keywords</h3>

The grammar allowed setting options of components with the 'set' keyword:

<pre class="cmdbox">
set queue compression
set mta max-deferred 100
</pre>

The keyword brought no value and was dropped in favor of component namespaces:

<pre class="cmdbox">
queue compression
mta max-deferred 100
</pre>

In addition, the 'limit' option which could be used with mta:

<pre class="cmdbox">
limit mta session-transaction-delay 0
</pre>

is now an option within the 'mta' namespace:

<pre class="cmdbox">
mta limit session-transaction-delay 0
</pre>

<h3 id="r20180604">2018/06/04 - New sysctl/mixerctl settings to control audio recording</h3>

Due to privacy concerns from some, audio recording has been disabled
by default.
It may be reenabled system-wide like this:

<pre class="cmdbox">
# <b>sysctl kern.audio.record=1</b> # enable at runtime
# <b>echo kern.audio.record=1 >> /etc/sysctl.conf</b> # set at boot
</pre>

Finer-grained controls are available using
<a href="//man.openbsd.org/mixerctl.1">mixerctl(1)</a> which allows
setting record.enable for each mixer device to off (always off), on (always on),
or sysctl (default: follow state of the kern.audio.record sysctl).


<h3 id="r20180606">2018/06/06 - [amd64] New clang compiler feature</h3>

The retguard compiler feature has been implemented on the amd64 platform.
Using a snapshot is highly recommended. To update from source, first
verify if your clang is recent enough to understand the
<tt>-fno-ret-protector</tt> flag:

<pre class="cmdbox">
$ <b>echo 'int main() {return 0;}' | cc -fno-ret-protector -x c -</b>
</pre>

If there is no error in the output, then proceed with a normal source
upgrade as usual.

If the output includes the error
<tt>cc: error: unknown argument: '-fno-ret-protector'</tt>
then follow the procedure below.

<ol>
<li>
Build and install the kernel. Reboot.

<li>
Edit <tt>/usr/src/gnu/usr.bin/clang/Makefile.inc</tt> and comment out
the <tt>-fno-ret-protector</tt> option:

<pre class="cmdbox">
# <b>cd /usr/src/gnu/usr.bin/clang</b>
# <b>sed -i.head s/-fno-ret-protector/'#-fno-ret-protector'/ Makefile.inc</b>
</pre>

<li>
Build and install clang:

<pre class="cmdbox">
<b># cd /usr/src/gnu/usr.bin/clang</b>
<b># make</b>
<b># make install</b>
</pre>

<li>
Restore the original clang <tt>Makefile.inc</tt>

<pre class="cmdbox">
# <b>cd /usr/src/gnu/usr.bin/clang</b>
# <b>mv Makefile.inc.head Makefile.inc</b>
</pre>

<li>
Build the system as usual.

</ol>


<h3 id="r20180613">2018/06/13 - bgpd configuration change</h3>

By default <a href="//man.openbsd.org/bgpd.8">bgpd(8)</a>, without explicit
policy configuration, will deny both incoming and outgoing <tt>UPDATES</tt>.
See <a href="https://tools.ietf.org/html/rfc8212">RFC 8212</a> for more
information.

<p>
The following configuration directives have been deprecated (but will be
accepted for backwards compatibility) <tt>announce all</tt>,
<tt>announce none</tt>, and <tt>announce default-route</tt>.
Furthermore the <tt>announce self</tt> directive has been removed.
Explicit use of <tt>announce self</tt> will result in a syntax error preventing
<a href="//man.openbsd.org/bgpd.8">bgpd(8)</a> from starting.
Users are advised to review and update <tt>/etc/bgpd.conf</tt> before upgrading.

<p>
It is possible to write configuration files that are valid and functionally the
same both before and after the update.

<p>
<b>Before updating:</b>
<ol>
  <li>Mimic the new behavior of the updated
      <a href="//man.openbsd.org/bgpd.8">bgpd(8)</a> by adding
      <tt>deny from any</tt> and <tt>deny to any</tt> to the top of
      the filter ruleset.
      (After the update these rules are implicitly added to the filter)
  <li>Replace all instances of <tt>announce self</tt> with
      <tt>announce all</tt>.
  <li>Ensure that the filter ruleset only allows correct announcements to and
      from EBGP neighbors by explicitly specifying the prefixes to be imported
      from and exported to EBGP neighbors using <tt>prefix-set</tt> and
      <tt>large-community</tt> (or <tt>community</tt>).
  <li>Add <tt>announce all</tt> to all neighbors for which neither
      <tt>announce none</tt> nor <tt>announce default-route</tt> is specified
      (the implicit default for EBGP peers was <tt>announce self</tt>).
      You can confirm that you haven't missed any:
<pre class="cmdbox">
# <b>bgpd -nvf /etc/bgpd.conf | grep -B4 'announce self'</b>
</pre>
</ol>

The resulting config should now be ready for the upgrade.
It is recommended to review <tt>/etc/examples/bgpd.conf</tt> for an example how
BGP communities and <tt>prefix-set</tt> can be used in simple network designs.

<p>
<b>After:</b>
<ol>
  <li>Remove all <tt>announce all</tt> directives from the configuration
  <li>The <tt>deny from all</tt> and <tt>deny to any</tt> rules at the top of
      the ruleset filter are redundant after the update (and as such could be
      removed), but leaving those may improve readability of the configuration.
</ol>


<h3 id="r20180613b">2018/06/13 - httpd.conf(5) 'root strip' option renamed</h3>

To be semantically correct, the 'root strip' option has been renamed
to 'request strip'. For example, the following configuration block is
needed for <a href="https://man.openbsd.org/acme-client.1">acme-client(1)</a>:

<pre class="cmdbox">
location "/.well-known/acme-challenge/*" {
	root "/acme"
	request strip 2
}
</pre>

<h3 id="r20180618">2018/06/18 - slaacd(8) fully pledged</h3>

slaacd(8)'s main process is now pledged and uses the new
&quot;wroute;&quot; promise.
Make sure to have a current kernel or update via snapshots.

<h3 id="r20180623">2018/06/23 - [packages] buildbot/buildslave switch to python3 &amp; buildslave rc script renaming</h3>

Both, buildbot and buildbot-worker are now using python3.

<p>
Upstream renamed <tt>buildslave</tt> to <tt>buildbot-worker</tt> a while ago.
Accordingly, the <tt>buildslave</tt> rc script was renamed to
<tt>buildbot_worker</tt>.
You need to adjust the list of daemons:

<pre class="cmdbox">
# <b>rcctl disable buildslave</b>
# <b>rcctl enable buildbot_worker</b>
</pre>

Make sure to stop any running <tt>buildslave</tt> instances before upgrading,
otherwise <a href="faq10.html#rc">rc.d(8)</a> will lose track of the process.


<h3 id="r20180710">2018/07/10 - error on bad '-netmask'/'-prefixlen' usage with route(8)</h3>
If you have specified these options <b>before</b> the address string in
hostname.if(5) or some script, <a href="//man.openbsd.org/route.8">route(8)</a>
will now print an error message and exit.

Make sure to change

<pre class="cmdbox">
<b>route add -inet6 -prefixlen 56 2001:db8:: ::1 -blackhole</b>
</pre>

to

<pre class="cmdbox">
<b>route add -inet6 2001:db8:: -prefixlen 56 ::1 -blackhole</b>
</pre>

Otherwise, a route for <tt>2001:db8::/64</tt> would be installed as the address
string comes last for which a default prefix length of <tt>64</tt> is currently
implied.

It is best to use proper
<a href="https://en.wikipedia.org/wiki/Classless_Inter-Domain_Routing">CIDR</a>
notation.

<pre class="cmdbox">
<b>route add -inet6 2001:db8::/56 ::1 -blackhole</b>
</pre>


<h3 id="r20180712">2018/07/12 - _rad user and group added; reuses _btd uid/gid</h3>

The new <tt>_rad</tt> user recycles user and group ids of the "Bluetooth Daemon"
user (<tt>_btd</tt>) removed in 2013.
If you upgraded your system from all the way back then and never deleted the
user and group, <a href="https://man.openbsd.org/sysmerge.8">sysmerge(8)</a> will complain:

<pre class="cmdbox">
[...]
running rc.sysmerge
**** Not adding group _rad, GID 94 already exists
**** Not adding user _rad, UID 94 already exists 
</pre>

Delete the <tt>_btd</tt> user and group and run <tt>sysmerge</tt> again:

<pre class="cmdbox">
# <b>userdel _btd</b>
# <b>groupdel _btd</b>
# <b>sysmerge</b>
</pre>

<h3 id="r20180715">2018/07/15 - wpakey and hostname.if(5)</h3>

The <a href="https://man.openbsd.org/ifconfig.8">ifconfig(8)</a> utility
encourages users of the <tt>wpakey</tt> keyword to use it on the same line
as any <tt>join</tt> or <tt>nwid</tt> keywords.
In particular, <a href="https://man.openbsd.org/hostname.if">hostname.if(5)</a>
file should be adjusted:

<pre class="cmdbox">
nwid mynwid wpakey mywpakey
</pre>


<h3 id="r20180717">2018/07/17 - implicit prefix length removed from route(8)</h3>

Unless <tt>-prefixlen</tt> or
<a href="https://en.wikipedia.org/wiki/Classless_Inter-Domain_Routing">CIDR</a>
notation is used, <a href="https://man.openbsd.org/route.8">route(8)</a> no
longer interprets an IPv6 host address as <tt>/64</tt> subnet.

<p>
Despite the manual page already stating correct behaviour, a route different
from the specified destination string would be installed:

<pre class="cmdbox">
# <b>route add 2001:db8:: ::1</b>
add net 2001:db8::: gateway ::1
# <b>route show -inet6 | grep 2001:db8</b>
2001:db8::/64      localhost          UGS        0        0 32768     8 lo0
</pre>

This behaviour was deprecated in 2003 by
<a href="https://tools.ietf.org/html/rfc3587">RFC 3587</a> and has now been
fixed to take an host address as is:

<pre class="cmdbox">
2001:db8::         localhost          UGHS       0        0 32768     8 lo0
</pre>


<h3 id="r20180720">2018/07/20 - resolver renamed to nameserver in rad.conf(5)</h3>

The <tt>resolver</tt> configuration option has been renamed to
<tt>nameserver</tt> in
<a href="https://man.openbsd.org/rad.conf">rad.conf(5)</a> to be more in line
with <a href="https://man.openbsd.org/resolv.conf">resolv.conf(5)</a> and
<a href="https://man.openbsd.org/dhclient.conf">dhclient.conf(5)</a>.


<h3 id="r20180723">2018/07/23 - rtadvd(8) removed; replaced by rad(8)</h3>

rtadvd(8) has been removed from the base system.
To clean up, execute the following commands:

<pre class="cmdbox">
# <b>userdel _rtadvd</b>
# <b>groupdel _rtadvd</b>
# <b>rm /etc/rc.d/rtadvd /usr/sbin/rtadvd /usr/share/man/man5/rtadvd.conf.5 /usr/share/man/man8/rtadvd.8</b>
</pre>

If you are running rtadvd(8) for IPv6 router advertisements, please switch to
<a href="https://man.openbsd.org/rad.8">rad(8)</a>.
First create a <tt>/etc/rad.conf</tt> configuration file.
For example, when you had <tt>rtadvd_flags=em0</tt> in
<tt>/etc/rc.conf.local</tt>, <tt>/etc/rad.conf</tt> would be:

<pre class="cmdbox">
interface em0
</pre>

For more advanced configurations consult
<a href="https://man.openbsd.org/rad.conf.5">rad.conf(5)</a>.
With the <tt>/etc/rad.conf</tt> file in place you can stop rtadvd(8) and start
rad(8):

<pre class="cmdbox">
# <b>rcctl stop rtadvd</b>
# <b>rcctl disable rtadvd</b>
# <b>rcctl enable rad</b>
# <b>rcctl start rad</b>
</pre>


<h3 id="r20180726">2018/07/26 - build infrastructure for lld as default linker</h3>

Build infrastructure was added to make it possible to install
ld.lld(1) as the default linker.  Before building the system from
source, you will need to run the following commands:

<pre class="cmdbox">
# <b>cd /usr/src/share/mk</b>
# <b>make install</b>
</pre>

The armv7 platform was switched to install lld as the default linker.
To complete the switch on that platform, build the system from source
twice.


<h3 id="r20180728">2018/07/28 - sndio session cookie path changed</h3>

The new
<a href="https://man.openbsd.org/sndio.7">sndio(7)</a>
session cookie path is <tt>~/.sndio/cookie</tt>.

If you allow access to your audio/MIDI hardware to other users or to
remote systems, you may want to move your authorization cookie to the
new location:

<pre class="cmdbox">
$ <b>mkdir -p ~/.sndio</b>
$ <b>mv ~/.aucat_cookie ~/.sndio/cookie</b>
</pre>

This is probably simpler than deleting the old cookie, generating a
new one and installing it to all appropriate locations.

<h3 id="r20180729">2018/07/29 - Remove /dev/audio and /dev/audioctl</h3>

The <tt>/dev/audio</tt> and <tt>/dev/audioctl</tt> symbolic links
are not used anymore and can be removed:

<pre class="cmdbox">
# <b>rm /dev/audio /dev/audioctl</b>
</pre>


<h3 id="r20180802">2018/08/02 - Error on invalid queue definitions in pf.conf(5)</h3>

PF queues can only refer to a single interface, not an interface group.
Previously, the <a href="https://man.openbsd.org/pf.conf.5">pf.conf(5)</a>
parser accepted invalid queue definitions (either for an interface
group, or for a non-existent interface) and mostly ignored them, though
gave an error when displaying queues.
These are now rejected and result in the entire ruleset failing to load.

<p>
Before updating, use "pfctl -s queue".
If you have no output or a list of queues, you should not be affected by this.
If you see the following error, adjust your
<a href="https://man.openbsd.org/pf.conf.5">pf.conf(5)</a> accordingly:

<pre class="cmdbox">
# <b>pfctl -s queue</b>
pfctl: DIOCGETQSTATS: Bad file descriptor
</pre>

Normally you can just specify the relevant interface name, but if you
are trying to use interface groups to allow use of the same pf.conf file
on multiple systems which have different interface types, you might like
to define macros in a separate file that can be different on each system
(sharing a common pf.conf):

<pre class="cmdbox">
$ <b>cat /etc/pf.conf.local</b>
egress_if = ix0

$ <b>cat /etc/pf.conf</b>
include "/etc/pf.conf.local"
queue rootq on $egress_if bandwidth 1G default

[...]
</pre>


<h3 id="r20180806">2018/08/06 - New log options in relayd.conf(5)</h3>

The log options <tt>log updates</tt> and <tt>log all</tt> in
<a href="https://man.openbsd.org/relayd.conf.5">relayd.conf(5)</a>
have been superseded by three new options:

<pre class="cmdbox">
log state changes
log host checks
log connection [errors]
</pre>

The first two set the logging of host checks to either changes in host
state only or all check results, and replace <tt>log updates</tt> and
<tt>log all</tt>. The third option controls connection logging in
relays which, until now, was a side effect of <tt>log updates</tt>. The
optional <tt>errors</tt> will cause only failed connections to be
logged.

<p>
Use of the old options will result in a warning message and they will
be removed in OpenBSD 6.5.


<h3 id="r20180809">2018/08/09 - Stricter route(8) network syntax</h3>

Support for guessing an old-style class A, B, or C netmask from
a bare dot-notation IPv4 address by counting trailing zero octets was
dropped from <a href="https://man.openbsd.org/route.8">route(8)</a>,
and related option parsing is now stricter.
To specify a destination network, use any of the following syntaxes:

<pre class="cmdbox">
route add [-net] 192.0.2.0/24 ...
route add [-net] 192.0.2.0 -netmask 255.255.255.0 ...
route add -inet [-net] 192.0.2.0 -prefixlen 24 ...
</pre>

When neither <code>-net</code> nor <code>-netmask</code> nor
<code>-prefixlen</code> is given, <code>-host</code> is now assumed.


<h3 id="r20180816">2018/08/16 - nsd(8) control socket moved from TCP/IP to unix domain socket</h3>
If nsd(8) is started with the old config file and then the config file
is changed to use the unix domain socket, rc(8) and rcctl(8) cannot
restart nsd since they try to communicate over the unix domain socket
while nsd(8) still uses TCP/IP.
In that case kill nsd(8) and start it again.
One way to end up in this situation is when sysmerge needs to be run
by hand.


<h3 id="r20180903">2018/09/03 - smtpd.conf(5) relay host syntax changed</h3>

The syntax for the smarthost string in relay rules has been updated.
It is documented in <a href="https://man.openbsd.org/smtpd.conf.5">smtpd.conf(5)</a>.
The changes are as follows:
<ul>
<li>
the <tt>+auth</tt> specifier has been removed: it is implied by the presence
of an auth label in the rest of the string.
<li>
<tt>secure://</tt> has been removed: use <tt>smtp+tls://</tt> or <tt>smtps://</tt> explicitly.
<li>
<tt>tls://</tt> has been replaced by <tt>smtp+tls://</tt>.
<li>
<tt>smtp://</tt> becomes SMTP with opportunistic STARTTLS: use <tt>smtp+notls://</tt> to disable TLS.
<li>
<tt>smtp+tls://</tt> becomes SMTP with mandatory STARTTLS: use <tt>smtp://</tt> for opportunistic STARTTLS.
</ul>

Running <a href="https://man.openbsd.org/smtpd.8">smtpd(8)</a> without updating
the configuration will result in mails being stuck in the queue if the smarthost
string is not recognized, or mails being relayed with TLS instead of plain text,
for non-updated <tt>smtp://</tt> and <tt>smtp+tls://</tt> relays.

<hr id="end">
<small>$OpenBSD: current.html,v 1.943 2018/09/04 19:13:14 tj Exp $</small>

</body>
</html>
