<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html>
<head>
<title>Following -current</title>
<meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1">
<meta name= "description"   content= "the OpenBSD FAQ page">
<meta name= "copyright"     content= "This document copyright 2005-2015 by OpenBSD">
<link rel="canonical" href="http://www.openbsd.org/faq/current.html">
</head>

<body bgcolor= "#ffffff" text= "#000000">
<a href="../index.html">
<img alt="[OpenBSD]" height=30 width=141 src="../images/smalltitle.gif" border="0">
</a>
<p>
<font color= "#0000e0">
<a href= "index.html">[FAQ Index]</a>
</font>

<p>

<h1><font color="#e00000">Following <i>-current</i></font></h1>
<hr>

<h3>Table of Contents</h3>
<p>
<ul>
<li><a href="#Intro">Introduction</a>
<!-- Oldest on top... -->
<!-- New additions go on the bottom, please -->
<li><a href="#20150822">2015/08/22 - [xenocara] libdrm update</a>
<li><a href="#20150825">2015/08/25 - [ports] security/cfs removed</a>
<li><a href="#20150911">2015/09/11 - config(8) update</a>
<li><a href="#20150912">2015/09/12 - ifmedia extended to 64 bits</a>
<li><a href="#20150918">2015/09/18 - [ports] php-fpm rc script renamed</a>
<li><a href="#20151019">2015/10/19 - [xenocara] freetype update</a>
<li><a href="#20151023">2015/10/23 - ntpd.conf(5) remove rtable for server</a>
<li><a href="#20151024">2015/10/24 - [ports] node module ports removed</a>
<li><a href="#20151026">2015/10/26 - [ports] puppetboard configuration update</a>
<li><a href="#20151116">2015/11/16 - /dev/tun -> /dev/tap</a>
<li><a href="#20151130">2015/11/30 - smtpd tables removed</a>
<li><a href="#20151203">2015/12/03 - termcap.db and terminfo.db removed</a>
<li><a href="#20151203a">2015/12/03 - vmmctl(8) and vmm.conf(8) renamed</a>
<li><a href="#20151205">2015/12/05 - netstart(8) options "multicast_host" and
	"multicast_router" merged</a>
<li><a href="#20151207">2015/12/07 - smtpd makemap(8) merged into smtpctl(8)</a>
<li><a href="#20151212">2015/12/12 - smtpd.conf(5) "pki" keyword change and "ca" keyword addition</a>
<li><a href="#20151227">2015/12/27 - amd64 and i386 support for rdseed instruction</a>
<li><a href="#20151231">2015/12/31 - [ports] gophernicus moved</a>
<li><a href="#20160105">2016/01/05 - pf.conf(5) <em>set debug</em> syntax change</a>
</ul>

<hr>

<!-- XXXversion -->
<h2 id="Intro">Introduction</h2>
This document is for people who wish to follow <i>-current</i>.
It contains information about changes from 5.8-release to <i>-current</i>,
and should NOT be used by anyone upgrading from 5.7 or earlier, or people
wishing to follow <a href="../stable.html"><i>-stable</i></a>.

<p>
If you wish to upgrade to 5.8-release or 5.8-stable from previous
versions, see the <a href="upgrade58.html">upgrade guide</a> instead,
as what is here does not apply to 5.8.

<p>
Make sure you have read and understood
<a href="faq5.html">FAQ 5 - Building the System from Source</a>
before using -current and the instructions below.

<p>
You should ALWAYS use a snapshot as the starting point for running
<i>-current</i>.
Upgrading by compiling your own source code is not supported.

<p>
Most of these changes will have to be performed as root.


<h3 id="20150822">2015/08/22 - [xenocara] libdrm updated</h3>
libdrm has been updated to a new version, moving a few files around.
As a consequence, old files should be removed:
<pre>
         rm -f /usr/X11R6/include/intel_*.h
	 rm -f /usr/X11R6/include/r600_pci_ids.h
	 rm -f /usr/X11R6/include/radeon_*.h
</pre>
<h3 id="20150825">2015/08/25 - [ports] security/cfs removed</h3>
The security/cfs ports has been removed, users are encouraged to use
another data encryption method.  Possible alternatives are softraid(4)
CRYPTO, encrypted vnd(4) devices or the security/encfs port.  To remove
an existing cfs package, use:
<pre>
	pkg_delete cfs
</pre>

<h3 id="20150911">2015/09/11 - config(8) update</h3>
An up to date
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=config&sektion=8">
config(8)</a> is needed to build kernels.
After updating the source tree, a new config(8) can be built and installed:
<pre>
	cd /usr/src/usr.sbin/config
	make obj &amp;&amp; make cleandir &amp;&amp; make depend &amp;&amp; make &amp;&amp; make install
</pre>
Afterwards, any existing kernel compilation directories must be
rebuilt after running config again.
Refer to
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=release&sektion=8">
release(8)</a> for details.

<h3 id="20150912">2015/09/12 - ifmedia extended to 64 bits</h3>

The ifmedia options word has been extended to 64 bits.
This changes numbers of the SIOCSIFMEDIA and SIOCGIFMEDIA ioctls and
grows struct ifmediareq. Upgrading from snapshots is recommended.
Old ifconfig and dhclient binaries are able to configure addresses on
interfaces but are unable to display or change media settings.
When upgrading from source, ifconfig and dhclient must be recompiled
with new headers to run properly on top of a new kernel. 
This will happen automatically during a normal 'make build'.
In case neither snapshots nor 'make build' can be used, the manual steps are:
<pre>
	install -m 444 -o root -g bin /usr/src/sys/net/if.h /usr/include/net/if.h
	install -m 444 -o root -g bin /usr/src/sys/net/if_media.h /usr/include/net/if_media.h
	install -m 444 -o root -g bin /usr/src/sys/sys/sockio.h /usr/include/sys/sockio.h
	cd /usr/src/sbin/ifconfig
	make obj
	make depend
	make
	make install
	cd /usr/src/sbin/dhclient
	make obj
	make depend
	make
	make install
</pre>

Some additional libraries and applications must also be recompiled.
Run a full 'make build' to ensure everything is in order.

<h3 id="20150918">2015/09/18 - [ports] php-fpm rc script renamed</h3>

To allow installing multiple versions of php-fpm on the same system,
the rc script has been renamed to include the version number.
If you are using this, modify references to php_fpm in /etc/rc.conf.local
to e.g. php56_fpm.

<h3 id="20151019">2015/10/19 - [xenocara] freetype update</h3>

Freetype was updated to version 2.6.1, which causes header files to be moved
around. As a result, some old files needs to be removed manually:
<pre>
	cd /usr/X11R6/include/freetype2
	rm -rf config
	rm -f freetype.h ftadvanc.h ftbbox.h ftbdf.h ftbitmap.h ftbzip2.h \
            ftcache.h ftcffdrv.h ftchapters.h ftcid.h fterrdef.h \
            fterrors.h ftfntfmt.h ftgasp.h ftglyph.h ftgxval.h ftgzip.h \
            ftimage.h ftincrem.h ftlcdfil.h ftlist.h ftlzw.h ftmac.h \
            ftmm.h ftmodapi.h ftmoderr.h ftotval.h ftoutln.h ftpfr.h \
            ftrender.h ftsizes.h ftsnames.h ftstroke.h ftsynth.h \
            ftsystem.h fttrigon.h fttypes.h ftwinfnt.h t1tables.h \
            ttnameid.h tttables.h tttags.h ttunpat.h
</pre>

<h3 id="20151023">2015/10/23 - ntpd.conf(5) remove rtable for server</h3>

In ntpd.conf(5), the rtable option was removed from the "server" and
"servers".  Users of "server * rtable X" will need to switch to
launching ntpd with

<pre>
	# route -T X exec /usr/sbin/ntpd
</pre>

<h3 id="20151024">2015/10/24 - [ports] node module ports removed</h3>
All modules for lang/node have been removed in favor of directly using
npm.
<p>
Native modules need to be built with "-std=gnu++0x", so set CXX=eg++ when building native modules. 
<pre>
	env CXX=eg++ npm install sqlite3
</pre>
To remove any installed modules:
<pre>
	for i in node-always node-async node-bcrypt node-bindings \
		node-buffer-writer node-canvas node-cloned node-daemon \
		node-expresso node-fibers node-generic-pool node-gir \
		node-java node-mnm node-pg node-rmdir node-sqlite3 \
		node-syslog node-typescript coffeescript; do
		pkg_delete $i
	done
</pre>

<h3 id="20151026">2015/10/26 - [ports] puppetboard configuration update</h3>
The default configuration file (<code>default_settings.py</code>) format has
been changed and needs to be merged with <code>default_settings.py.dist</code>
before restarting the <code>puppetboard</code> service.

<h3 id="20151116">2015/11/16 - /dev/tun -> /dev/tap</h3>
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=tun&sektion=4">tun(4)</a>
was previously a "dual mode" device.
By default it would act as a layer-3 "routed" device, but by use
of the "link0" flag it would change to a layer-2 "ethernet" mode.
This layer-2 mode has now been has been split off to a separate
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=tap&sektion=4">tap(4)</a>
device.
Make sure you have either updated from an install kernel or re-run
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=MAKEDEV&sektion=8">MAKEDEV(8)</a>
to create the new /dev/tap* device nodes.
For some use cases (e.g. ssh tunnel-forwarding run as a non-root user),
permissions on the device nodes would have been modified; these should
be applied to the new device nodes as necessary.
"hostname.tun*" files using the "link0" flag should be moved to
"hostname.tap*" instead, and the flag should be removed.
Other configuration may need to be adjusted to use the new device
name, for example for software like QEMU, OpenVPN or SIMH.
Networking configuration (bridges, PF) referring to these devices
may also need to change.

<h3 id="20151130">2015/11/30 - smtpd tables removed</h3>
Some smtpd table backends have been moved to ports and can be removed:
<pre>
	rm -f /usr/libexec/smtpd/table-ldap
	rm -f /usr/libexec/smtpd/table-passwd
	rm -f /usr/libexec/smtpd/table-sqlite
	rm -f /usr/share/man/man5/table_passwd.5
</pre>
People requiring these backends should install the opensmtpd-extras main
package.

<h3 id="20151203">2015/12/03 - termcap.db and terminfo.db removed</h3>
Compiled termcap.db and terminfo.db files are no longer used and can be
removed:
<pre>
	rm -f /usr/share/misc/termcap.db /usr/share/misc/terminfo.db
</pre>

<h3 id="20151203a">2015/12/03 - vmmctl(8) and vmm.conf(5) renamed</h3>
The vmmctl(8) program has been renamed to vmctl(8) and the vmm.conf(5)
manpage has been renamed to vm.conf(5).
The old files are no longer used and can be removed:
<pre>
	rm -f /usr/sbin/vmmctl
	rm -f /usr/share/man/man8/vmmctl.8
	rm -f /usr/share/man/man5/vmm.conf.5
</pre>

<h3 id="20151205">2015/12/05 - netstart(8) options "multicast_host" and
	"multicast_router" merged</h3>
Options "multicast_host" and "multicast_router" have been merged into a
single "multicast" option.  In order to enable multicast the
following line should be added in rc.conf.local(8).
<pre>
	multicast=YES
</pre>
If you previously set these options to something other than "YES" or the
interface carrying the default route, you will also need to add a static
route for 224.0.0.0/4.

<h3 id="20151207">2015/12/07 - smtpd makemap(8) merged into smtpctl(8)</h3>
makemap(8) is now merged into smtpctl(8) and can be removed:
<pre>
	rm -f /usr/libexec/smtpd/makemap
</pre>

<h3 id="20151212">2015/12/12 - smtpd.conf(5) "pki" keyword change and "ca" keyword addition</h3>
In smtpd.conf(5), the "pki" keyword no longer accepts a "ca" parameter. Custom CA certificates must be declared using the new "ca" keyword:
<pre>
	ca mail.example.org certificate "/etc/mail/CA.pem"
</pre>

<h3 id="20151227">2015/12/27 - amd64 and i386 support for rdseed instruction</h3>
Binutils needs to be built and installed before building an amd64 or i386 kernel to install an assembler with support for the rdseed instruction.
<pre>
	cd /usr/src/gnu/usr.bin/binutils-2.17
	make -f Makefile.bsd-wrapper obj
	make -f Makefile.bsd-wrapper
	make -f Makefile.bsd-wrapper install
</pre>

<h3 id="20151231">2015/12/31 - [ports] gophernicus moved</h3>
<em>in.gophernicus</em> moved from <tt>/usr/local/sbin/</tt> to <tt>/usr/local/libexec</tt>.
Please remember to update your <tt>/etc/inetd.conf</tt> accordingly.

<h3 id="20160105">2016/01/05 - pf.conf(5) <em>set debug</em> syntax change</h3>
<em>set debug</em> no longer accepts the <tt>none</tt>, <tt>urgent</tt>, <tt>misc</tt> and
<tt>loud</tt> arguments, which were deprecated several releases ago.
Use <tt>emerg</tt>, <tt>alert</tt>, <tt>crit</tt>, <tt>err</tt>,
<tt>warning</tt>, <tt>notice</tt>, <tt>info</tt> or <tt>debug</tt>
instead. Change this before updating, or your pf.conf will not load.

<p>
<hr>
<small>$OpenBSD: current.html,v 1.646 2016/01/05 22:52:40 benno Exp $</small>

</body>
</html>
