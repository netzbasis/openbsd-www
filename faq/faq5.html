<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html>
<head>

<!-- If you make edits to any FAQ documents, please start each sentence
     on a new line, and try to keep the general formatting consistent
     with the rest of the pages -->

<title>OpenBSD FAQ: Building the System from Source</title>
<meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1">
<meta name="copyright"          content="This document copyright 1998-2016
                                         by OpenBSD.">
<meta name="viewport" content="width=device-width, initial-scale=1">
<link rel="stylesheet" type="text/css" href="../openbsd.css">
<link rel="canonical" href="http://www.openbsd.org/faq/faq5.html">
</head>

<body bgcolor= "#ffffff" text= "#000000">

<h2>
<a href="../index.html">
<font color="#0000ff"><i>Open</i></font><font color="#000084">BSD</font></a>
<font color="#e00000">FAQ - Building the System from Source</font>
<small>
<a href="index.html" style="font-weight:normal; float:right">[FAQ Index]</a>
</small>
</h2>
<hr>

<ul>
<li><a href="#Flavors"    >OpenBSD's flavors</a>
<li><a href="#Snapshots"  >What are snapshots?</a>
<li><a href="#Bld"        >Building OpenBSD from source</a>
<li><a href="#Release"    >Making a release</a>
<li><a href="#Xbld"       >Building X</a>
<li><a href="#References" >Further reading on the build process</a>
<li><a href="#buildprobs" >Common problems when compiling</a>
<li><a href="#Miscellanea">Miscellaneous questions and tips</a>
<li><a href="#Options"    >Building a custom kernel</a>
<li><a href="#BootConfig" >Boot-time configuration</a>
<li><a href="#config"     >Using config(8) to change your kernel</a>
<li><a href="#VerboseBoot">Getting more verbose output during boot</a>
<li><a href="#MoreFlavors">More on OpenBSD's flavors</a>
<li><a href="#Upgrade"    >What do "upgrading" and "updating" mean?</a>
<li><a href="#CVSTips"    >CVS tips</a>
</ul>
<hr>

<h2 id="Flavors">OpenBSD's flavors</h2>

There are three flavors of OpenBSD:

<ul>
  <li><b>-release:</b>
    The version of OpenBSD shipped every six months on
    <a href="../orders.html">CD</a> and the <a href="../ftp.html">mirrors</a>.
  <p>
  <li><b>-stable:</b>
    The <i>-stable</i> branch is <i>-release</i> plus patches found on the
    <a href="../errata.html">errata page</a>.
    <p>
    When very important fixes are made to <i>-current</i>, they are backported
    into the two supported <i>-stable</i> branches.
  <li><b>-current:</b>
    The <i>-current</i> branch is where active development work is done.

    <p>
    Every six months, <i>-current</i> is tagged and becomes the next
    <i>-release</i>: a frozen point in the history of the source tree.
</ul>

Graphically, the development of these flavors looks something like this:

<blockquote><pre>
       ,------o-----------o----X                    5.6 Stable
       |      .           .
       |      .    ,------o---------o----X          5.7 Stable
       |      .    |      .         .
       |      .    |      .    ,----o----------o--&gt; 5.8 Stable
       |      .    |      .    |    .          .
       |      .    |      .    |    .    ,-----o--&gt; 5.9 Stable
       |      .    |      .    |    .    |     .
       |      .    |      .    |    .    |     .
 --&gt;5.6Rel-----&gt;5.7Rel-----&gt;5.8Rel-----&gt;5.9Rel----&gt; Current

          Time ---&gt;
</pre></blockquote>
<!-- XXXrelease -->

In the above illustration, the vertical dotted lines denote bug fixes being
incorporated into the <i>-stable</i> branches.

<p>
Further thoughts on the three flavors are <a href="#MoreFlavors">here</a>.

<h2 id="Snapshots">What are snapshots?</h2>

Between formal releases of OpenBSD, <i>snapshots</i> are made available through
the <a href="../ftp.html">mirrors</a>.
These are builds of whatever code is in the tree at the instant the builder
grabbed a copy of the code for that particular platform.

<p>
It is possible that you may uncover bugs in snapshots.
This is one of the reasons why they are built and distributed.
If you find a bug in a snapshot, make sure it is
<a href="../report.html">reported</a>.

<p>
If you desire to run <i>-current</i>, a recent snapshot is usually all you need.
Upgrading to a snapshot is the starting point before building <i>-current</i>
from source.

<p>
Details can be found on the <a href="current.html">following -current</a> page.

<h3>What code was used to build a snapshot?</h3>

It is sometimes asked if there is any way to get a copy of exactly the code
used to build a snapshot.
The answer is no.

<ol>
  <li>There is no significant benefit to this.
  <p>
  <li>Snapshots are built as desired, as time permits and as resources become
    available.
    <p>
    On fast platforms, several snapshots may be released in one day.
    On slower platforms, it may take a week or more to build a snapshot.
    Providing tags or markers in the source tree for each snapshot would be
    quite impractical.
  <li>
    Snapshots often contain experimental code that isn't yet committed
    to the CVS tree.
</ol>

<h2 id="Bld">Building OpenBSD from source</h2>

The main reference is
<a href="http://man.openbsd.org/release">release(8)</a>.
Read this manpage before you proceed.
This FAQ section is intended to help you with the necessary preparation.

<h3>Overview</h3>

Building OpenBSD from source involves a number of steps:

<p>
Preparation:

<ul>
 <li>Upgrade to the closest available binaries
 <li>Fetch the source code
</ul>

The actual process of building the base system is explained in steps 2 and 3 of
<a href="http://man.openbsd.org/release">release(8)</a>:

<ul>
 <li>Build a new kernel and boot from it
 <li>Build the userland
</ul>

Some users may also wish to

<ul>
 <li><a href="#Release">Make a release</a>
 <li><a href="#Xbld"   >Build X</a>
</ul>

which are the subject of the remainder of
<a href="http://man.openbsd.org/release">release(8)</a>.

<h3 id="BldBinary">Upgrade to the closest available binaries</h3>

Make sure you have the closest available binaries installed.
Use this table to look at where you are, where you wish to go, and what binary
you should start with:

<p>
<table border="1" style="empty-cells: show;">
<tr>
  <td><b>You are at</b></td> <td><b>Goal</b></td>
  <td><b>Binary upgrade to</b></td> <td><b>then ...</b></td>
</tr>
<tr>
  <td> Old -release </td> <td> New release </td> <td> Newest release </td>
  <td> Done! </td>
</tr>
<tr>
  <td> -release </td> <td> -stable </td> <td> Newest release </td>
  <td>Fetch &amp; build <i>-stable</i></td>
</tr>
<tr>
  <td> Old -stable</td> <td> -stable </td> <td> Newest release </td>
  <td>Fetch &amp; build <i>-stable</i></td>
</tr>
<tr>
  <td> -release </td> <td> -current </td> <td> Latest snapshot </td>
  <td> (optional) Fetch &amp; build <i>-current</i></td>
</tr>
<tr>
  <td> Old -current </td> <td> -current </td> <td> Latest snapshot </td>
  <td> (optional) Fetch &amp; build <i>-current</i></td>
</tr>
</table>

<p>
It is recommended that you install the binary sets by using the
<tt>(U)pgrade</tt> option of the install media.
If that is not possible, you can also unpack the binary sets as described
in the upgrade instructions of the release.

<h3 id="BldGetSrc">Fetching the source code</h3>

OpenBSD source is managed using the
<a href="https://savannah.nongnu.org/projects/cvs">CVS</a>
version control system.
The
<a href="http://man.openbsd.org/cvs">cvs(1)</a>
program is used to pull a copy of the desired source to your local machine
for compilation.
This can be done by using an <a href="../anoncvs.html">AnonCVS server</a>.
You can also maintain a local CVS repository using the
<a href="../cvsync.html">CVSync</a> or rsync programs available as
<a href="faq15.html#PkgMgmt">packages</a>.

<p>
First, you must <tt>cvs checkout</tt> the source tree.
After that, you maintain the tree by running <tt>cvs update</tt> to pull
updated files to your local tree.

<p>
An introduction to
<a href="http://man.openbsd.org/cvs">cvs(1)</a>
and detailed instructions for fetching the source trees are on the
<a href="../anoncvs.html">AnonCVS page</a>.
If you are new to using
<a href="http://man.openbsd.org/cvs">cvs(1)</a>,
you may also want to read the
<a href="#CVSTips">CVS tips</a>
below.

<h4>Avoiding root privileges</h4>

Avoid running
<a href="http://man.openbsd.org/cvs">cvs(1)</a>
as root.
The <tt>/usr/src</tt> directory is writable for <tt>wsrc</tt> by default.
So, add users that need to use
<a href="http://man.openbsd.org/cvs">cvs(1)</a>
to the <tt>wsrc</tt> group:

<blockquote><pre>
# <b>user mod -G wsrc exampleuser</b>
</pre></blockquote>

Since they're not part of the base install, you must create the directories
and set their permissions manually to make use of the <tt>wsrc</tt> group:

<blockquote><pre>
# <b>cd /usr</b>
# <b>mkdir -p   xenocara ports</b>
# <b>chgrp wsrc xenocara ports</b>
# <b>chmod 775  xenocara ports</b>
</pre></blockquote>

<h4>Example: Fetching the <i>-current</i> trees</h4>

We assume you are using a public AnonCVS server,
<tt>anoncvs@anoncvs.example.org:/cvs</tt>.
We also assume that
<a href="http://man.openbsd.org/sh">sh(1)</a>
is the shell.

<p>
To checkout a <i>-current</i> src tree, you can use the following:

<blockquote><pre>
$ <b>cd /usr</b>
$ <b>export CVSROOT=anoncvs@anoncvs.example.org:/cvs</b>
$ <b>cvs -d$CVSROOT checkout -P src</b>
</pre></blockquote>

Once you have a tree, you can update it at a later time:

<blockquote><pre>
$ <b>cd /usr/src</b>
$ <b>export CVSROOT=anoncvs@anoncvs.example.org:/cvs</b>
$ <b>cvs -d$CVSROOT up -Pd</b>
</pre></blockquote>

If you want them, you can fetch the <tt>xenocara</tt> and <tt>ports</tt>
trees with

<blockquote><pre>
$ <b>cvs -d$CVSROOT checkout -P xenocara ports</b>
</pre></blockquote>

As all parts of OpenBSD must be kept in sync, all trees you use should be
checked out and updated at the same time.

<h3>Build OpenBSD</h3>

At this point you are ready to build OpenBSD from source.

<p>
If you are building <i>-current</i>, review changes and special build
instructions listed in <a href="current.html">current.html</a>.

<p>
Follow the detailed instructions in
<a href="http://man.openbsd.org/release">release(8)</a>.

<h2 id="Release">Making a release</h2>

A release is the complete set of files that can be used to
<a href="faq4.html">install</a> or upgrade OpenBSD on another computer.
If you have only one computer running OpenBSD, you really don't have any reason
to make a release, as the above <a href="#Bld">build process</a> will do
everything you need.
An example use would be to build <i>-stable</i> on a fast machine, then make a
release to be installed on all your other machines.

<p>
The instructions on making a release are in
<a href="http://man.openbsd.org/release">release(8)</a>.
The release process uses the binaries created in the <tt>/usr/obj</tt>
directory in the building process above.

<p>
Note: if you wish to distribute the resultant file sets by HTTP for use by
the upgrade or install scripts, you will need to add an <tt>index.txt</tt> file
that contains the list of all the files in your newly created release.

<blockquote><pre>
# <b>ls -nT > index.txt</b>
</pre></blockquote>

<!-- XXX: add something on using signify(1) here? -->

<h2 id="Xbld">Building X</h2>

Starting with <a href="http://x.org/">X.Org</a> v7, X switched to a
modular build system, splitting the X.Org source tree into more than
three hundred more-or-less independent packages.

<p>
To simplify life for OpenBSD users, a meta-build called
<a href="http://xenocara.org">Xenocara</a> was developed.
This system converts X back into one big tree to be built in one process.
As an added bonus, this build process is much more similar to the build
process used by the rest of OpenBSD than the previous versions were.

<p>
The official instructions for building X exist in the
<a href="http://cvsweb.openbsd.org/cgi-bin/cvsweb/xenocara/README">
<tt>xenocara/README</tt></a> file and in step 5 of
<a href="http://man.openbsd.org/release">release(8)</a>.

<h2 id="References">Further reading on the build process</h2>

<ul>
  <li><a href="http://man.openbsd.org/release">release(8)</a>
  <li><a href="http://man.openbsd.org/mk.conf">mk.conf(5)</a>
  <li><a href="http://cvsweb.openbsd.org/cgi-bin/cvsweb/src/Makefile">
    <tt>src/Makefile</tt></a>
  <li><a href="http://cvsweb.openbsd.org/cgi-bin/cvsweb/xenocara/README">
    <tt>xenocara/README</tt></a>
  <li><a href="http://cvsweb.openbsd.org/cgi-bin/cvsweb/src/share/mk/bsd.README">
    <tt>/usr/share/mk/bsd.README</tt></a>
  <li><a href="http://man.openbsd.org/config">config(8)</a>
  <li><a href="http://man.openbsd.org/options">options(4)</a>
</ul>

<h2 id="buildprobs">Common problems when compiling</h2>

Most of the time, problems in the build process are caused by not following the
directions carefully.
There are occasional real problems with building <i>-current</i> from the most
recent snapshot, but failures when building <i>-release</i> or <i>-stable</i>
are almost always user error.

<p>
Most problems are usually one of the following:

<ul>
  <li>Failing to start from the <a href="#BldBinary">appropriate binaries</a>.
  <li><a href="#BldGetSrc">Checking out</a> the wrong branch of the tree.
  <li>Forgetting to read <a href="current.html">following -current</a>
    before building <i>-current</i>.
  <li>Skipping the reboot step after building and installing a new kernel.
</ul>

<h3 id="ProbObj">I forgot to <tt>make obj</tt> before <tt>make build</tt></h3>

By doing a <tt>make build</tt> before doing a <tt>make obj</tt>, you will
end up with the object files scattered in your <tt>/usr/src</tt> directory.
This is a bad thing.
If you wish to try to avoid re-fetching your entire src tree again, you
can try the following to clean out obj files:

<blockquote><pre>
$ <b>cd /usr/src</b>
$ <b>find . -type l -name obj | xargs rm</b>
$ <b>make cleandir</b>
$ <b>rm -rf /usr/obj/*</b>
$ <b>make obj</b>
</pre></blockquote>

<h3 id="sig11">The build stopped with a "Signal 11" error</h3>

Building OpenBSD and other programs from source is a task which pushes hardware
harder than most others, making intensive use of CPU, disk and memory.
Signal 11 failures are <i>typically</i> caused by hardware problems.

<p>
You will probably find it best to repair or replace the components that are
causing trouble, as problems may show themselves in other ways in the future.

<p>
For much more information, see the
<a href="http://www.bitwizard.nl/sig11/">Sig11 FAQ</a>.

<h2 id="Miscellanea">Miscellaneous questions and tips</h2>

<h3>Why is <tt>/usr/obj</tt> on its own partition?</h3>

If you build often, one benefit is simple: it is typically much faster to...

<blockquote><pre>
# <b>umount /usr/obj</b>
# <b>newfs <i>YourObjPartition</i></b>
# <b>mount /usr/obj</b>
</pre></blockquote>

...than to remove the contents of the directory with <tt>rm</tt>.

<h3>How do I not build parts of the tree?</h3>

Use the <tt>SKIPDIR</tt> option of
<a href="http://man.openbsd.org/mk.conf">mk.conf(5)</a>.

<h3>Can I cross-compile?</h3>

Cross-compiling tools are in the system, for use by developers bringing
up a new platform.
However, they are not maintained for general use.

<p>
When the developers bring up support for a new platform, one of the
first big tests is a native-build.
Building the system from source puts considerable load on the OS and machine,
and does a very good job of testing how well the system really works.
For this reason, OpenBSD does all the build process on the platform the build
is being used for.

<h2 id="Options">Building a custom kernel</h2>

It is assumed you really enjoy pain.
It is also assumed that you have a goal that can not be achieved by
either a <a href="#BootConfig">boot time configuration</a> (UKC) or
by <a href="#config">configuring a GENERIC kernel</a>.
If all of this is not true, you should stick to using GENERIC.
Really.

<p>
OpenBSD kernel generation is controlled by configuration files,
which are located in the <tt>/usr/src/sys/arch/<i>&lt;arch&gt;</i>/conf/</tt>
directory by default.
All architectures have a file, <tt>GENERIC</tt>, which is used to generate
the standard OpenBSD kernel for that platform.
There may also be other configuration files which are used to create
kernels with different focuses, for example, for minimal RAM, diskless
workstations, etc.

<p>
The configuration file is processed by
<a href="http://man.openbsd.org/config">config(8)</a>,
which creates and populates a compilation directory in <tt>../compile</tt>,
on a typical installation, that would be in
<tt>/usr/src/sys/arch/<i>&lt;arch&gt;</i>/compile/</tt>.
config(8) also creates a
<a href="http://man.openbsd.org/make">Makefile</a>,
and other files required to successfully build the kernel.

<p>
Kernel configuration options are options that you add to your kernel
configuration that place certain features into your kernel.
This allows you to have exactly the support you want, without having support
for unneeded devices.
There are a multitude of options that allow you to customize your kernel.
Here we will go over only some of them, those that are most commonly used.
Check the <a href="http://man.openbsd.org/options">options(4)</a>
man page for a complete list of options.
As these change from time to time, you should make sure you use a man page
for the same version of OpenBSD you are building.
You can also check the example configuration files that are available for
your architecture.

<p>
<b>Do not add, remove, or change options in your kernel unless you
actually have a reason to do so!  Do not edit the <tt>GENERIC</tt>
configuration file!!</b>
The only kernel configuration which is supported by the OpenBSD team is
the GENERIC kernel, the combination of the options in
<tt>/usr/src/sys/arch/&lt;<i>arch</i>&gt;/conf/GENERIC</tt>
and <tt>/usr/src/sys/conf/GENERIC</tt> <i>as shipped by the OpenBSD
team</i> (i.e., NOT edited).
Reporting a problem on a customized kernel will almost always result in
you being told to try to reproduce the problem with a GENERIC kernel.
Not all options are compatible with each other, and many options are
required for the system to work.
There is no guarantee that a custom-configured kernel can be built.
There is also no guarantee that a custom-configured kernel will actually
run, even if it compiles properly.

<p>
You can see all the platform-specific configuration files in the
<a href="http://cvsweb.openbsd.org/cgi-bin/cvsweb/src/sys/arch/">
src/sys/arch</a> directory.
As an example, the files for an amd64 kernel would be in
<a href="http://cvsweb.openbsd.org/cgi-bin/cvsweb/src/sys/arch/amd64/conf">
src/sys/arch/amd64/conf</a>.

<p>
Look closely at these files and you will notice a line near the top
similar to:

<blockquote><pre>
include "../../../conf/GENERIC"
</pre></blockquote>

This means that it is referencing another configuration file, one
that stores platform-independent options.
When creating your kernel configuration, be sure to look through
<a href="http://cvsweb.openbsd.org/cgi-bin/cvsweb/src/sys/conf/GENERIC">
sys/conf/GENERIC</a>.

<p>
Kernel configuration options should be placed in your kernel configuration
file in the format of:

<blockquote><pre>
option      <i>name</i>
</pre></blockquote>

or

<blockquote><pre>
option      <i>name=value</i>
</pre></blockquote>

For example, to place option "DEBUG" in the kernel, add a line like this:

<blockquote><pre>
option      DEBUG
</pre></blockquote>

Options in the OpenBSD kernel are translated into compiler preprocessor
options, therefore an option like DEBUG would have the source compiled
with option -DDEBUG, which is equivalent to doing a <tt>#define DEBUG</tt>
throughout the kernel.

<p>
Sometimes, you may wish to disable an option that is already defined,
typically in the <tt>src/sys/conf/GENERIC</tt> file.
While you could modify a copy of that file, a better choice would be to
use the <i>rmoption</i> statement.
For example, if you really wanted to disable the in-kernel debugger
(<i>not recommended!</i>), you would add a line such as:

<blockquote><pre>
rmoption DDB
</pre></blockquote>

in your kernel configuration file.  <tt>option DDB</tt> is defined in
<tt>src/sys/conf/GENERIC</tt>, but the above <tt>rmoption</tt> line
deactivates it.

<p>
Once again, please see
<a href="http://man.openbsd.org/options">options(4)</a>
for more information about the specifics of these options.
Also note that many of the options also have their own manual pages --
always read everything available about an option before adding or removing
it from your kernel.

<h3>Building a custom kernel</h3>

In this case, we will build a kernel that supports the
<a href="http://man.openbsd.org/boca">boca(4)</a>
ISA multi-port serial card.
This card is not in the GENERIC kernel, due to conflicts with other drivers.
There are two common ways to make a custom kernel.

<p>
The first method is to create a "wrapper" file that "includes" the standard
GENERIC kernel and any options you need that aren't in GENERIC.
In this case, our wrapper file looks like this:

<blockquote><pre>
include "arch/i386/conf/GENERIC"

boca0  at       isa? port 0x100 irq 10     # BOCA 8-port serial cards
com*   at       boca? slave ?
</pre></blockquote>

The two lines regarding the boca(4) card are copied from the commented
out lines in <tt>GENERIC</tt>, with the IRQ adjusted as needed.
The advantage to using this "wrapper" file is any unrelated changes in
GENERIC are updated automatically with any other source code update.
The disadvantage is one can not remove devices (though in general, that's
a bad idea, anyway).

<p>
The other way to generate a custom kernel is to make a copy of the
standard <tt>GENERIC</tt> config file, giving it another name, then
edit as needed.
The disadvantage to this method is that later updates to the GENERIC
configuration file have to be merged into your copy, or you have to remake
your configuration file.

<p>
In either event, after making your custom kernel configuration file,
use config(8) and make the kernel as documented <a href="#BldKernel">above</a>.

<p>
Full instructions for creating your own custom kernel are in the
<a href= "http://man.openbsd.org/config">config(8)</a>
man page.

<h2 id="BootConfig">Boot-time configuration</h2>

Sometimes when booting your system you might notice that the kernel finds
your device but maybe at the wrong IRQ.
And maybe you need to use this device right away.
Well, without rebuilding the kernel, you can use OpenBSD's boot time kernel
configuration.
This will only correct your problem for one time.
If you reboot, you will have to repeat this procedure.
So, this is only meant as a temporary fix, and you should correct the problem
using <a href="#config">config(8)</a>.
Your kernel does however need <strong>option BOOT_CONFIG</strong> in the
kernel, which GENERIC does have.

<p>
Most of this document can be found in the man page
<a href="http://man.openbsd.org/boot_config">boot_config(8)</a>.

<p>
To boot into the User Kernel Config, or UKC, use the <tt>-c</tt> option at
boot time.

<blockquote><pre>
boot> <b>boot hd0a:/bsd -c</b>
</pre></blockquote>

Or whichever kernel it is you want to boot.
Doing this will bring up a UKC prompt.
From here you can issue commands directly to the kernel specifying devices
you want to change or disable or even enable.

<p>
Here is a list of common commands in the UKC.

<ul>
<li><tt>add <strong>device</strong></tt> - Add a device through copying another
<li><tt>change <strong>devno | device </strong></tt> - Modify one or more
devices
<li><tt>disable <strong>devno | device </strong></tt> - Disable one or more
devices
<li><tt>enable <strong>devno | device </strong></tt> - Enable one or more
devices
<li><tt>find <strong>devno | device </strong></tt> - Find one or more devices
<li><tt>help</tt> - Short summary of these commands
<li><tt>list</tt> - List ALL known devices
<li><tt>exit/quit</tt> - Continue Booting
<li><tt>show <strong>[attr [val]]</strong></tt> - Show devices with an
attribute and optional with a specified value
</ul>

<p>
Once you have your kernel configured, use <tt>quit</tt> or <tt>exit</tt>
and continue booting.
After doing so, you should make the change permanent in your
kernel image, as described in <a href="#config">Using config(8) to change
your kernel</a>.

<h2 id="config">Using config(8) to change your kernel</h2>

The <tt>-e</tt> and <tt>-u</tt> options of
<a href="http://man.openbsd.org/config">config(8)</a>
can be extremely helpful and save wasted time compiling your kernel.
The <tt>-e</tt> flag allows you to enter the UKC or User Kernel Config on
a running system.
These changes will then take place on your next reboot.
The <tt>-u</tt> flag tests to see if any changes were made to the running
kernel during boot, meaning you used <tt>boot -c</tt> to enter the UKC
while booting your system.

<p>
The following example shows the disabling of the ep* devices in the kernel.
For safety's sake, you must use the <tt>-o</tt> option which writes the
changes out to the file specified.
For example: <tt>config -e -o bsd.new /bsd</tt> will write the changes to
<tt>bsd.new</tt>.
The example doesn't use the <tt>-o</tt> option, therefore changes are just
ignored and not written back to the kernel binary.
For more information pertaining to error and warning messages, read the
<a href="http://man.openbsd.org/config">config(8)</a>
man page.

<blockquote><pre>
# <b>config -e /bsd</b>
[...]
ukc> <b>?</b>
        help                                Command help list
        add             dev                 Add a device
        base            8|10|16             Base on large numbers
        change          devno|dev           Change device
        disable         attr val|devno|dev  Disable device
        enable          attr val|devno|dev  Enable device
        find            devno|dev           Find device
        list                                List configuration
        lines           count               # of lines per page
        show            [attr [val]]        Show attribute
        exit                                Exit, without saving changes
        quit                                Quit, saving current changes
        timezone        [mins [dst]]        Show/change timezone
        bufcachepercent [number]            Show/change BUFCACHEPERCENT
        nkmempg         [number]            Show/change NKMEMPAGES
ukc> <b>list</b>
  0 video* at uvideo* flags 0x0
  1 audio* at uaudio*|sb0|sb*|gus0|pas0|ess*|wss0|wss*|ym*|eap*|envy*|eso*|sv*|n
eo*|cmpci*|clcs*|clct*|auacer*|auglx*|auich*|auixp*|autri*|auvia*|azalia*|fms*|m
aestro*|esa*|yds*|emu* flags 0x0
  2 midi* at umidi*|sb0|sb*|ym*|mpu*|mpu*|autri*|eap*|envy* flags 0x0
  3 drm* at inteldrm*|radeondrm* flags 0x0
  4 inteldrm* at vga0|vga* flags 0x0
  5 radeondrm* at vga0|vga* flags 0x0
  6 radio* at udsbr*|bktr0|fms* flags 0x0
  7 vscsi0 at root flags 0x0
  8 softraid0 at root flags 0x0
  9 nsphy* at url*|udav*|mos*|axe*|aue*|xe*|ef*|hme*|lii*|bce*|ale*|alc*|age*|jm
e*|et*|nfe*|stge*|vge*|bnx*|bge*|lge*|nge*|msk*|sk*|ste*|se*|sis*|wb*|tl*|vte*|v
r*|pcn*|sf*|ti*|gem*|ne0|ne1|ne2|ne*|ne*|ne*|epic*|sm0|sm*|dc*|dc*|re*|re*|rl*|r
l*|mtd*|fxp*|fxp*|xl*|xl*|ep0|ep*|ep*|ep*|ep*|ep* phy -1 flags 0x0
 10 nsphyter* at url*|udav*|mos*|axe*|aue*|xe*|ef*|hme*|lii*|bce*|ale*|alc*|age*
|jme*|et*|nfe*|stge*|vge*|bnx*|bge*|lge*|nge*|msk*|sk*|ste*|se*|sis*|wb*|tl*|vte
*|vr*|pcn*|sf*|ti*|gem*|ne0|ne1|ne2|ne*|ne*|ne*|epic*|sm0|sm*|dc*|dc*|re*|re*|rl
*|rl*|mtd*|fxp*|fxp*|xl*|xl*|ep0|ep*|ep*|ep*|ep*|ep* phy -1 flags 0x0
[...snip...]
ukc> <b>disable ep</b>
 98 ep* disabled
 99 ep* disabled
301 ep0 disabled
302 ep* disabled
303 ep* disabled
360 ep* disabled
ukc> <b>quit</b>
not forced
</pre></blockquote>

In the above example, all <tt>ep</tt> devices are disabled in the kernel
and will not be probed.
In some situations where you have used the UKC during boot, via
<tt>boot -c</tt>, you will need these changes to be written out permanently.
To do this you need to use the <tt>-u</tt> option.
In the following example, the computer was booted into the UKC and the
<a href="http://man.openbsd.org/wi">wi(4)</a> device
was disabled.
Since changes made with <tt>boot -c</tt> are NOT permanent, these changes
must be written out.
This example writes the changes made from <tt>boot -c</tt> into a new kernel
binary: <tt>bsd.new</tt>.

<blockquote><pre>
# <b>config -e -u -o bsd.new /bsd</b>
[...]
Processing history...
167 wi* disabled
168 wi* disabled
443 wi* disabled
Enter 'help' for information
ukc> <b>quit</b>
</pre></blockquote>

<h2 id="VerboseBoot">Getting more verbose output during boot</h2>

Getting more verbose output can be very helpful when trying to debug
problems when booting.
If you have a problem wherein your boot media won't boot and need to get
more information, simply reboot.
When you get to the "boot&gt;" prompt, boot with <tt>boot -c</tt>.
This will bring you into the UKC&gt;, then do:

<blockquote><pre>
UKC> <b>verbose</b>
autoconf verbose enabled
UKC> <b>quit</b>
</pre></blockquote>

Now you will be given extremely verbose output upon boot.

<h2 id="MoreFlavors">More on OpenBSD's flavors</h2>

It is worth pointing out that the name <i>-stable</i> is not intended
to imply that <i>-current</i> is unreliable or less robust in production.
Rather, the APIs (how the programs talk to the OS) and features of
<i>-current</i> are changing and evolving, whereas the operation and APIs
of <i>-stable</i> are the same as the release it is based on.
This means you shouldn't have to relearn features of your system, change
any configuration files, or have any problem adding additional applications
to your system.

<p>
In fact, as our hope is to continually improve OpenBSD, the goal is that
<i>-current</i> should be more reliable, more secure and, of course, have
greater features than <i>-stable</i>.
Put bluntly, the "best" version of OpenBSD is <i>-current</i>.

<p>
Most users should be running either <i>-stable</i> or <i>-release</i>.
That being said, many people do run <i>-current</i> on production systems,
and it is important that people do so to identify bugs and test new features.
However, if you don't know how to properly describe, diagnose and deal with
a problem, don't tell yourself (or anyone else) that you're "helping the
project" by running <i>-current</i>.
"It didn't work!" is not a useful <a href="../report.html#bugtypes">
bug report</a>.
"The recent changes to the pciide driver broke compatibility with my
Slugchip-based IDE interface, dmesg of working and broken systems follow..."
might be a useful report.

<p>
There are times when "normal" users may wish to live on the cutting
edge and run <i>-current</i>.
The most common reason is that the user has a device which is not supported
by <i>-release</i> (and thus, not <i>-stable</i>), or wishes to use a new
feature of <i>-current</i>.
In this case, the choice may be either <i>-current</i> or not using the
device, and <i>-current</i> may be the better option.
However, one should not expect hand-holding from the developers.

<h2 id="Upgrade">What do "upgrading" and "updating" mean?</h2>

You will often see references to upgrading and updating OpenBSD installs.
Even though these words have similar meanings, they are used slightly
differently in OpenBSD.

<h3>Upgrading</h3>

This is the process of installing a newer version of OpenBSD, with new
functionality.
For example, going from one release to another, or going from the June 12th
snapshot to the June 20th snapshot.
When upgrading, you will typically have to consult either
<a href="current.html">following -current</a> or the upgrade guide (when
changing releases) to make the changes required to run the upgraded version
of OpenBSD.

<h3>Updating</h3>

The process of applying patches to a system to improve the operation
<b>without</b> changing the basic functionality or binary compatibility.
This is typically done by following the
<a href="faq10.html#Patches">source patching process</a>
or by following the
<a href="../stable.html">stable process</a>.
When you update your system, it goes from a <i>-release</i> to <i>-stable</i>
(or patched <i>-release</i>) of the same release version.
You may then later update it to a newer <i>-stable</i> of the same release
version.
The update process is typically very painless, as no <tt>/etc</tt> files
or other system configurations need to be changed.

<p>
So, you may install a -release system from CD, then update it to -stable
a few times, then upgrade it to the next release from CD, and update that
a few times before upgrading it again to the following release.

<h3>Keeping things in sync</h3>

It is important to understand that OpenBSD is an operating system intended
to be taken as a whole, not a kernel with a bunch of utilities stuck on.

<p>
You must make sure your kernel, userland (the supporting utilities and files)
and <a href="faq15.html#Ports">ports</a> tree are all in sync, or unpleasant
things will happen.

<p>
One should also understand that the upgrade process is supported in
<b>only one direction: from older to newer</b>, and from <i>-stable</i> to
<i>-current</i>.
You can not run <i>-current</i> (or a snapshot), then decide you are living
too dangerously, and step back to <i>-stable</i>.
You are on your own if you choose any path other than the supported option
of reloading your system from scratch.

<h2 id="CVSTips">CVS tips</h2>

<ul>
  <li>Some <a href="http://man.openbsd.org/cvs">cvs(1)</a>
    options are mandatory to get a valid OpenBSD <tt>src</tt> tree:

    <p>
    The <tt>-P</tt> option removes directories that are empty.
    Sometimes the names of old directories are currently used as file names.

    <p>
    The <tt>-d</tt> option on the <tt>update</tt> command creates new
    directories that may have been added to the tree since the initial checkout.

  <li>A <tt>.cvsrc</tt> file in your home directory specifies defaults for
    some of these options:

    <blockquote><pre>
    cvs -q -d anoncvs@anoncvs.example.org:/cvs
    diff -uNp
    update -Pd
    checkout -P
    rdiff -u
    </pre></blockquote>

  <li>
    Many people recommend <i>always</i> specifying the repository explicitly in
    the command line.
    While the AnonCVS server is recorded in the checked out tree, there are
    enough times where one may need to override it.

    <p>
    Note also that the <tt>CVSROOT</tt> environment variable is only used if
    <a href="http://man.openbsd.org/cvs">cvs(1)</a>
    would throw an error without it.

  <li>As the source trees consist of large numbers of mostly small files,
    turning on <a href="faq14.html#SoftUpdates">soft updates</a> for the
    partition the source tree is on will often give significantly better
    performance.

  <p>
  <!-- XXXrelease - replace version strings in cvs commands -->
  <li>
    To see the changes of the defaults in the <tt>/etc</tt> directory between
    5.8 and 5.9, run:

    <blockquote><pre>
    $ <b>cd /usr/src/etc</b>
    $ <b>cvs diff -u -rOPENBSD_5_8 -rOPENBSD_5_9</b>
    </pre></blockquote>

    To see the changes between 5.9 and <i>-current</i>, use:

    <blockquote><pre>
    $ <b>cd /usr/src/etc</b>
    $ <b>cvs diff -u -rOPENBSD_5_9 -rHEAD</b>
    </pre></blockquote>
</ul>

<p>
</body>
</html>
