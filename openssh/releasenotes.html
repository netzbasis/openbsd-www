<!--
	DO NOT EDIT MANUALLY!  This is generated from:
	www/build/openssh/releasenotes.html.head
	www/build/openssh/releasenotes.html.tail

	See comments in www/build/openssh/Makefile for details.
-->

<!doctype html>
<html lang=en>
<meta charset=utf-8>

<title>OpenSSH: Release Notes</title>
<meta name="description" content="OpenSSH release notes">
<meta name="viewport" content="width=device-width, initial-scale=1">
<link rel="canonical" href="https://www.openssh.com/releasenotes.html">
<link rel="stylesheet" type="text/css" href="openbsd.css">

<h2 id=OpenBSD>
<a href="/">
<i>Open</i><b>SSH</b></a>
Release Notes
</h2>
<hr>
<h3><a href='txt/release-8.2' id='8.2'>OpenSSH 8.2</a>/<a href='txt/release-8.2' id='8.2p1'>8.2p1</a> (2020-02-14)</h3>
<pre>
OpenSSH 8.2 was released on 2020-02-14. It is available from the
mirrors listed at <a href='https://www.openssh.com/'>https://www.openssh.com/</a>.
OpenSSH is a 100% complete SSH protocol 2.0 implementation and
includes sftp client and server support.

Once again, we would like to thank the OpenSSH community for their
continued support of the project, especially those who contributed
code or patches, reported bugs, tested snapshots or donated to the
project. More information on donations may be found at:
<a href='https://www.openssh.com/donations.html'>https://www.openssh.com/donations.html</a>

Future deprecation notice
=========================

It is now possible[1] to perform chosen-prefix attacks against the
SHA-1 hash algorithm for less than USD$50K. For this reason, we will
be disabling the "ssh-rsa" public key signature algorithm that depends
on SHA-1 by default in a near-future release.

This algorithm is unfortunately still used widely despite the
existence of better alternatives, being the only remaining public key
signature algorithm specified by the original SSH RFCs.

The better alternatives include:

 * The <a href='https://tools.ietf.org/html/rfc8332'>RFC8332</a> RSA SHA-2 signature algorithms rsa-sha2-256/512. These
   algorithms have the advantage of using the same key type as
   "ssh-rsa" but use the safe SHA-2 hash algorithms. These have been
   supported since OpenSSH 7.2 and are already used by default if the
   client and server support them.

 * The ssh-ed25519 signature algorithm. It has been supported in
   OpenSSH since release 6.5.

 * The <a href='https://tools.ietf.org/html/rfc5656'>RFC5656</a> ECDSA algorithms: ecdsa-sha2-nistp256/384/521. These
   have been supported by OpenSSH since release 5.7.

To check whether a server is using the weak ssh-rsa public key
algorithm for host authentication, try to connect to it after
removing the ssh-rsa algorithm from <a href='https://man.openbsd.org/ssh.1'>ssh(1)</a>'s allowed list:

    ssh -oHostKeyAlgorithms=-ssh-rsa user@host

If the host key verification fails and no other supported host key
types are available, the server software on that host should be
upgraded.

A future release of OpenSSH will enable UpdateHostKeys by default
to allow the client to automatically migrate to better algorithms.
Users may consider enabling this option manually.

[1] "SHA-1 is a Shambles: First Chosen-Prefix Collision on SHA-1 and
    Application to the PGP Web of Trust" Leurent, G and Peyrin, T
    (2020) <a href='https://eprint.iacr.org/2020/014.pdf'>https://eprint.iacr.org/2020/014.pdf</a>

Security
========

 * <a href='https://man.openbsd.org/ssh.1'>ssh(1)</a>, <a href='https://man.openbsd.org/sshd.8'>sshd(8)</a>, <a href='https://man.openbsd.org/ssh-keygen.1'>ssh-keygen(1)</a>: this release removes the "ssh-rsa"
   (RSA/SHA1) algorithm from those accepted for certificate signatures
   (i.e. the client and server CASignatureAlgorithms option) and will
   use the rsa-sha2-512 signature algorithm by default when the
   <a href='https://man.openbsd.org/ssh-keygen.1'>ssh-keygen(1)</a> CA signs new certificates.

   Certificates are at special risk to the aforementioned SHA1
   collision vulnerability as an attacker has effectively unlimited
   time in which to craft a collision that yields them a valid
   certificate, far more than the relatively brief LoginGraceTime
   window that they have to forge a host key signature.

   The OpenSSH certificate format includes a CA-specified (typically
   random) nonce value near the start of the certificate that should
   make exploitation of chosen-prefix collisions in this context
   challenging, as the attacker does not have full control over the
   prefix that actually gets signed. Nonetheless, SHA1 is now a
   demonstrably broken algorithm and futher improvements in attacks
   are highly likely.

   OpenSSH releases prior to 7.2 do not support the newer RSA/SHA2
   algorithms and will refuse to accept certificates signed by an
   OpenSSH 8.2+ CA using RSA keys unless the unsafe algorithm is
   explicitly selected during signing ("ssh-keygen -t ssh-rsa").
   Older clients/servers may use another CA key type such as
   ssh-ed25519 (supported since OpenSSH 6.5) or one of the
   ecdsa-sha2-nistp256/384/521 types (supported since OpenSSH 5.7)
   instead if they cannot be upgraded.

Potentially-incompatible changes
================================

This release includes a number of changes that may affect existing
configurations:

 * <a href='https://man.openbsd.org/ssh.1'>ssh(1)</a>, <a href='https://man.openbsd.org/sshd.8'>sshd(8)</a>: the above removal of "ssh-rsa" from the accepted
   CASignatureAlgorithms list.

 * <a href='https://man.openbsd.org/ssh.1'>ssh(1)</a>, <a href='https://man.openbsd.org/sshd.8'>sshd(8)</a>: this release removes diffie-hellman-group14-sha1
   from the default key exchange proposal for both the client and
   server.

 * <a href='https://man.openbsd.org/ssh-keygen.1'>ssh-keygen(1)</a>: the command-line options related to the generation
   and screening of safe prime numbers used by the
   diffie-hellman-group-exchange-* key exchange algorithms have
   changed. Most options have been folded under the -O flag.

 * <a href='https://man.openbsd.org/sshd.8'>sshd(8)</a>: the sshd listener process title visible to ps(1) has
   changed to include information about the number of connections that
   are currently attempting authentication and the limits configured
   by MaxStartups.

 * ssh-sk-helper(8): this is a new binary. It is used by the FIDO/U2F
   support to provide address-space isolation for token middleware
   libraries (including the internal one). It needs to be installed
   in the expected path, typically under /usr/libexec or similar.

Changes since OpenSSH 8.1
=========================

This release contains some significant new features.

FIDO/U2F Support
----------------

This release adds support for FIDO/U2F hardware authenticators to
OpenSSH. U2F/FIDO are open standards for inexpensive two-factor
authentication hardware that are widely used for website
authentication.  In OpenSSH FIDO devices are supported by new public
key types "ecdsa-sk" and "ed25519-sk", along with corresponding
certificate types.

<a href='https://man.openbsd.org/ssh-keygen.1'>ssh-keygen(1)</a> may be used to generate a FIDO token-backed key, after
which they may be used much like any other key type supported by
OpenSSH, so long as the hardware token is attached when the keys are
used. FIDO tokens also generally require the user explicitly authorise
operations by touching or tapping them.

Generating a FIDO key requires the token be attached, and will usually
require the user tap the token to confirm the operation:

  $ ssh-keygen -t ecdsa-sk -f ~/.ssh/id_ecdsa_sk
  Generating public/private ecdsa-sk key pair.
  You may need to touch your security key to authorize key generation.
  Enter file in which to save the key (/home/djm/.ssh/id_ecdsa_sk): 
  Enter passphrase (empty for no passphrase): 
  Enter same passphrase again: 
  Your identification has been saved in /home/djm/.ssh/id_ecdsa_sk
  Your public key has been saved in /home/djm/.ssh/id_ecdsa_sk.pub

This will yield a public and private key-pair. The private key file
should be useless to an attacker who does not have access to the
physical token. After generation, this key may be used like any other
supported key in OpenSSH and may be listed in authorized_keys, added
to <a href='https://man.openbsd.org/ssh-agent.1'>ssh-agent(1)</a>, etc. The only additional stipulation is that the FIDO
token that the key belongs to must be attached when the key is used.

FIDO tokens are most commonly connected via USB but may be attached
via other means such as Bluetooth or NFC. In OpenSSH, communication
with the token is managed via a middleware library, specified by the
SecurityKeyProvider directive in ssh/<a href='https://man.openbsd.org/sshd_config.5'>sshd_config(5)</a> or the
$SSH_SK_PROVIDER environment variable for <a href='https://man.openbsd.org/ssh-keygen.1'>ssh-keygen(1)</a> and
<a href='https://man.openbsd.org/ssh-add.1'>ssh-add(1)</a>. The API for this middleware is documented in the sk-api.h
and PROTOCOL.u2f files in the source distribution.

OpenSSH includes a middleware ("SecurityKeyProvider=internal") with
support for USB tokens. It is automatically enabled in OpenBSD and may
be enabled in portable OpenSSH via the configure flag
--with-security-key-builtin. If the internal middleware is enabled
then it is automatically used by default. This internal middleware
requires that libfido2 (<a href='https://github.com/Yubico/libfido2'>https://github.com/Yubico/libfido2</a>)and its
dependencies be installed. We recommend that packagers of portable
OpenSSH enable the built-in middleware, as it provides the
lowest-friction experience for users.

Note: FIDO/U2F tokens are required to implement the ECDSA-P256
"ecdsa-sk" key type, but hardware support for Ed25519 "ed25519-sk" is
less common. Similarly, not all hardware tokens support some of the
optional features such as resident keys.

The protocol-level changes to support FIDO/U2F keys in SSH are
documented in the PROTOCOL.u2f file in the OpenSSH source
distribution.

There are a number of supporting changes to this feature:

 * <a href='https://man.openbsd.org/ssh-keygen.1'>ssh-keygen(1)</a>: add a "no-touch-required" option when generating
   FIDO-hosted keys, that disables their default behaviour of
   requiring a physical touch/tap on the token during authentication.
   Note: not all tokens support disabling the touch requirement.

 * <a href='https://man.openbsd.org/sshd.8'>sshd(8)</a>: add a sshd_config PubkeyAuthOptions directive that
   collects miscellaneous public key authentication-related options
   for <a href='https://man.openbsd.org/sshd.8'>sshd(8)</a>. At present it supports only a single option
   "no-touch-required". This causes sshd to skip its default check for
   FIDO/U2F keys that the signature was authorised by a touch or press
   event on the token hardware.

 * <a href='https://man.openbsd.org/ssh.1'>ssh(1)</a>, <a href='https://man.openbsd.org/sshd.8'>sshd(8)</a>, <a href='https://man.openbsd.org/ssh-keygen.1'>ssh-keygen(1)</a>: add a "no-touch-required" option
   for authorized_keys and a similar extension for certificates. This
   option disables the default requirement that FIDO key signatures
   attest that the user touched their key to authorize them, mirroring
   the similar PubkeyAuthOptions sshd_config option.

 * <a href='https://man.openbsd.org/ssh-keygen.1'>ssh-keygen(1)</a>: add support for the writing the FIDO attestation
   information that is returned when new keys are generated via the
   "-O write-attestation=/path" option. FIDO attestation certificates
   may be used to verify that a FIDO key is hosted in trusted
   hardware. OpenSSH does not currently make use of this information,
   beyond optionally writing it to disk.

FIDO2 resident keys
-------------------

FIDO/U2F OpenSSH keys consist of two parts: a "key handle" part stored
in the private key file on disk, and a per-device private key that is
unique to each FIDO/U2F token and that cannot be exported from the
token hardware. These are combined by the hardware at authentication
time to derive the real key that is used to sign authentication
challenges.

For tokens that are required to move between computers, it can be
cumbersome to have to move the private key file first. To avoid this
requirement, tokens implementing the newer FIDO2 standard support
"resident keys", where it is possible to effectively retrieve the key
handle part of the key from the hardware.

OpenSSH supports this feature, allowing resident keys to be generated
using the <a href='https://man.openbsd.org/ssh-keygen.1'>ssh-keygen(1)</a> "-O resident" flag. This will produce a
public/private key pair as usual, but it will be possible to retrieve
the private key part from the token later. This may be done using
"ssh-keygen -K", which will download all available resident keys from
the tokens attached to the host and write public/private key files
for them. It is also possible to download and add resident keys
directly to <a href='https://man.openbsd.org/ssh-agent.1'>ssh-agent(1)</a> without writing files to the file-system
using "ssh-add -K".

Resident keys are indexed on the token by the application string and
user ID. By default, OpenSSH uses an application string of "ssh:" and
an empty user ID. If multiple resident keys on a single token are
desired then it may be necessary to override one or both of these
defaults using the <a href='https://man.openbsd.org/ssh-keygen.1'>ssh-keygen(1)</a> "-O application=" or "-O user="
options. Note: OpenSSH will only download and use resident keys whose
application string begins with "ssh:"

Storing both parts of a key on a FIDO token increases the likelihood
of an attacker being able to use a stolen token device. For this
reason, tokens should enforce PIN authentication before allowing
download of keys, and users should set a PIN on their tokens before
creating any resident keys.

Other New Features
------------------

 * <a href='https://man.openbsd.org/sshd.8'>sshd(8)</a>: add an Include sshd_config keyword that allows including
   additional configuration files via glob(3) patterns. <a href='https://bugzilla.mindrot.org/show_bug.cgi?id=2468'>bz2468</a>

 * <a href='https://man.openbsd.org/ssh.1'>ssh(1)</a>/<a href='https://man.openbsd.org/sshd.8'>sshd(8)</a>: make the LE (low effort) DSCP code point available
   via the IPQoS directive; <a href='https://bugzilla.mindrot.org/show_bug.cgi?id=2986'>bz2986</a>,

 * <a href='https://man.openbsd.org/ssh.1'>ssh(1)</a>: when AddKeysToAgent=yes is set and the key contains no
   comment, add the key to the agent with the key's path as the
   comment. <a href='https://bugzilla.mindrot.org/show_bug.cgi?id=2564'>bz2564</a>
    
 * <a href='https://man.openbsd.org/ssh-keygen.1'>ssh-keygen(1)</a>, <a href='https://man.openbsd.org/ssh-agent.1'>ssh-agent(1)</a>: expose PKCS#11 key labels and X.509
   subjects as key comments, rather than simply listing the PKCS#11
   provider library path. <a href='https://github.com/openssh/openssh-portable/pull/138'>PR138</a>

 * <a href='https://man.openbsd.org/ssh-keygen.1'>ssh-keygen(1)</a>: allow PEM export of DSA and ECDSA keys; <a href='https://bugzilla.mindrot.org/show_bug.cgi?id=3091'>bz3091</a>

 * <a href='https://man.openbsd.org/ssh.1'>ssh(1)</a>, <a href='https://man.openbsd.org/sshd.8'>sshd(8)</a>: make zlib compile-time optional, available via the
   Makefile.inc ZLIB flag on OpenBSD or via the --with-zlib configure
   option for OpenSSH portable.

 * <a href='https://man.openbsd.org/sshd.8'>sshd(8)</a>: when clients get denied by MaxStartups, send a
   notification prior to the SSH2 protocol banner according to
   <a href='https://tools.ietf.org/html/rfc4253'>RFC4253</a> section 4.2.

 * <a href='https://man.openbsd.org/ssh.1'>ssh(1)</a>, <a href='https://man.openbsd.org/ssh-agent.1'>ssh-agent(1)</a>: when invoking the $SSH_ASKPASS prompt
   program, pass a hint to the program to describe the type of
   desired prompt.  The possible values are "confirm" (indicating
   that a yes/no confirmation dialog with no text entry should be
   shown), "none" (to indicate an informational message only), or
   blank for the original ssh-askpass behaviour of requesting a
   password/phrase.

 * <a href='https://man.openbsd.org/ssh.1'>ssh(1)</a>: allow forwarding a different agent socket to the path
   specified by $SSH_AUTH_SOCK, by extending the existing ForwardAgent
   option to accepting an explicit path or the name of an environment
   variable in addition to yes/no.
   
 * <a href='https://man.openbsd.org/ssh-keygen.1'>ssh-keygen(1)</a>: add a new signature operations "find-principals" to
   look up the principal associated with a signature from an allowed-
   signers file.
    
 * <a href='https://man.openbsd.org/sshd.8'>sshd(8)</a>: expose the number of currently-authenticating connections
   along with the MaxStartups limit in the process title visible to
   "ps".

Bugfixes
--------

 * <a href='https://man.openbsd.org/sshd.8'>sshd(8)</a>: make ClientAliveCountMax=0 have sensible semantics: it
   will now disable connection killing entirely rather than the
   current behaviour of instantly killing the connection after the
   first liveness test regardless of success. <a href='https://bugzilla.mindrot.org/show_bug.cgi?id=2627'>bz2627</a>
    
 * <a href='https://man.openbsd.org/sshd.8'>sshd(8)</a>: clarify order of AllowUsers / DenyUsers vs AllowGroups /
   DenyGroups in the <a href='https://man.openbsd.org/sshd.8'>sshd(8)</a> manual page. <a href='https://bugzilla.mindrot.org/show_bug.cgi?id=1690'>bz1690</a>

 * <a href='https://man.openbsd.org/sshd.8'>sshd(8)</a>: better describe HashKnownHosts in the manual page. <a href='https://bugzilla.mindrot.org/show_bug.cgi?id=2560'>bz2560</a>

 * <a href='https://man.openbsd.org/sshd.8'>sshd(8)</a>: clarify that that permitopen=/PermitOpen do no name or
   address translation in the manual page. <a href='https://bugzilla.mindrot.org/show_bug.cgi?id=3099'>bz3099</a>

 * <a href='https://man.openbsd.org/sshd.8'>sshd(8)</a>: allow the UpdateHostKeys feature to function when
   multiple known_hosts files are in use. When updating host keys,
   ssh will now search subsequent known_hosts files, but will add
   updated host keys to the first specified file only. <a href='https://bugzilla.mindrot.org/show_bug.cgi?id=2738'>bz2738</a>
    
 * All: replace all calls to signal(2) with a wrapper around
   sigaction(2). This wrapper blocks all other signals during the
   handler preventing races between handlers, and sets SA_RESTART
   which should reduce the potential for short read/write operations.
    
 * <a href='https://man.openbsd.org/sftp.1'>sftp(1)</a>: fix a race condition in the SIGCHILD handler that could
   turn in to a kill(-1); <a href='https://bugzilla.mindrot.org/show_bug.cgi?id=3084'>bz3084</a>

 * <a href='https://man.openbsd.org/sshd.8'>sshd(8)</a>: fix a case where valid (but extremely large) SSH channel
   IDs were being incorrectly rejected. <a href='https://bugzilla.mindrot.org/show_bug.cgi?id=3098'>bz3098</a>

 * <a href='https://man.openbsd.org/ssh.1'>ssh(1)</a>: when checking host key fingerprints as answers to new
   hostkey prompts, ignore whitespace surrounding the fingerprint
   itself.

 * All: wait for file descriptors to be readable or writeable during
   non-blocking connect, not just readable. Prevents a timeout when
   the server doesn't immediately send a banner (e.g. multiplexers
   like sslh)
 
 * <a href='https://man.openbsd.org/sshd_config.5'>sshd_config(5)</a>: document the sntrup4591761x25519-sha512@tinyssh.org
   key exchange algorithm. PR#151

Portability
-----------

 * <a href='https://man.openbsd.org/sshd.8'>sshd(8)</a>: multiple adjustments to the Linux seccomp sandbox:
   - Non-fatally deny IPC syscalls in sandbox
   - Allow clock_gettime64() in sandbox (MIPS / glibc &gt;= 2.31)
   - Allow clock_nanosleep_time64 in sandbox (ARM) <a href='https://bugzilla.mindrot.org/show_bug.cgi?id=3100'>bz3100</a>
   - Allow clock_nanosleep() in sandbox (recent glibc) <a href='https://bugzilla.mindrot.org/show_bug.cgi?id=3093'>bz3093</a>

 * Explicit check for memmem declaration and fix up declaration if the
   system headers lack it. <a href='https://bugzilla.mindrot.org/show_bug.cgi?id=3102'>bz3102</a>
 
Checksums:
==========

 - SHA1 (<a href='https://cdn.openbsd.org/pub/OpenBSD/OpenSSH/openssh-8.2.tar.gz'>openssh-8.2.tar.gz</a>) = 0daae2a8c47c489a8784f2c38c4b39e6159ba678
 - SHA256 (<a href='https://cdn.openbsd.org/pub/OpenBSD/OpenSSH/openssh-8.2.tar.gz'>openssh-8.2.tar.gz</a>) = +UmInEIoHJqYqWneMb/kgRbLcq8WDCo7+ooYcjzW4jg=

 - SHA1 (<a href='https://cdn.openbsd.org/pub/OpenBSD/OpenSSH/portable/openssh-8.2p1.tar.gz'>openssh-8.2p1.tar.gz</a>) = d1ab35a93507321c5db885e02d41ce1414f0507c
 - SHA256 (<a href='https://cdn.openbsd.org/pub/OpenBSD/OpenSSH/portable/openssh-8.2p1.tar.gz'>openssh-8.2p1.tar.gz</a>) = Q5JRUebPbO4UUBkMDpr03Da0HBJzdhnt/4vOvf9k5nE=

Note: the openssh-8.2 tarball for OpenBSD that was initially released
advertised an incorrect version for "ssh -V" and the sshd server
banner. The above tarball replace the incorrect release, which has
been renamed to <a href='https://cdn.openbsd.org/pub/OpenBSD/OpenSSH/openssh-8.2.tar.gz'>openssh-8.2.tar.gz</a>.incorrect. These are the checksums
for the original, incorrect tarball:

 - SHA1 (<a href='https://cdn.openbsd.org/pub/OpenBSD/OpenSSH/openssh-8.2.tar.gz'>openssh-8.2.tar.gz</a>) = 77584c22fbb89269398acdf53c1e554400584ba8
 - SHA256 (<a href='https://cdn.openbsd.org/pub/OpenBSD/OpenSSH/openssh-8.2.tar.gz'>openssh-8.2.tar.gz</a>) = UttLaaSYXVK1O65cYvyQzyQ5sCfuJ4Lwrs8zNsPrluQ=

Please note that the SHA256 signatures are base64 encoded and not
hexadecimal (which is the default for most checksum tools). The PGP
key used to sign the releases is available as RELEASE_KEY.asc from
the mirror sites.

Reporting Bugs:
===============

- Please read <a href='https://www.openssh.com/report.html'>https://www.openssh.com/report.html</a>
  Security bugs should be reported directly to openssh@openssh.com

</pre><hr>
<h3><a href='txt/release-8.1' id='8.1'>OpenSSH 8.1</a>/<a href='txt/release-8.1' id='8.1p1'>8.1p1</a> (2019-10-09)</h3>
<pre>
OpenSSH 8.1 was released on 2019-10-09. It is available from the
mirrors listed at <a href='https://www.openssh.com/'>https://www.openssh.com/</a>.
OpenSSH is a 100% complete SSH protocol 2.0 implementation and
includes sftp client and server support.

Once again, we would like to thank the OpenSSH community for their
continued support of the project, especially those who contributed
code or patches, reported bugs, tested snapshots or donated to the
project. More information on donations may be found at:
<a href='http://www.openssh.com/donations.html'>http://www.openssh.com/donations.html</a>

Security
========

 * <a href='https://man.openbsd.org/ssh.1'>ssh(1)</a>, <a href='https://man.openbsd.org/sshd.8'>sshd(8)</a>, <a href='https://man.openbsd.org/ssh-add.1'>ssh-add(1)</a>, <a href='https://man.openbsd.org/ssh-keygen.1'>ssh-keygen(1)</a>: an exploitable integer
   overflow bug was found in the private key parsing code for the XMSS
   key type. This key type is still experimental and support for it is
   not compiled by default. No user-facing autoconf option exists in
   portable OpenSSH to enable it. This bug was found by Adam Zabrocki
   and reported via SecuriTeam's SSD program.

 * <a href='https://man.openbsd.org/ssh.1'>ssh(1)</a>, <a href='https://man.openbsd.org/sshd.8'>sshd(8)</a>, <a href='https://man.openbsd.org/ssh-agent.1'>ssh-agent(1)</a>: add protection for private keys at
   rest in RAM against speculation and memory side-channel attacks like
   Spectre, Meltdown and Rambleed. This release encrypts private keys
   when they are not in use with a symmetric key that is derived from a
   relatively large "prekey" consisting of random data (currently 16KB).

Potentially-incompatible changes
================================

This release includes a number of changes that may affect existing
configurations:

 * <a href='https://man.openbsd.org/ssh-keygen.1'>ssh-keygen(1)</a>: when acting as a CA and signing certificates with
   an RSA key, default to using the rsa-sha2-512 signature algorithm.
   Certificates signed by RSA keys will therefore be incompatible
   with OpenSSH versions prior to 7.2 unless the default is
   overridden (using "ssh-keygen -t ssh-rsa -s ...").

Changes since OpenSSH 8.0
=========================

This release is focused on bug-fixing.

New Features
------------

 * <a href='https://man.openbsd.org/ssh.1'>ssh(1)</a>: Allow %n to be expanded in ProxyCommand strings

 * <a href='https://man.openbsd.org/ssh.1'>ssh(1)</a>, <a href='https://man.openbsd.org/sshd.8'>sshd(8)</a>: Allow prepending a list of algorithms to the
   default set by starting the list with the '^' character, E.g.
   "HostKeyAlgorithms ^ssh-ed25519"

 * <a href='https://man.openbsd.org/ssh-keygen.1'>ssh-keygen(1)</a>: add an experimental lightweight signature and
   verification ability. Signatures may be made using regular ssh keys
   held on disk or stored in a ssh-agent and verified against an
   authorized_keys-like list of allowed keys. Signatures embed a
   namespace that prevents confusion and attacks between different
   usage domains (e.g. files vs email).

 * <a href='https://man.openbsd.org/ssh-keygen.1'>ssh-keygen(1)</a>: print key comment when extracting public key from a
   private key.  <a href='https://bugzilla.mindrot.org/show_bug.cgi?id=3052'>bz#3052</a>

 * <a href='https://man.openbsd.org/ssh-keygen.1'>ssh-keygen(1)</a>: accept the verbose flag when searching for host keys
   in known hosts (i.e. "ssh-keygen -vF host") to print the matching
   host's random-art signature too. <a href='https://bugzilla.mindrot.org/show_bug.cgi?id=3003'>bz#3003</a>

 * All: support PKCS8 as an optional format for storage of private
   keys to disk.  The OpenSSH native key format remains the default,
   but PKCS8 is a superior format to PEM if interoperability with
   non-OpenSSH software is required, as it may use a less insecure
   key derivation function than PEM's.

Bugfixes
--------

 * <a href='https://man.openbsd.org/ssh.1'>ssh(1)</a>: if a PKCS#11 token returns no keys then try to login and
   refetch them. Based on patch from Jakub Jelen; <a href='https://bugzilla.mindrot.org/show_bug.cgi?id=2430'>bz#2430</a>

 * <a href='https://man.openbsd.org/ssh.1'>ssh(1)</a>: produce a useful error message if the user's shell is set
   incorrectly during "match exec" processing. <a href='https://bugzilla.mindrot.org/show_bug.cgi?id=2791'>bz#2791</a>

 * <a href='https://man.openbsd.org/sftp.1'>sftp(1)</a>: allow the maximum uint32 value for the argument passed
   to -b which allows better error messages from later validation.
   <a href='https://bugzilla.mindrot.org/show_bug.cgi?id=3050'>bz#3050</a>

 * <a href='https://man.openbsd.org/ssh.1'>ssh(1)</a>: avoid pledge sandbox violations in some combinations of
   remote forwarding, connection multiplexing and ControlMaster.

 * ssh-keyscan(1): include SHA2-variant RSA key algorithms in KEX
   proposal; allows ssh-keyscan to harvest keys from servers that
   disable old SHA1 ssh-rsa. <a href='https://bugzilla.mindrot.org/show_bug.cgi?id=3029'>bz#3029</a>

 * <a href='https://man.openbsd.org/sftp.1'>sftp(1)</a>: print explicit "not modified" message if a file was
   requested for resumed download but was considered already complete.
   <a href='https://bugzilla.mindrot.org/show_bug.cgi?id=2978'>bz#2978</a>

 * <a href='https://man.openbsd.org/sftp.1'>sftp(1)</a>: fix a typo and make &lt;esc&gt;&lt;right&gt; move right to the
   closest end of a word just like &lt;esc&gt;&lt;left&gt; moves left to the
   closest beginning of a word.

 * <a href='https://man.openbsd.org/sshd.8'>sshd(8)</a>: cap the number of permitopen/permitlisten directives
   allowed to appear on a single authorized_keys line.

 * All: fix a number of memory leaks (one-off or on exit paths).

 * Regression tests: a number of fixes and improvements, including
   fixes to the interop tests, adding the ability to run most tests
   on builds that disable OpenSSL support, better support for running
   tests under Valgrind and a number of bug-fixes.

 * <a href='https://man.openbsd.org/ssh.1'>ssh(1)</a>, <a href='https://man.openbsd.org/sshd.8'>sshd(8)</a>: check for convtime() refusing to accept times that
   resolve to LONG_MAX Reported by Kirk Wolf <a href='https://bugzilla.mindrot.org/show_bug.cgi?id=2977'>bz2977</a>

 * <a href='https://man.openbsd.org/ssh.1'>ssh(1)</a>: slightly more instructive error message when the user
   specifies multiple -J options on the command-line. <a href='https://bugzilla.mindrot.org/show_bug.cgi?id=3015'>bz3015</a>

 * <a href='https://man.openbsd.org/ssh-agent.1'>ssh-agent(1)</a>: process agent requests for RSA certificate private
   keys using correct signature algorithm when requested. <a href='https://bugzilla.mindrot.org/show_bug.cgi?id=3016'>bz3016</a>

 * <a href='https://man.openbsd.org/sftp.1'>sftp(1)</a>: check for user@host when parsing sftp target. This
   allows user@[1.2.3.4] to work without a path.  <a href='https://bugzilla.mindrot.org/show_bug.cgi?id=2999'>bz#2999</a>

 * <a href='https://man.openbsd.org/sshd.8'>sshd(8)</a>: enlarge format buffer size for certificate serial
   number so the log message can record any 64-bit integer without
   truncation. <a href='https://bugzilla.mindrot.org/show_bug.cgi?id=3012'>bz#3012</a>

 * <a href='https://man.openbsd.org/sshd.8'>sshd(8)</a>: for PermitOpen violations add the remote host and port to
   be able to more easily ascertain the source of the request. Add the
   same logging for PermitListen violations which where not previously
   logged at all.

 * <a href='https://man.openbsd.org/scp.1'>scp(1)</a>, <a href='https://man.openbsd.org/sftp.1'>sftp(1)</a>: use the correct POSIX format style for left
   justification for the transfer progress meter. <a href='https://bugzilla.mindrot.org/show_bug.cgi?id=3002'>bz#3002</a>

 * <a href='https://man.openbsd.org/sshd.8'>sshd(8)</a> when examining a configuration using sshd -T, assume any
   attribute not provided by -C does not match, which allows it to work
   when sshd_config contains a Match directive with or without -C.
   <a href='https://bugzilla.mindrot.org/show_bug.cgi?id=2858'>bz#2858</a>

 * <a href='https://man.openbsd.org/ssh.1'>ssh(1)</a>, <a href='https://man.openbsd.org/ssh-keygen.1'>ssh-keygen(1)</a>: downgrade PKCS#11 "provider returned no
   slots" warning from log level error to debug. This is common when
   attempting to enumerate keys on smartcard readers with no cards
   plugged in. <a href='https://bugzilla.mindrot.org/show_bug.cgi?id=3058'>bz#3058</a>

 * <a href='https://man.openbsd.org/ssh.1'>ssh(1)</a>, <a href='https://man.openbsd.org/ssh-keygen.1'>ssh-keygen(1)</a>: do not unconditionally log in to PKCS#11
   tokens. Avoids spurious PIN prompts for keys not selected for
   authentication in <a href='https://man.openbsd.org/ssh.1'>ssh(1)</a> and when listing public keys available in
   a token using <a href='https://man.openbsd.org/ssh-keygen.1'>ssh-keygen(1)</a>. <a href='https://bugzilla.mindrot.org/show_bug.cgi?id=3006'>bz#3006</a>

Portability
-----------

 * <a href='https://man.openbsd.org/ssh.1'>ssh(1)</a>: fix SIGWINCH delivery of Solaris for multiplexed sessions
   <a href='https://bugzilla.mindrot.org/show_bug.cgi?id=3030'>bz#3030</a>

 * <a href='https://man.openbsd.org/ssh.1'>ssh(1)</a>, <a href='https://man.openbsd.org/sshd.8'>sshd(8)</a>: fix typo that prevented detection of Linux VRF

 * <a href='https://man.openbsd.org/sshd.8'>sshd(8)</a>: add no-op implementation of pam_putenv to avoid build
   breakage on platforms where the PAM implementation lacks this
   function (e.g. HP-UX). <a href='https://bugzilla.mindrot.org/show_bug.cgi?id=3008'>bz#3008</a>

 * <a href='https://man.openbsd.org/sftp-server.8'>sftp-server(8)</a>: fix Solaris privilege sandbox from preventing
   the legacy sftp rename operation from working (was refusing to
   allow hard links to files owned by other users). <a href='https://bugzilla.mindrot.org/show_bug.cgi?id=3036'>bz#3036</a>

 * All: add a proc_pidinfo()-based closefrom() for OS X to avoid
   the need to brute-force close all high-numbered file descriptors.
   <a href='https://bugzilla.mindrot.org/show_bug.cgi?id=3049'>bz#3049</a>

 * <a href='https://man.openbsd.org/sshd.8'>sshd(8)</a>: in the Linux seccomp-bpf sandbox, allow mprotect(2) with
   PROT_(READ|WRITE|NONE) only. This syscall is used by some hardened
   heap allocators. Github PR#142

 * <a href='https://man.openbsd.org/sshd.8'>sshd(8)</a>: in the Linux seccomp-bpf sandbox, allow the s390-specific
   ioctl for ECC hardware support.

 * All: use "doc" man page format if the mandoc(1) tool is present on
   the system. Previously configure would not select the "doc" man
   page format if mandoc was present but nroff was not.

 * <a href='https://man.openbsd.org/sshd.8'>sshd(8)</a>: don't install duplicate STREAMS modules on Solaris; check
   if STREAMS modules are already installed on a pty before installing
   since when compiling with XPG&gt;=4 they will likely be installed
   already. Prevents hangs and duplicate lines on the terminal.
   <a href='https://bugzilla.mindrot.org/show_bug.cgi?id=2945'>bz#2945</a> and <a href='https://bugzilla.mindrot.org/show_bug.cgi?id=2998'>bz#2998</a>,

Checksums:
==========

 - SHA1 (<a href='https://cdn.openbsd.org/pub/OpenBSD/OpenSSH/openssh-8.1.tar.gz'>openssh-8.1.tar.gz</a>) = bf7b0c65a7c0afa5ba9c787f345b8a24fa459add
 - SHA256 (<a href='https://cdn.openbsd.org/pub/OpenBSD/OpenSSH/openssh-8.1.tar.gz'>openssh-8.1.tar.gz</a>) = vamkKxZTFfgxQXSxGeJ1vbuot0H3Vx9bNBgrvChSrFg=

 - SHA1 (<a href='https://cdn.openbsd.org/pub/OpenBSD/OpenSSH/portable/openssh-8.1p1.tar.gz'>openssh-8.1p1.tar.gz</a>) = c44b96094869f177735ae053d92bd5fcab1319de
 - SHA256 (<a href='https://cdn.openbsd.org/pub/OpenBSD/OpenSSH/portable/openssh-8.1p1.tar.gz'>openssh-8.1p1.tar.gz</a>) = AvXb7zg10HU1VvlzzVe0wZtrH2zSTANEXiOsd8obk/8=

Please note that the SHA256 signatures are base64 encoded and not
hexadecimal (which is the default for most checksum tools). The PGP
key used to sign the releases is available as RELEASE_KEY.asc from
the mirror sites.

Reporting Bugs:
===============

- Please read <a href='http://www.openssh.com/report.html'>http://www.openssh.com/report.html</a>
  Security bugs should be reported directly to openssh@openssh.com

</pre><hr>
<h3><a href='txt/release-8.0' id='8.0'>OpenSSH 8.0</a>/<a href='txt/release-8.0' id='8.0p1'>8.0p1</a> (2019-04-17)</h3>
<pre>
OpenSSH 8.0 was released on 2019-04-17. It is available from the
mirrors listed at <a href='https://www.openssh.com/'>https://www.openssh.com/</a>.
OpenSSH is a 100% complete SSH protocol 2.0 implementation and
includes sftp client and server support.

Once again, we would like to thank the OpenSSH community for their
continued support of the project, especially those who contributed
code or patches, reported bugs, tested snapshots or donated to the
project. More information on donations may be found at:
<a href='http://www.openssh.com/donations.html'>http://www.openssh.com/donations.html</a>

Security
========

This release contains mitigation for a weakness in the <a href='https://man.openbsd.org/scp.1'>scp(1)</a> tool
and protocol (CVE-2019-6111): when copying files from a remote system
to a local directory, <a href='https://man.openbsd.org/scp.1'>scp(1)</a> did not verify that the filenames that
the server sent matched those requested by the client. This could
allow a hostile server to create or clobber unexpected local files
with attacker-controlled content.

This release adds client-side checking that the filenames sent from
the server match the command-line request,

The scp protocol is outdated, inflexible and not readily fixed. We
recommend the use of more modern protocols like sftp and rsync for
file transfer instead.

Potentially-incompatible changes
================================

This release includes a number of changes that may affect existing
configurations:

 * <a href='https://man.openbsd.org/scp.1'>scp(1)</a>: Relating to the above changes to <a href='https://man.openbsd.org/scp.1'>scp(1)</a>; the scp protocol
   relies on the remote shell for wildcard expansion, so there is no
   infallible way for the client's wildcard matching to perfectly
   reflect the server's. If there is a difference between client and
   server wildcard expansion, the client may refuse files from the
   server. For this reason, we have provided a new "-T" flag to scp
   that disables these client-side checks at the risk of
   reintroducing the attack described above.

 * <a href='https://man.openbsd.org/sshd.8'>sshd(8)</a>: Remove support for obsolete "host/port" syntax. Slash-
   separated host/port was added in 2001 as an alternative to
   host:port syntax for the benefit of IPv6 users. These days there
   are establised standards for this like [::1]:22 and the slash
   syntax is easily mistaken for CIDR notation, which OpenSSH
   supports for some things. Remove the slash notation from
   ListenAddress and PermitOpen; <a href='https://bugzilla.mindrot.org/show_bug.cgi?id=2335'>bz#2335</a>

Changes since OpenSSH 7.9
=========================

This release is focused on new features and internal refactoring.

New Features
------------

 * <a href='https://man.openbsd.org/ssh.1'>ssh(1)</a>, <a href='https://man.openbsd.org/ssh-agent.1'>ssh-agent(1)</a>, <a href='https://man.openbsd.org/ssh-add.1'>ssh-add(1)</a>: Add support for ECDSA keys in
   PKCS#11 tokens.

 * <a href='https://man.openbsd.org/ssh.1'>ssh(1)</a>, <a href='https://man.openbsd.org/sshd.8'>sshd(8)</a>: Add experimental quantum-computing resistant
   key exchange method, based on a combination of Streamlined NTRU
   Prime 4591^761 and X25519.

 * <a href='https://man.openbsd.org/ssh-keygen.1'>ssh-keygen(1)</a>: Increase the default RSA key size to 3072 bits,
   following NIST Special Publication 800-57's guidance for a
   128-bit equivalent symmetric security level.

 * <a href='https://man.openbsd.org/ssh.1'>ssh(1)</a>: Allow "PKCS11Provider=none" to override later instances of
   the PKCS11Provider directive in ssh_config; <a href='https://bugzilla.mindrot.org/show_bug.cgi?id=2974'>bz#2974</a>

 * <a href='https://man.openbsd.org/sshd.8'>sshd(8)</a>: Add a log message for situations where a connection is
   dropped for attempting to run a command but a sshd_config
   ForceCommand=internal-sftp restriction is in effect; <a href='https://bugzilla.mindrot.org/show_bug.cgi?id=2960'>bz#2960</a>

 * <a href='https://man.openbsd.org/ssh.1'>ssh(1)</a>: When prompting whether to record a new host key, accept
   the key fingerprint as a synonym for "yes". This allows the user
   to paste a fingerprint obtained out of band at the prompt and
   have the client do the comparison for you.

 * <a href='https://man.openbsd.org/ssh-keygen.1'>ssh-keygen(1)</a>: When signing multiple certificates on a single
   command-line invocation, allow automatically incrementing the
   certificate serial number.

 * <a href='https://man.openbsd.org/scp.1'>scp(1)</a>, <a href='https://man.openbsd.org/sftp.1'>sftp(1)</a>: Accept -J option as an alias to ProxyJump on
   the scp and sftp command-lines.

 * <a href='https://man.openbsd.org/ssh-agent.1'>ssh-agent(1)</a>, ssh-pkcs11-helper(8), <a href='https://man.openbsd.org/ssh-add.1'>ssh-add(1)</a>: Accept "-v"
   command-line flags to increase the verbosity of output; pass
   verbose flags though to subprocesses, such as ssh-pkcs11-helper
   started from ssh-agent.

 * <a href='https://man.openbsd.org/ssh-add.1'>ssh-add(1)</a>: Add a "-T" option to allowing testing whether keys in
   an agent are usable by performing a signature and a verification.

 * <a href='https://man.openbsd.org/sftp-server.8'>sftp-server(8)</a>: Add a "lsetstat@openssh.com" protocol extension
   that replicates the functionality of the existing SSH2_FXP_SETSTAT
   operation but does not follow symlinks. <a href='https://bugzilla.mindrot.org/show_bug.cgi?id=2067'>bz#2067</a>

 * <a href='https://man.openbsd.org/sftp.1'>sftp(1)</a>: Add "-h" flag to chown/chgrp/chmod commands to request
   they do not follow symlinks.

 * <a href='https://man.openbsd.org/sshd.8'>sshd(8)</a>: Expose $SSH_CONNECTION in the PAM environment. This makes
   the connection 4-tuple available to PAM modules that wish to use
   it in decision-making. <a href='https://bugzilla.mindrot.org/show_bug.cgi?id=2741'>bz#2741</a>

 * <a href='https://man.openbsd.org/sshd.8'>sshd(8)</a>: Add a ssh_config "Match final" predicate Matches in same
   pass as "Match canonical" but doesn't require hostname
   canonicalisation be enabled. <a href='https://bugzilla.mindrot.org/show_bug.cgi?id=2906'>bz#2906</a>

 * <a href='https://man.openbsd.org/sftp.1'>sftp(1)</a>: Support a prefix of '@' to suppress echo of sftp batch
   commands; <a href='https://bugzilla.mindrot.org/show_bug.cgi?id=2926'>bz#2926</a>

 * <a href='https://man.openbsd.org/ssh-keygen.1'>ssh-keygen(1)</a>: When printing certificate contents using
   "ssh-keygen -Lf /path/certificate", include the algorithm that
   the CA used to sign the cert.

Bugfixes
--------

 * <a href='https://man.openbsd.org/sshd.8'>sshd(8)</a>: Fix authentication failures when sshd_config contains
   "AuthenticationMethods any" inside a Match block that overrides
   a more restrictive default.

 * <a href='https://man.openbsd.org/sshd.8'>sshd(8)</a>: Avoid sending duplicate keepalives when ClientAliveCount
   is enabled.

 * <a href='https://man.openbsd.org/sshd.8'>sshd(8)</a>: Fix two race conditions related to SIGHUP daemon restart.
   Remnant file descriptors in recently-forked child processes could
   block the parent sshd's attempt to listen(2) to the configured
   addresses. Also, the restarting parent sshd could exit before any
   child processes that were awaiting their re-execution state had
   completed reading it, leaving them in a fallback path.

 * <a href='https://man.openbsd.org/ssh.1'>ssh(1)</a>: Fix stdout potentially being redirected to /dev/null when
   ProxyCommand=- was in use.

 * <a href='https://man.openbsd.org/sshd.8'>sshd(8)</a>: Avoid sending SIGPIPE to child processes if they attempt
   to write to stderr after their parent processes have exited;
   <a href='https://bugzilla.mindrot.org/show_bug.cgi?id=2071'>bz#2071</a>

 * <a href='https://man.openbsd.org/ssh.1'>ssh(1)</a>: Fix bad interaction between the ssh_config ConnectTimeout
   and ConnectionAttempts directives - connection attempts after the
   first were ignoring the requested timeout; <a href='https://bugzilla.mindrot.org/show_bug.cgi?id=2918'>bz#2918</a>

 * ssh-keyscan(1): Return a non-zero exit status if no keys were
   found; <a href='https://bugzilla.mindrot.org/show_bug.cgi?id=2903'>bz#2903</a>

 * <a href='https://man.openbsd.org/scp.1'>scp(1)</a>: Sanitize scp filenames to allow UTF-8 characters without
   terminal control sequences;  <a href='https://bugzilla.mindrot.org/show_bug.cgi?id=2434'>bz#2434</a>

 * <a href='https://man.openbsd.org/sshd.8'>sshd(8)</a>: Fix confusion between ClientAliveInterval and time-based
   RekeyLimit that could cause connections to be incorrectly closed.
   <a href='https://bugzilla.mindrot.org/show_bug.cgi?id=2757'>bz#2757</a>

 * <a href='https://man.openbsd.org/ssh.1'>ssh(1)</a>, <a href='https://man.openbsd.org/ssh-add.1'>ssh-add(1)</a>: Correct some bugs in PKCS#11 token PIN
   handling at initial token login. The attempt to read the PIN
   could be skipped in some cases, particularly on devices with
   integrated PIN readers. This would lead to an inability to
   retrieve keys from these tokens. <a href='https://bugzilla.mindrot.org/show_bug.cgi?id=2652'>bz#2652</a>

 * <a href='https://man.openbsd.org/ssh.1'>ssh(1)</a>, <a href='https://man.openbsd.org/ssh-add.1'>ssh-add(1)</a>: Support keys on PKCS#11 tokens that set the
   CKA_ALWAYS_AUTHENTICATE flag by requring a fresh login after the
   C_SignInit operation. <a href='https://bugzilla.mindrot.org/show_bug.cgi?id=2638'>bz#2638</a>

 * <a href='https://man.openbsd.org/ssh.1'>ssh(1)</a>: Improve documentation for ProxyJump/-J, clarifying that
   local configuration does not apply to jump hosts.

 * <a href='https://man.openbsd.org/ssh-keygen.1'>ssh-keygen(1)</a>: Clarify manual - ssh-keygen -e only writes
   public keys, not private.

 * <a href='https://man.openbsd.org/ssh.1'>ssh(1)</a>, <a href='https://man.openbsd.org/sshd.8'>sshd(8)</a>: be more strict in processing protocol banners,
   allowing \r characters only immediately before \n.

 * Various: fix a number of memory leaks, including <a href='https://bugzilla.mindrot.org/show_bug.cgi?id=2942'>bz#2942</a> and
   <a href='https://bugzilla.mindrot.org/show_bug.cgi?id=2938'>bz#2938</a>

 * <a href='https://man.openbsd.org/scp.1'>scp(1)</a>, <a href='https://man.openbsd.org/sftp.1'>sftp(1)</a>: fix calculation of initial bandwidth limits.
   Account for bytes written before the timer starts and adjust the
   schedule on which recalculations are performed. Avoids an initial
   burst of traffic and yields more accurate bandwidth limits;
   <a href='https://bugzilla.mindrot.org/show_bug.cgi?id=2927'>bz#2927</a>

 * <a href='https://man.openbsd.org/sshd.8'>sshd(8)</a>: Only consider the ext-info-c extension during the initial
   key eschange. It shouldn't be sent in subsequent ones, but if it
   is present we should ignore it. This prevents sshd from sending a
   SSH_MSG_EXT_INFO for REKEX for buggy these clients. <a href='https://bugzilla.mindrot.org/show_bug.cgi?id=2929'>bz#2929</a>

 * <a href='https://man.openbsd.org/ssh-keygen.1'>ssh-keygen(1)</a>: Clarify manual that ssh-keygen -F (find host in 
   authorized_keys) and -R (remove host from authorized_keys) options
   may accept either a bare hostname or a [hostname]:port combo.
   <a href='https://bugzilla.mindrot.org/show_bug.cgi?id=2935'>bz#2935</a>

 * <a href='https://man.openbsd.org/ssh.1'>ssh(1)</a>: Don't attempt to connect to empty SSH_AUTH_SOCK; <a href='https://bugzilla.mindrot.org/show_bug.cgi?id=2936'>bz#2936</a>

 * <a href='https://man.openbsd.org/sshd.8'>sshd(8)</a>: Silence error messages when sshd fails to load some of
   the default host keys. Failure to load an explicitly-configured
   hostkey is still an error, and failure to load any host key is
   still fatal. pr/103

 * <a href='https://man.openbsd.org/ssh.1'>ssh(1)</a>: Redirect stderr of ProxyCommands to /dev/null when ssh is
   started with ControlPersist; prevents random ProxyCommand output
   from interfering with session output.

 * <a href='https://man.openbsd.org/ssh.1'>ssh(1)</a>: The ssh client was keeping a redundant ssh-agent socket
   (leftover from authentication) around for the life of the
   connection; <a href='https://bugzilla.mindrot.org/show_bug.cgi?id=2912'>bz#2912</a>

 * <a href='https://man.openbsd.org/sshd.8'>sshd(8)</a>: Fix bug in HostbasedAcceptedKeyTypes and
   PubkeyAcceptedKeyTypes options. If only RSA-SHA2 siganture types
   were specified, then authentication would always fail for RSA keys
   as the monitor checks only the base key (not the signature
   algorithm) type against *AcceptedKeyTypes. <a href='https://bugzilla.mindrot.org/show_bug.cgi?id=2746'>bz#2746</a>

 * <a href='https://man.openbsd.org/ssh.1'>ssh(1)</a>: Request correct signature types from ssh-agent when
   certificate keys and RSA-SHA2 signatures are in use.

Portability
-----------

 * <a href='https://man.openbsd.org/sshd.8'>sshd(8)</a>: On Cygwin, run as SYSTEM where possible, using S4U for
   token creation if it supports MsV1_0 S4U Logon.

 * <a href='https://man.openbsd.org/sshd.8'>sshd(8)</a>: On Cygwin, use custom user/group matching code that
   respects the OS' behaviour of case-insensitive matching.

 * <a href='https://man.openbsd.org/sshd.8'>sshd(8)</a>: Don't set $MAIL if UsePAM=yes as PAM typically specifies
   the user environment if it's enabled; <a href='https://bugzilla.mindrot.org/show_bug.cgi?id=2937'>bz#2937</a>

 * <a href='https://man.openbsd.org/sshd.8'>sshd(8)</a> Cygwin: Change service name to cygsshd to avoid collision
   with Microsoft's OpenSSH port.

 * Allow building against OpenSSL -dev (3.x)

 * Fix a number of build problems against version configurations and
   versions of OpenSSL. Including <a href='https://bugzilla.mindrot.org/show_bug.cgi?id=2931'>bz#2931</a> and <a href='https://bugzilla.mindrot.org/show_bug.cgi?id=2921'>bz#2921</a>

 * Improve warnings in cygwin service setup. <a href='https://bugzilla.mindrot.org/show_bug.cgi?id=2922'>bz#2922</a>

 * Remove hardcoded service name in cygwin setup. <a href='https://bugzilla.mindrot.org/show_bug.cgi?id=2922'>bz#2922</a>

Checksums:
==========

 - SHA1 (<a href='https://cdn.openbsd.org/pub/OpenBSD/OpenSSH/openssh-8.0.tar.gz'>openssh-8.0.tar.gz</a>) = 8aaa99091fc7e5a92a4a320e1e5521046b3f95f0
 - SHA256 (<a href='https://cdn.openbsd.org/pub/OpenBSD/OpenSSH/openssh-8.0.tar.gz'>openssh-8.0.tar.gz</a>) = 1xvSJk1KYSnOLPYEUzyCVwTEQ7MHOaCO65DzeNuuLdo=

 - SHA1 (<a href='https://cdn.openbsd.org/pub/OpenBSD/OpenSSH/portable/openssh-8.0p1.tar.gz'>openssh-8.0p1.tar.gz</a>) = 756dbb99193f9541c9206a667eaa27b0fa184a4f
 - SHA256 (<a href='https://cdn.openbsd.org/pub/OpenBSD/OpenSSH/portable/openssh-8.0p1.tar.gz'>openssh-8.0p1.tar.gz</a>) = vZQ4eeaUmOgDHra39E0IzcN9WaeraJqgtDcyDDSB/Wg=

Please note that the SHA256 signatures are base64 encoded and not
hexadecimal (which is the default for most checksum tools). The PGP
key used to sign the releases is available as RELEASE_KEY.asc from
the mirror sites.

Reporting Bugs:
===============

- Please read <a href='http://www.openssh.com/report.html'>http://www.openssh.com/report.html</a>
  Security bugs should be reported directly to openssh@openssh.com
</pre><hr>
<h3><a href='txt/release-7.9' id='7.9'>OpenSSH 7.9</a>/<a href='txt/release-7.9' id='7.9p1'>7.9p1</a> (2018-10-19)</h3>
<pre>
OpenSSH 7.9 was released on 2018-10-19. It is available from the
mirrors listed at <a href='https://www.openssh.com/'>https://www.openssh.com/</a>.
OpenSSH is a 100% complete SSH protocol 2.0 implementation and
includes sftp client and server support.

Once again, we would like to thank the OpenSSH community for their
continued support of the project, especially those who contributed
code or patches, reported bugs, tested snapshots or donated to the
project. More information on donations may be found at:
<a href='http://www.openssh.com/donations.html'>http://www.openssh.com/donations.html</a>

Potentially-incompatible changes
================================

This release includes a number of changes that may affect existing
configurations:

 * <a href='https://man.openbsd.org/ssh.1'>ssh(1)</a>, <a href='https://man.openbsd.org/sshd.8'>sshd(8)</a>: the setting of the new CASignatureAlgorithms
   option (see below) bans the use of DSA keys as certificate
   authorities.

 * <a href='https://man.openbsd.org/sshd.8'>sshd(8)</a>: the authentication success/failure log message has
   changed format slightly. It now includes the certificate
   fingerprint (previously it included only key ID and CA key
   fingerprint).

Changes since OpenSSH 7.8
=========================

This is primarily a bugfix release.

New Features
------------

 * <a href='https://man.openbsd.org/ssh.1'>ssh(1)</a>, <a href='https://man.openbsd.org/sshd.8'>sshd(8)</a>: allow most port numbers to be specified using
   service names from getservbyname(3) (typically /etc/services).

 * <a href='https://man.openbsd.org/ssh.1'>ssh(1)</a>: allow the IdentityAgent configuration directive to accept
   environment variable names. This supports the use of multiple
   agent sockets without needing to use fixed paths.

 * <a href='https://man.openbsd.org/sshd.8'>sshd(8)</a>: support signalling sessions via the SSH protocol.
   A limited subset of signals is supported and only for login or
   command sessions (i.e. not subsystems) that were not subject to
   a forced command via authorized_keys or sshd_config. <a href='https://bugzilla.mindrot.org/show_bug.cgi?id=1424'>bz#1424</a>

 * <a href='https://man.openbsd.org/ssh.1'>ssh(1)</a>: support "ssh -Q sig" to list supported signature options.
   Also "ssh -Q help" to show the full set of supported queries.

 * <a href='https://man.openbsd.org/ssh.1'>ssh(1)</a>, <a href='https://man.openbsd.org/sshd.8'>sshd(8)</a>: add a CASignatureAlgorithms option for the
   client and server configs to allow control over which signature
   formats are allowed for CAs to sign certificates. For example,
   this allows banning CAs that sign certificates using the RSA-SHA1
   signature algorithm.

 * <a href='https://man.openbsd.org/sshd.8'>sshd(8)</a>, <a href='https://man.openbsd.org/ssh-keygen.1'>ssh-keygen(1)</a>: allow key revocation lists (KRLs) to
   revoke keys specified by SHA256 hash.

 * <a href='https://man.openbsd.org/ssh-keygen.1'>ssh-keygen(1)</a>: allow creation of key revocation lists directly
   from base64-encoded SHA256 fingerprints. This supports revoking
   keys using only the information contained in <a href='https://man.openbsd.org/sshd.8'>sshd(8)</a>
   authentication log messages.

Bugfixes
--------

 * <a href='https://man.openbsd.org/ssh.1'>ssh(1)</a>, <a href='https://man.openbsd.org/ssh-keygen.1'>ssh-keygen(1)</a>: avoid spurious "invalid format" errors when
   attempting to load PEM private keys while using an incorrect
   passphrase. <a href='https://bugzilla.mindrot.org/show_bug.cgi?id=2901'>bz#2901</a>

 * <a href='https://man.openbsd.org/sshd.8'>sshd(8)</a>: when a channel closed message is received from a client,
   close the stderr file descriptor at the same time stdout is
   closed. This avoids stuck processes if they were waiting for
   stderr to close and were insensitive to stdin/out closing. <a href='https://bugzilla.mindrot.org/show_bug.cgi?id=2863'>bz#2863</a>

 * <a href='https://man.openbsd.org/ssh.1'>ssh(1)</a>: allow ForwardX11Timeout=0 to disable the untrusted X11
   forwarding timeout and support X11 forwarding indefinitely.
   Previously the behaviour of ForwardX11Timeout=0 was undefined.

 * <a href='https://man.openbsd.org/sshd.8'>sshd(8)</a>: when compiled with GSSAPI support, cache supported method
   OIDs regardless of whether GSSAPI authentication is enabled in the
   main section of sshd_config. This avoids sandbox violations if
   GSSAPI authentication was later enabled in a Match block. <a href='https://bugzilla.mindrot.org/show_bug.cgi?id=2107'>bz#2107</a>

 * <a href='https://man.openbsd.org/sshd.8'>sshd(8)</a>: do not fail closed when configured with a text key
   revocation list that contains a too-short key. <a href='https://bugzilla.mindrot.org/show_bug.cgi?id=2897'>bz#2897</a>

 * <a href='https://man.openbsd.org/ssh.1'>ssh(1)</a>: treat connections with ProxyJump specified the same as
   ones with a ProxyCommand set with regards to hostname
   canonicalisation (i.e. don't try to canonicalise the hostname
   unless CanonicalizeHostname is set to 'always'). <a href='https://bugzilla.mindrot.org/show_bug.cgi?id=2896'>bz#2896</a>

 * <a href='https://man.openbsd.org/ssh.1'>ssh(1)</a>: fix regression in OpenSSH 7.8 that could prevent public-
   key authentication using certificates hosted in a <a href='https://man.openbsd.org/ssh-agent.1'>ssh-agent(1)</a>
   or against <a href='https://man.openbsd.org/sshd.8'>sshd(8)</a> from OpenSSH &lt;7.8.

Portability
-----------

 * All: support building against the openssl-1.1 API (releases 1.1.0g
   and later). The openssl-1.0 API will remain supported at least
   until OpenSSL terminates security patch support for that API version.

 * <a href='https://man.openbsd.org/sshd.8'>sshd(8)</a>: allow the futex(2) syscall in the Linux seccomp sandbox;
   apparently required by some glibc/OpenSSL combinations.

 * <a href='https://man.openbsd.org/sshd.8'>sshd(8)</a>: handle getgrouplist(3) returning more than
   _SC_NGROUPS_MAX groups. Some platforms consider this limit more
   as a guideline.

Checksums:
==========

 - SHA1 (<a href='https://cdn.openbsd.org/pub/OpenBSD/OpenSSH/openssh-7.9.tar.gz'>openssh-7.9.tar.gz</a>) = 7c50a86b8f591decd172ed7f5527abc533098dec
 - SHA256 (<a href='https://cdn.openbsd.org/pub/OpenBSD/OpenSSH/openssh-7.9.tar.gz'>openssh-7.9.tar.gz</a>) = nSVigtHGn3+xKXRqpSnp4YOyEPPAb+pCHdWS9Eh/IPY=

 - SHA1 (<a href='https://cdn.openbsd.org/pub/OpenBSD/OpenSSH/portable/openssh-7.9p1.tar.gz'>openssh-7.9p1.tar.gz</a>) = 993aceedea8ecabb1d0dd7293508a361891c4eaa
 - SHA256 (<a href='https://cdn.openbsd.org/pub/OpenBSD/OpenSSH/portable/openssh-7.9p1.tar.gz'>openssh-7.9p1.tar.gz</a>) = a0s7oiU9hO03ccgFByjVl8kc/OiYcTvre2SjBbbxGq0=

Please note that the SHA256 signatures are base64 encoded and not
hexadecimal (which is the default for most checksum tools). The PGP
key used to sign the releases is available as RELEASE_KEY.asc from
the mirror sites.

Reporting Bugs:
===============

- Please read <a href='http://www.openssh.com/report.html'>http://www.openssh.com/report.html</a>
  Security bugs should be reported directly to openssh@openssh.com
</pre><hr>
<h3><a href='txt/release-7.8' id='7.8'>OpenSSH 7.8</a>/<a href='txt/release-7.8' id='7.8p1'>7.8p1</a> (2018-08-24)</h3>
<pre>
OpenSSH 7.8 was released on 2018-08-24. It is available from the
mirrors listed at <a href='https://www.openssh.com/'>https://www.openssh.com/</a>.
OpenSSH is a 100% complete SSH protocol 2.0 implementation and
includes sftp client and server support.

Once again, we would like to thank the OpenSSH community for their
continued support of the project, especially those who contributed
code or patches, reported bugs, tested snapshots or donated to the
project. More information on donations may be found at:
<a href='http://www.openssh.com/donations.html'>http://www.openssh.com/donations.html</a>

Potentially-incompatible changes
================================

This release includes a number of changes that may affect existing
configurations:

 * <a href='https://man.openbsd.org/ssh-keygen.1'>ssh-keygen(1)</a>: write OpenSSH format private keys by default
   instead of using OpenSSL's PEM format. The OpenSSH format,
   supported in OpenSSH releases since 2014 and described in the
   PROTOCOL.key file in the source distribution, offers substantially
   better protection against offline password guessing and supports
   key comments in private keys. If necessary, it is possible to write
   old PEM-style keys by adding "-m PEM" to ssh-keygen's arguments
   when generating or updating a key.

 * <a href='https://man.openbsd.org/sshd.8'>sshd(8)</a>: remove internal support for S/Key multiple factor
   authentication. S/Key may still be used via PAM or BSD auth.

 * <a href='https://man.openbsd.org/ssh.1'>ssh(1)</a>: remove vestigal support for running <a href='https://man.openbsd.org/ssh.1'>ssh(1)</a> as setuid. This
   used to be required for hostbased authentication and the (long
   gone) rhosts-style authentication, but has not been necessary for
   a long time. Attempting to execute ssh as a setuid binary, or with
   uid != effective uid will now yield a fatal error at runtime.

 * <a href='https://man.openbsd.org/sshd.8'>sshd(8)</a>: the semantics of PubkeyAcceptedKeyTypes and the similar
   HostbasedAcceptedKeyTypes options have changed. These now specify
   signature algorithms that are accepted for their respective
   authentication mechanism, where previously they specified accepted
   key types. This distinction matters when using the RSA/SHA2
   signature algorithms "rsa-sha2-256", "rsa-sha2-512" and their
   certificate counterparts. Configurations that override these
   options but omit these algorithm names may cause unexpected
   authentication failures (no action is required for configurations
   that accept the default for these options).

 * <a href='https://man.openbsd.org/sshd.8'>sshd(8)</a>: the precedence of session environment variables has
   changed. ~/.ssh/environment and environment="..." options in
   authorized_keys files can no longer override SSH_* variables set
   implicitly by sshd.

 * <a href='https://man.openbsd.org/ssh.1'>ssh(1)</a>/<a href='https://man.openbsd.org/sshd.8'>sshd(8)</a>: the default IPQoS used by ssh/sshd has changed.
   They will now use DSCP AF21 for interactive traffic and CS1 for
   bulk.  For a detailed rationale, please see the commit message:
   <a href='https://cvsweb.openbsd.org/src/usr.bin/ssh/readconf.c#rev1.284'>https://cvsweb.openbsd.org/src/usr.bin/ssh/readconf.c#rev1.284</a>

Changes since OpenSSH 7.7
=========================

This is primarily a bugfix release.

New Features
------------

 * <a href='https://man.openbsd.org/ssh.1'>ssh(1)</a>/<a href='https://man.openbsd.org/sshd.8'>sshd(8)</a>: add new signature algorithms "rsa-sha2-256-cert-
   v01@openssh.com" and "rsa-sha2-512-cert-v01@openssh.com" to
   explicitly force use of RSA/SHA2 signatures in authentication.

 * <a href='https://man.openbsd.org/sshd.8'>sshd(8)</a>: extend the PermitUserEnvironment option to accept a
   whitelist of environment variable names in addition to global
   "yes" or "no" settings.

 * <a href='https://man.openbsd.org/sshd.8'>sshd(8)</a>: add a PermitListen directive to <a href='https://man.openbsd.org/sshd_config.5'>sshd_config(5)</a> and a 
   corresponding permitlisten= authorized_keys option that control
   which listen addresses and port numbers may be used by remote
   forwarding (ssh -R ...).

 * <a href='https://man.openbsd.org/sshd.8'>sshd(8)</a>: add some countermeasures against timing attacks used for
   account validation/enumeration. sshd will enforce a minimum time
   or each failed authentication attempt consisting of a global 5ms
   minimum plus an additional per-user 0-4ms delay derived from a
   host secret.

 * <a href='https://man.openbsd.org/sshd.8'>sshd(8)</a>: add a SetEnv directive to allow an administrator to
   explicitly specify environment variables in sshd_config.
   Variables set by SetEnv override the default and client-specified
   environment.

 * <a href='https://man.openbsd.org/ssh.1'>ssh(1)</a>: add a SetEnv directive to request that the server sets
   an environment variable in the session. Similar to the existing
   SendEnv option, these variables are set subject to server
   configuration.

 * <a href='https://man.openbsd.org/ssh.1'>ssh(1)</a>: allow "SendEnv -PATTERN" to clear environment variables
   previously marked for sending to the server. <a href='https://bugzilla.mindrot.org/show_bug.cgi?id=1285'>bz#1285</a>

 * <a href='https://man.openbsd.org/ssh.1'>ssh(1)</a>/<a href='https://man.openbsd.org/sshd.8'>sshd(8)</a>: make UID available as a %-expansion everywhere
   that the username is available currently. <a href='https://bugzilla.mindrot.org/show_bug.cgi?id=2870'>bz#2870</a>

 * <a href='https://man.openbsd.org/ssh.1'>ssh(1)</a>: allow setting ProxyJump=none to disable ProxyJump
   functionality. <a href='https://bugzilla.mindrot.org/show_bug.cgi?id=2869'>bz#2869</a>

Bugfixes
--------

 * <a href='https://man.openbsd.org/sshd.8'>sshd(8)</a>: avoid observable differences in request parsing that could
   be used to determine whether a target user is valid.

 * all: substantial internal refactoring

 * <a href='https://man.openbsd.org/ssh.1'>ssh(1)</a>/<a href='https://man.openbsd.org/sshd.8'>sshd(8)</a>: fix some memory leaks; <a href='https://bugzilla.mindrot.org/show_bug.cgi?id=2366'>bz#2366</a>

 * <a href='https://man.openbsd.org/ssh.1'>ssh(1)</a>: fix a pwent clobber (introduced in openssh-7.7) that could
   occur during key loading, manifesting as crash on some platforms.

 * <a href='https://man.openbsd.org/sshd_config.5'>sshd_config(5)</a>: clarify documentation for AuthenticationMethods
   option; <a href='https://bugzilla.mindrot.org/show_bug.cgi?id=2663'>bz#2663</a>

 * <a href='https://man.openbsd.org/ssh.1'>ssh(1)</a>: ensure that the public key algorithm sent in a
   public key SSH_MSG_USERAUTH_REQUEST matches the content of the
   signature blob. Previously, these could be inconsistent when a
   legacy or non-OpenSSH ssh-agent returned a RSA/SHA1 signature
   when asked to make a RSA/SHA2 signature.

 * <a href='https://man.openbsd.org/sshd.8'>sshd(8)</a>: fix failures to read authorized_keys caused by faulty
   supplemental group caching. <a href='https://bugzilla.mindrot.org/show_bug.cgi?id=2873'>bz#2873</a>

 * <a href='https://man.openbsd.org/scp.1'>scp(1)</a>: apply umask to directories, fixing potential mkdir/chmod
   race when copying directory trees <a href='https://bugzilla.mindrot.org/show_bug.cgi?id=2839'>bz#2839</a>

 * <a href='https://man.openbsd.org/ssh-keygen.1'>ssh-keygen(1)</a>: return correct exit code when searching for and
   hashing known_hosts entries in a single operation; <a href='https://bugzilla.mindrot.org/show_bug.cgi?id=2772'>bz#2772</a>

 * <a href='https://man.openbsd.org/ssh.1'>ssh(1)</a>: prefer the ssh binary pointed to via argv[0] to $PATH when
   re-executing ssh for ProxyJump. <a href='https://bugzilla.mindrot.org/show_bug.cgi?id=2831'>bz#2831</a>

 * <a href='https://man.openbsd.org/sshd.8'>sshd(8)</a>: do not ban PTY allocation when a sshd session is
   restricted because the user password is expired as it breaks
   password change dialog. (regression in openssh-7.7).

 * <a href='https://man.openbsd.org/ssh.1'>ssh(1)</a>/<a href='https://man.openbsd.org/sshd.8'>sshd(8)</a>: fix error reporting from select() failures. 

 * <a href='https://man.openbsd.org/ssh.1'>ssh(1)</a>: improve documentation for -w (tunnel) flag, emphasising
   that -w implicitly sets Tunnel=point-to-point. <a href='https://bugzilla.mindrot.org/show_bug.cgi?id=2365'>bz#2365</a>

 * <a href='https://man.openbsd.org/ssh-agent.1'>ssh-agent(1)</a>: implement EMFILE mitigation for ssh-agent. ssh-agent
   will no longer spin when its file descriptor limit is exceeded.
   <a href='https://bugzilla.mindrot.org/show_bug.cgi?id=2576'>bz#2576</a>

 * <a href='https://man.openbsd.org/ssh.1'>ssh(1)</a>/<a href='https://man.openbsd.org/sshd.8'>sshd(8)</a>: disable SSH2_MSG_DEBUG messages for Twisted Conch
   clients. Twisted Conch versions that lack a version number in
   their identification strings will mishandle these messages when
   running on Python 2.x (<a href='https://twistedmatrix.com/trac/ticket/9422'>https://twistedmatrix.com/trac/ticket/9422</a>)
 * <a href='https://man.openbsd.org/sftp.1'>sftp(1)</a>: notify user immediately when underlying ssh process dies
   expectedly. <a href='https://bugzilla.mindrot.org/show_bug.cgi?id=2719'>bz#2719</a>

 * <a href='https://man.openbsd.org/ssh.1'>ssh(1)</a>/<a href='https://man.openbsd.org/sshd.8'>sshd(8)</a>: fix tunnel forwarding; regression in 7.7 release.
   <a href='https://bugzilla.mindrot.org/show_bug.cgi?id=2855'>bz#2855</a>

 * <a href='https://man.openbsd.org/ssh-agent.1'>ssh-agent(1)</a>: don't kill ssh-agent's listening socket entirely if
   it fails to accept(2) a connection. <a href='https://bugzilla.mindrot.org/show_bug.cgi?id=2837'>bz#2837</a>

 * <a href='https://man.openbsd.org/sshd.8'>sshd(8)</a>: relax checking of authorized_keys environment="..."
   options to allow underscores in variable names (regression
   introduced in 7.7). <a href='https://bugzilla.mindrot.org/show_bug.cgi?id=2851'>bz#2851</a>

 * <a href='https://man.openbsd.org/ssh.1'>ssh(1)</a>: add some missing options in the configuration dump output
   (ssh -G). <a href='https://bugzilla.mindrot.org/show_bug.cgi?id=2835'>bz#2835</a>

Portability
-----------

 * <a href='https://man.openbsd.org/sshd.8'>sshd(8)</a>: Expose details of completed authentication to PAM auth
   modules via SSH_AUTH_INFO_0 in the PAM environment. <a href='https://bugzilla.mindrot.org/show_bug.cgi?id=2408'>bz#2408</a>

 * Fix compilation problems caused by fights between zlib and OpenSSL
   colliding uses of "free_func"

 * Improve detection of unsupported compiler options. Recently these
   may have manifested as "unsupported -Wl,-z,retpoline" warnings
   during linking.

 * <a href='https://man.openbsd.org/sshd.8'>sshd(8)</a>: some sandbox support for Linux/s390 <a href='https://bugzilla.mindrot.org/show_bug.cgi?id=2752'>bz#2752</a>.

 * regress tests: unbreak key-options.sh test on platforms without
   openpty(3). <a href='https://bugzilla.mindrot.org/show_bug.cgi?id=2856'>bz#2856</a>

 * use getrandom(2) for PRNG seeding when built without OpenSSL.

Checksums:
==========

- SHA1 (<a href='https://cdn.openbsd.org/pub/OpenBSD/OpenSSH/openssh-7.8.tar.gz'>openssh-7.8.tar.gz</a>) = ed5511cd42b543cd15166a9cbc56705f23b847e7
- SHA256 (<a href='https://cdn.openbsd.org/pub/OpenBSD/OpenSSH/openssh-7.8.tar.gz'>openssh-7.8.tar.gz</a>) = TDqIsMEmghsBUNCrSCPyCxChfitntyOLXNC694py1XE

- SHA1 (<a href='https://cdn.openbsd.org/pub/OpenBSD/OpenSSH/portable/openssh-7.8p1.tar.gz'>openssh-7.8p1.tar.gz</a>) = 27e267e370315561de96577fccae563bc2c37a60
- SHA256 (<a href='https://cdn.openbsd.org/pub/OpenBSD/OpenSSH/portable/openssh-7.8p1.tar.gz'>openssh-7.8p1.tar.gz</a>) = GkhLsVFSwYO7JRThEqow3TQTjDz7Ay7uVJCmbFBxRMo

Please note that the SHA256 signatures are base64 encoded and not
hexadecimal (which is the default for most checksum tools). The PGP
key used to sign the releases is available as RELEASE_KEY.asc from
the mirror sites.

Reporting Bugs:
===============

- Please read <a href='http://www.openssh.com/report.html'>http://www.openssh.com/report.html</a>
  Security bugs should be reported directly to openssh@openssh.com

</pre><hr>
<h3><a href='txt/release-7.7' id='7.7'>OpenSSH 7.7</a>/<a href='txt/release-7.7' id='7.7p1'>7.7p1</a> (2018-04-02)</h3>
<pre>
OpenSSH 7.7 was released on 2018-04-02. It is available from the
mirrors listed at <a href='https://www.openssh.com/'>https://www.openssh.com/</a>.
OpenSSH is a 100% complete SSH protocol 2.0 implementation and
includes sftp client and server support.

Once again, we would like to thank the OpenSSH community for their
continued support of the project, especially those who contributed
code or patches, reported bugs, tested snapshots or donated to the
project. More information on donations may be found at:
<a href='http://www.openssh.com/donations.html'>http://www.openssh.com/donations.html</a>

Potentially-incompatible changes
================================

This release includes a number of changes that may affect existing
configurations:

 * <a href='https://man.openbsd.org/ssh.1'>ssh(1)</a>/<a href='https://man.openbsd.org/sshd.8'>sshd(8)</a>: Drop compatibility support for some very old SSH
   implementations, including ssh.com &lt;=2.* and OpenSSH &lt;= 3.*. These
   versions were all released in or before 2001 and predate the final
   SSH RFCs. The support in question isn't necessary for RFC-compliant
   SSH implementations.

Changes since OpenSSH 7.6
=========================

This is primarily a bugfix release.

New Features
------------

 * All: Add experimental support for PQC XMSS keys (Extended Hash-
   Based Signatures) based on the algorithm described in
   <a href='https://tools.ietf.org/html/draft-irtf-cfrg-xmss-hash-based-signatures-12'>https://tools.ietf.org/html/draft-irtf-cfrg-xmss-hash-based-signatures-12</a>
   The XMSS signature code is experimental and not compiled in by
   default.

 * <a href='https://man.openbsd.org/sshd.8'>sshd(8)</a>: Add a "rdomain" criteria for the sshd_config Match keyword
   to allow conditional configuration that depends on which routing
   domain a connection was received on (currently supported on OpenBSD
   and Linux).

 * <a href='https://man.openbsd.org/sshd_config.5'>sshd_config(5)</a>: Add an optional rdomain qualifier to the
   ListenAddress directive to allow listening on different routing
   domains. This is supported only on OpenBSD and Linux at present.

 * <a href='https://man.openbsd.org/sshd_config.5'>sshd_config(5)</a>: Add RDomain directive to allow the authenticated
   session to be placed in an explicit routing domain. This is only
   supported on OpenBSD at present.

 * <a href='https://man.openbsd.org/sshd.8'>sshd(8)</a>: Add "expiry-time" option for authorized_keys files to
   allow for expiring keys.

 * <a href='https://man.openbsd.org/ssh.1'>ssh(1)</a>: Add a BindInterface option to allow binding the outgoing
   connection to an interface's address (basically a more usable
   BindAddress)

 * <a href='https://man.openbsd.org/ssh.1'>ssh(1)</a>: Expose device allocated for tun/tap forwarding via a new
   %T expansion for LocalCommand. This allows LocalCommand to be used
   to prepare the interface.

 * <a href='https://man.openbsd.org/sshd.8'>sshd(8)</a>: Expose the device allocated for tun/tap forwarding via a
   new SSH_TUNNEL environment variable. This allows automatic setup of
   the interface and surrounding network configuration automatically on
   the server.

 * <a href='https://man.openbsd.org/ssh.1'>ssh(1)</a>/<a href='https://man.openbsd.org/scp.1'>scp(1)</a>/<a href='https://man.openbsd.org/sftp.1'>sftp(1)</a>: Add URI support to ssh, sftp and scp, e.g.
   ssh://user@host or sftp://user@host/path.  Additional connection
   parameters described in draft-ietf-secsh-scp-sftp-ssh-uri-04 are not
   implemented since the ssh fingerprint format in the draft uses the
   deprecated MD5 hash with no way to specify the any other algorithm.

 * <a href='https://man.openbsd.org/ssh-keygen.1'>ssh-keygen(1)</a>: Allow certificate validity intervals that specify
   only a start or stop time (instead of both or neither).

 * <a href='https://man.openbsd.org/sftp.1'>sftp(1)</a>: Allow "cd" and "lcd" commands with no explicit path
   argument. lcd will change to the local user's home directory as
   usual. cd will change to the starting directory for session (because
   the protocol offers no way to obtain the remote user's home
   directory). <a href='https://bugzilla.mindrot.org/show_bug.cgi?id=2760'>bz#2760</a>

 * <a href='https://man.openbsd.org/sshd.8'>sshd(8)</a>: When doing a config test with sshd -T, only require the
   attributes that are actually used in Match criteria rather than (an
   incomplete list of) all criteria.

Bugfixes
--------

 * <a href='https://man.openbsd.org/ssh.1'>ssh(1)</a>/<a href='https://man.openbsd.org/sshd.8'>sshd(8)</a>: More strictly check signature types during key
   exchange against what was negotiated. Prevents downgrade of RSA
   signatures made with SHA-256/512 to SHA-1.

 * <a href='https://man.openbsd.org/sshd.8'>sshd(8)</a>: Fix support for client that advertise a protocol version
   of "1.99" (indicating that they are prepared to accept both SSHv1 and
   SSHv2). This was broken in OpenSSH 7.6 during the removal of SSHv1
   support. <a href='https://bugzilla.mindrot.org/show_bug.cgi?id=2810'>bz#2810</a>

 * <a href='https://man.openbsd.org/ssh.1'>ssh(1)</a>: Warn when the agent returns a ssh-rsa (SHA1) signature when
   a rsa-sha2-256/512 signature was requested. This condition is possible
   when an old or non-OpenSSH agent is in use. <a href='https://bugzilla.mindrot.org/show_bug.cgi?id=2799'>bz#2799</a>

 * <a href='https://man.openbsd.org/ssh-agent.1'>ssh-agent(1)</a>: Fix regression introduced in 7.6 that caused ssh-agent
   to fatally exit if presented an invalid signature request message.

 * <a href='https://man.openbsd.org/sshd_config.5'>sshd_config(5)</a>: Accept yes/no flag options case-insensitively, as
   has been the case in <a href='https://man.openbsd.org/ssh_config.5'>ssh_config(5)</a> for a long time. <a href='https://bugzilla.mindrot.org/show_bug.cgi?id=2664'>bz#2664</a>

 * <a href='https://man.openbsd.org/ssh.1'>ssh(1)</a>: Improve error reporting for failures during connection.
   Under some circumstances misleading errors were being shown. <a href='https://bugzilla.mindrot.org/show_bug.cgi?id=2814'>bz#2814</a>

 * ssh-keyscan(1): Add -D option to allow printing of results directly
   in SSHFP format. <a href='https://bugzilla.mindrot.org/show_bug.cgi?id=2821'>bz#2821</a>

 * regress tests: fix PuTTY interop test broken in last release's SSHv1
   removal. <a href='https://bugzilla.mindrot.org/show_bug.cgi?id=2823'>bz#2823</a>

 * <a href='https://man.openbsd.org/ssh.1'>ssh(1)</a>: Compatibility fix for some servers that erroneously drop the
   connection when the IUTF8 (<a href='https://tools.ietf.org/html/rfc8160'>RFC8160</a>) option is sent.

 * <a href='https://man.openbsd.org/scp.1'>scp(1)</a>: Disable RemoteCommand and RequestTTY in the ssh session
   started by scp (sftp was already doing this.)

 * <a href='https://man.openbsd.org/ssh-keygen.1'>ssh-keygen(1)</a>: Refuse to create a certificate with an unusable
   number of principals.

 * <a href='https://man.openbsd.org/ssh-keygen.1'>ssh-keygen(1)</a>: Fatally exit if ssh-keygen is unable to write all the
   public key during key generation. Previously it would silently
   ignore errors writing the comment and terminating newline.

 * <a href='https://man.openbsd.org/ssh.1'>ssh(1)</a>: Do not modify hostname arguments that are addresses by
   automatically forcing them to lower-case. Instead canonicalise them
   to resolve ambiguities (e.g. ::0001 =&gt; ::1) before they are matched
   against known_hosts. <a href='https://bugzilla.mindrot.org/show_bug.cgi?id=2763'>bz#2763</a>

 * <a href='https://man.openbsd.org/ssh.1'>ssh(1)</a>: Don't accept junk after "yes" or "no" responses to hostkey
   prompts. <a href='https://bugzilla.mindrot.org/show_bug.cgi?id=2803'>bz#2803</a>

 * <a href='https://man.openbsd.org/sftp.1'>sftp(1)</a>: Have sftp print a warning about shell cleanliness when
   decoding the first packet fails, which is usually caused by shells
   polluting stdout of non-interactive startups. <a href='https://bugzilla.mindrot.org/show_bug.cgi?id=2800'>bz#2800</a>

 * <a href='https://man.openbsd.org/ssh.1'>ssh(1)</a>/<a href='https://man.openbsd.org/sshd.8'>sshd(8)</a>: Switch timers in packet code from using wall-clock
   time to monotonic time, allowing the packet layer to better function
   over a clock step and avoiding possible integer overflows during
   steps.

 * Numerous manual page fixes and improvements.

Portability
-----------

 * <a href='https://man.openbsd.org/sshd.8'>sshd(8)</a>: Correctly detect MIPS ABI in use at configure time. Fixes
   sandbox violations on some environments.

 * <a href='https://man.openbsd.org/sshd.8'>sshd(8)</a>: Remove UNICOS support. The hardware and software are literal
   museum pieces and support in sshd is too intrusive to justify
   maintaining.

 * All: Build and link with "retpoline" flags when available to mitigate
   the "branch target injection" style (variant 2) of the Spectre
   branch-prediction vulnerability.

 * All: Add auto-generated dependency information to Makefile.

 * Numerous fixed to the RPM spec files.

Checksums:
==========

- SHA1 (<a href='https://cdn.openbsd.org/pub/OpenBSD/OpenSSH/openssh-7.7.tar.gz'>openssh-7.7.tar.gz</a>) = 24812e05fa233014c847c7775748316e7f8a836c
- SHA256 (<a href='https://cdn.openbsd.org/pub/OpenBSD/OpenSSH/openssh-7.7.tar.gz'>openssh-7.7.tar.gz</a>) = T4ua1L/vgAYqwB0muRahvnm5ZUr3PLY9nPljaG8egvo=

- SHA1 (<a href='https://cdn.openbsd.org/pub/OpenBSD/OpenSSH/portable/openssh-7.7p1.tar.gz'>openssh-7.7p1.tar.gz</a>) = 446fe9ed171f289f0d62197dffdbfdaaf21c49f2
- SHA256 (<a href='https://cdn.openbsd.org/pub/OpenBSD/OpenSSH/portable/openssh-7.7p1.tar.gz'>openssh-7.7p1.tar.gz</a>) = 1zvn5oTpnvzQJL4Vowv/y+QbASsvezyQhK7WIXdea48=

Please note that the SHA256 signatures are base64 encoded and not
hexadecimal (which is the default for most checksum tools). The PGP
key used to sign the releases is available as RELEASE_KEY.asc from
the mirror sites.

Reporting Bugs:
===============

- Please read <a href='http://www.openssh.com/report.html'>http://www.openssh.com/report.html</a>
  Security bugs should be reported directly to openssh@openssh.com

</pre><hr>
<h3><a href='txt/release-7.6' id='7.6'>OpenSSH 7.6</a>/<a href='txt/release-7.6' id='7.6p1'>7.6p1</a> (2017-10-03)</h3>
<pre>
OpenSSH 7.6 was released on 2017-10-03. It is available from the
mirrors listed at <a href='https://www.openssh.com/'>https://www.openssh.com/</a>.
OpenSSH is a 100% complete SSH protocol 2.0 implementation and
includes sftp client and server support.

Once again, we would like to thank the OpenSSH community for their
continued support of the project, especially those who contributed
code or patches, reported bugs, tested snapshots or donated to the
project. More information on donations may be found at:
<a href='http://www.openssh.com/donations.html'>http://www.openssh.com/donations.html</a>

Potentially-incompatible changes
================================

This release includes a number of changes that may affect existing
configurations:

 * <a href='https://man.openbsd.org/ssh.1'>ssh(1)</a>: delete SSH protocol version 1 support, associated
   configuration options and documentation.

 * <a href='https://man.openbsd.org/ssh.1'>ssh(1)</a>/<a href='https://man.openbsd.org/sshd.8'>sshd(8)</a>: remove support for the hmac-ripemd160 MAC.

 * <a href='https://man.openbsd.org/ssh.1'>ssh(1)</a>/<a href='https://man.openbsd.org/sshd.8'>sshd(8)</a>: remove support for the arcfour, blowfish and CAST
   ciphers.

 * Refuse RSA keys &lt;1024 bits in length and improve reporting for keys
   that do not meet this requirement.

 * <a href='https://man.openbsd.org/ssh.1'>ssh(1)</a>: do not offer CBC ciphers by default.

Changes since OpenSSH 7.5
=========================

This is primarily a bugfix release. It also contains substantial
internal refactoring.

Security
--------

 * <a href='https://man.openbsd.org/sftp-server.8'>sftp-server(8)</a>: in read-only mode, sftp-server was incorrectly
   permitting creation of zero-length files. Reported by Michal
   Zalewski.

New Features
------------

 * <a href='https://man.openbsd.org/ssh.1'>ssh(1)</a>: add RemoteCommand option to specify a command in the ssh
   config file instead of giving it on the client's command line. This
   allows the configuration file to specify the command that will be
   executed on the remote host.

 * <a href='https://man.openbsd.org/sshd.8'>sshd(8)</a>: add ExposeAuthInfo option that enables writing details of
   the authentication methods used (including public keys where
   applicable) to a file that is exposed via a $SSH_USER_AUTH
   environment variable in the subsequent session.

 * <a href='https://man.openbsd.org/ssh.1'>ssh(1)</a>: add support for reverse dynamic forwarding. In this mode,
   ssh will act as a SOCKS4/5 proxy and forward connections
   to destinations requested by the remote SOCKS client. This mode
   is requested using extended syntax for the -R and RemoteForward
   options and, because it is implemented solely at the client,
   does not require the server be updated to be supported.

 * <a href='https://man.openbsd.org/sshd.8'>sshd(8)</a>: allow LogLevel directive in sshd_config Match blocks;
   <a href='https://bugzilla.mindrot.org/show_bug.cgi?id=2717'>bz#2717</a>

 * <a href='https://man.openbsd.org/ssh-keygen.1'>ssh-keygen(1)</a>: allow inclusion of arbitrary string or flag
   certificate extensions and critical options.

 * <a href='https://man.openbsd.org/ssh-keygen.1'>ssh-keygen(1)</a>: allow ssh-keygen to use a key held in ssh-agent as
   a CA when signing certificates. <a href='https://bugzilla.mindrot.org/show_bug.cgi?id=2377'>bz#2377</a>

 * <a href='https://man.openbsd.org/ssh.1'>ssh(1)</a>/<a href='https://man.openbsd.org/sshd.8'>sshd(8)</a>: allow IPQoS=none in ssh/sshd to not set an explicit
   ToS/DSCP value and just use the operating system default.

 * <a href='https://man.openbsd.org/ssh-add.1'>ssh-add(1)</a>: added -q option to make ssh-add quiet on success.

 * <a href='https://man.openbsd.org/ssh.1'>ssh(1)</a>: expand the StrictHostKeyChecking option with two new
   settings. The first "accept-new" will automatically accept
   hitherto-unseen keys but will refuse connections for changed or
   invalid hostkeys. This is a safer subset of the current behaviour
   of StrictHostKeyChecking=no. The second setting "off", is a synonym
   for the current behaviour of StrictHostKeyChecking=no: accept new
   host keys, and continue connection for hosts with incorrect
   hostkeys. A future release will change the meaning of
   StrictHostKeyChecking=no to the behaviour of "accept-new". <a href='https://bugzilla.mindrot.org/show_bug.cgi?id=2400'>bz#2400</a>

 * <a href='https://man.openbsd.org/ssh.1'>ssh(1)</a>: add SyslogFacility option to <a href='https://man.openbsd.org/ssh.1'>ssh(1)</a> matching the equivalent
   option in <a href='https://man.openbsd.org/sshd.8'>sshd(8)</a>. <a href='https://bugzilla.mindrot.org/show_bug.cgi?id=2705'>bz#2705</a>

Bugfixes
--------

 * <a href='https://man.openbsd.org/ssh.1'>ssh(1)</a>: use HostKeyAlias if specified instead of hostname for
   matching host certificate principal names; <a href='https://bugzilla.mindrot.org/show_bug.cgi?id=2728'>bz#2728</a>

 * <a href='https://man.openbsd.org/sftp.1'>sftp(1)</a>: implement sorting for globbed ls; <a href='https://bugzilla.mindrot.org/show_bug.cgi?id=2649'>bz#2649</a>

 * <a href='https://man.openbsd.org/ssh.1'>ssh(1)</a>: add a user@host prefix to client's "Permission denied"
   messages, useful in particular when using "stacked" connections
   (e.g. ssh -J) where it's not clear which host is denying. <a href='https://bugzilla.mindrot.org/show_bug.cgi?id=2720'>bz#2720</a>

 * <a href='https://man.openbsd.org/ssh.1'>ssh(1)</a>: accept unknown EXT_INFO extension values that contain \0
   characters. These are legal, but would previously cause fatal
   connection errors if received.

 * <a href='https://man.openbsd.org/ssh.1'>ssh(1)</a>/<a href='https://man.openbsd.org/sshd.8'>sshd(8)</a>: repair compression statistics printed at
   connection exit

 * <a href='https://man.openbsd.org/sftp.1'>sftp(1)</a>: print '?' instead of incorrect link count (that the
   protocol doesn't provide) for remote listings. <a href='https://bugzilla.mindrot.org/show_bug.cgi?id=2710'>bz#2710</a>

 * <a href='https://man.openbsd.org/ssh.1'>ssh(1)</a>: return failure rather than fatal() for more cases during
   session multiplexing negotiations. Causes the session to fall back
   to a non-mux connection if they occur. <a href='https://bugzilla.mindrot.org/show_bug.cgi?id=2707'>bz#2707</a>

 * <a href='https://man.openbsd.org/ssh.1'>ssh(1)</a>: mention that the server may send debug messages to explain
   public key authentication problems under some circumstances; <a href='https://bugzilla.mindrot.org/show_bug.cgi?id=2709'>bz#2709</a>

 * Translate OpenSSL error codes to better report incorrect passphrase
   errors when loading private keys; <a href='https://bugzilla.mindrot.org/show_bug.cgi?id=2699'>bz#2699</a>

 * <a href='https://man.openbsd.org/sshd.8'>sshd(8)</a>: adjust compatibility patterns for WinSCP to correctly
   identify versions that implement only the legacy DH group exchange
   scheme. <a href='https://bugzilla.mindrot.org/show_bug.cgi?id=2748'>bz#2748</a>

 * <a href='https://man.openbsd.org/ssh.1'>ssh(1)</a>: print the "Killed by signal 1" message only at LogLevel
   verbose so that it is not shown at the default level; prevents it
   from appearing during ssh -J and equivalent ProxyCommand configs.
   <a href='https://bugzilla.mindrot.org/show_bug.cgi?id=1906'>bz#1906</a>, <a href='https://bugzilla.mindrot.org/show_bug.cgi?id=2744'>bz#2744</a>

 * <a href='https://man.openbsd.org/ssh-keygen.1'>ssh-keygen(1)</a>: when generating all hostkeys (ssh-keygen -A), clobber
   existing keys if they exist but are zero length. zero-length keys
   could previously be made if ssh-keygen failed or was interrupted part
   way through generating them. <a href='https://bugzilla.mindrot.org/show_bug.cgi?id=2561'>bz#2561</a>

 * <a href='https://man.openbsd.org/ssh.1'>ssh(1)</a>: fix pledge(2) violation in the escape sequence "~&" used to
   place the current session in the background.

 * ssh-keyscan(1): avoid double-close() on file descriptors; <a href='https://bugzilla.mindrot.org/show_bug.cgi?id=2734'>bz#2734</a>

 * <a href='https://man.openbsd.org/sshd.8'>sshd(8)</a>: avoid reliance on shared use of pointers shared between
   monitor and child sshd processes. <a href='https://bugzilla.mindrot.org/show_bug.cgi?id=2704'>bz#2704</a>

 * <a href='https://man.openbsd.org/sshd_config.8'>sshd_config(8)</a>: document available AuthenticationMethods; <a href='https://bugzilla.mindrot.org/show_bug.cgi?id=2453'>bz#2453</a>

 * <a href='https://man.openbsd.org/ssh.1'>ssh(1)</a>: avoid truncation in some login prompts; <a href='https://bugzilla.mindrot.org/show_bug.cgi?id=2768'>bz#2768</a>

 * <a href='https://man.openbsd.org/sshd.8'>sshd(8)</a>: Fix various compilations failures, inc <a href='https://bugzilla.mindrot.org/show_bug.cgi?id=2767'>bz#2767</a>

 * <a href='https://man.openbsd.org/ssh.1'>ssh(1)</a>: make "--" before the hostname terminate argument processing
   after the hostname too.

 * <a href='https://man.openbsd.org/ssh-keygen.1'>ssh-keygen(1)</a>: switch from aes256-cbc to aes256-ctr for encrypting
   new-style private keys. Fixes problems related to private key
   handling for no-OpenSSL builds. <a href='https://bugzilla.mindrot.org/show_bug.cgi?id=2754'>bz#2754</a>

 * <a href='https://man.openbsd.org/ssh.1'>ssh(1)</a>: warn and do not attempt to use keys when the public and
   private halves do not match. <a href='https://bugzilla.mindrot.org/show_bug.cgi?id=2737'>bz#2737</a>

 * <a href='https://man.openbsd.org/sftp.1'>sftp(1)</a>: don't print verbose error message when ssh disconnects
   from under sftp. <a href='https://bugzilla.mindrot.org/show_bug.cgi?id=2750'>bz#2750</a>

 * <a href='https://man.openbsd.org/sshd.8'>sshd(8)</a>: fix keepalive scheduling problem: activity on a forwarded
   port from preventing the keepalive from being sent; <a href='https://bugzilla.mindrot.org/show_bug.cgi?id=2756'>bz#2756</a>

 * <a href='https://man.openbsd.org/sshd.8'>sshd(8)</a>: when started without root privileges, don't require the
   privilege separation user or path to exist. Makes running the
   regression tests easier without touching the filesystem.

 * Make integrity.sh regression tests more robust against timeouts.
   <a href='https://bugzilla.mindrot.org/show_bug.cgi?id=2658'>bz#2658</a>

 * <a href='https://man.openbsd.org/ssh.1'>ssh(1)</a>/<a href='https://man.openbsd.org/sshd.8'>sshd(8)</a>: correctness fix for channels implementation: accept
   channel IDs greater than 0x7FFFFFFF.

Portability
-----------

 * <a href='https://man.openbsd.org/sshd.9'>sshd(9)</a>: drop two more privileges in the Solaris sandbox:
   PRIV_DAX_ACCESS and PRIV_SYS_IB_INFO; <a href='https://bugzilla.mindrot.org/show_bug.cgi?id=2723'>bz#2723</a>

 * <a href='https://man.openbsd.org/sshd.8'>sshd(8)</a>: expose list of completed authentication methods to PAM
   via the SSH_AUTH_INFO_0 PAM environment variable. <a href='https://bugzilla.mindrot.org/show_bug.cgi?id=2408'>bz#2408</a>

 * <a href='https://man.openbsd.org/ssh.1'>ssh(1)</a>/<a href='https://man.openbsd.org/sshd.8'>sshd(8)</a>: fix several problems in the tun/tap forwarding code,
   mostly to do with host/network byte order confusion. <a href='https://bugzilla.mindrot.org/show_bug.cgi?id=2735'>bz#2735</a>

 * Add --with-cflags-after and --with-ldflags-after configure flags to
   allow setting CFLAGS/LDFLAGS after configure has completed. These
   are useful for setting sanitiser/fuzzing options that may interfere
   with configure's operation.

 * <a href='https://man.openbsd.org/sshd.8'>sshd(8)</a>: avoid Linux seccomp violations on ppc64le over the
   socketcall syscall.

 * Fix use of ldns when using ldns-config; <a href='https://bugzilla.mindrot.org/show_bug.cgi?id=2697'>bz#2697</a>

 * configure: set cache variables when cross-compiling. The cross-
   compiling fallback message was saying it assumed the test passed,
   but it wasn't actually set the cache variables and this would
   cause later tests to fail.

 * Add clang libFuzzer harnesses for public key parsing and signature
   verification.

Checksums:
==========

 - SHA1 (<a href='https://cdn.openbsd.org/pub/OpenBSD/OpenSSH/openssh-7.6.tar.gz'>openssh-7.6.tar.gz</a>) = 157fe3989a245c58fcdb34d9fe722a3c4e14c008
 - SHA1 (<a href='https://cdn.openbsd.org/pub/OpenBSD/OpenSSH/portable/openssh-7.6p1.tar.gz'>openssh-7.6p1.tar.gz</a>) = a6984bc2c72192bed015c8b879b35dd9f5350b3b

 - SHA256 (<a href='https://cdn.openbsd.org/pub/OpenBSD/OpenSSH/openssh-7.6.tar.gz'>openssh-7.6.tar.gz</a>) = Xu3bdpCcu65vM2FnW7b6IKLgd4Kvf2P3WBTMw+I7Bao=
 - SHA256 (<a href='https://cdn.openbsd.org/pub/OpenBSD/OpenSSH/portable/openssh-7.6p1.tar.gz'>openssh-7.6p1.tar.gz</a>) = oyPK7t3+FFuqoNsW6Y14Sx+8fdQ2pr8fR539XNHSFyM=

Please note that the SHA256 signatures are base64 encoded and not
hexadecimal (which is the default for most checksum tools). The PGP
key used to sign the releases is available as RELEASE_KEY.asc from
the mirror sites.

Reporting Bugs:
===============

- Please read <a href='http://www.openssh.com/report.html'>http://www.openssh.com/report.html</a>
  Security bugs should be reported directly to openssh@openssh.com

OpenSSH is brought to you by Markus Friedl, Niels Provos, Theo de
Raadt, Kevin Steves, Damien Miller, Darren Tucker, Jason McIntyre,
Tim Rice and Ben Lindstrom.
</pre><hr>
<h3><a href='txt/release-7.5' id='7.5'>OpenSSH 7.5</a>/<a href='txt/release-7.5' id='7.5p1'>7.5p1</a> (2017-03-20)</h3>
<pre>
OpenSSH 7.5 was released on 2017-03-20. It is available from the
mirrors listed at <a href='https://www.openssh.com/'>https://www.openssh.com/</a>.
OpenSSH is a 100% complete SSH protocol 2.0 implementation and
includes sftp client and server support. OpenSSH also includes
transitional support for the legacy SSH 1.3 and 1.5 protocols
that may be enabled at compile-time.

Once again, we would like to thank the OpenSSH community for their
continued support of the project, especially those who contributed
code or patches, reported bugs, tested snapshots or donated to the
project. More information on donations may be found at:
<a href='http://www.openssh.com/donations.html'>http://www.openssh.com/donations.html</a>

Future deprecation notice
=========================

We plan on retiring more legacy cryptography in future releases,
specifically:

 * In the next major release (expected June-August), removing remaining
   support for the SSH v.1 protocol (currently client-only and compile-
   time disabled).

 * In the same release, removing support for Blowfish and RC4 ciphers
   and the RIPE-MD160 HMAC. (These are currently run-time disabled).

 * In the same release, removing the remaining CBC ciphers from being
   offered by default in the client (These have not been offered in
   sshd by default for several years).

 * Refusing all RSA keys smaller than 1024 bits (the current minimum
   is 768 bits)

This list reflects our current intentions, but please check the final
release notes for future releases.

Potentially-incompatible changes
================================

This release includes a number of changes that may affect existing
configurations:

 * This release deprecates the sshd_config UsePrivilegeSeparation
   option, thereby making privilege separation mandatory. Privilege
   separation has been on by default for almost 15 years and
   sandboxing has been on by default for almost the last five.

 * The format of several log messages emitted by the packet code has
   changed to include additional information about the user and
   their authentication state. Software that monitors ssh/sshd logs
   may need to account for these changes. For example:

   Connection closed by user x 1.1.1.1 port 1234 [preauth]
   Connection closed by authenticating user x 10.1.1.1 port 1234 [preauth]
   Connection closed by invalid user x 1.1.1.1 port 1234 [preauth]

   Affected messages include connection closure, timeout, remote
   disconnection, negotiation failure and some other fatal messages
   generated by the packet code.

 * [Portable OpenSSH only] This version removes support for building
   against OpenSSL versions prior to 1.0.1. OpenSSL stopped supporting
   versions prior to 1.0.1 over 12 months ago (i.e. they no longer
   receive fixes for security bugs).

Changes since OpenSSH 7.4
=========================

This is a bugfix release.

Security
--------

 * <a href='https://man.openbsd.org/ssh.1'>ssh(1)</a>, <a href='https://man.openbsd.org/sshd.8'>sshd(8)</a>: Fix weakness in CBC padding oracle countermeasures
   that allowed a variant of the attack fixed in OpenSSH 7.3 to proceed.
   Note that the OpenSSH client disables CBC ciphers by default, sshd
   offers them as lowest-preference options and will remove them by
   default entriely in the next release. Reported by Jean Paul
   Degabriele, Kenny Paterson, Martin Albrecht and Torben Hansen of
   Royal Holloway, University of London.

 * sftp-client(1): [portable OpenSSH only] On Cygwin, a client making
   a recursive file transfer could be maniuplated by a hostile server to
   perform a path-traversal attack. creating or modifying files outside
   of the intended target directory. Reported by Jann Horn of Google
   Project Zero.

New Features
------------

 * <a href='https://man.openbsd.org/ssh.1'>ssh(1)</a>, <a href='https://man.openbsd.org/sshd.8'>sshd(8)</a>: Support "=-" syntax to easily remove methods from
   algorithm lists, e.g. Ciphers=-*cbc. <a href='https://bugzilla.mindrot.org/show_bug.cgi?id=2671'>bz#2671</a>

Bugfixes
--------

 * <a href='https://man.openbsd.org/sshd.1'>sshd(1)</a>: Fix NULL dereference crash when key exchange start
   messages are sent out of sequence.

 * <a href='https://man.openbsd.org/ssh.1'>ssh(1)</a>, <a href='https://man.openbsd.org/sshd.8'>sshd(8)</a>: Allow form-feed characters to appear in
   configuration files.
 
 * <a href='https://man.openbsd.org/sshd.8'>sshd(8)</a>: Fix regression in OpenSSH 7.4 support for the
   server-sig-algs extension, where SHA2 RSA signature methods were
   not being correctly advertised. <a href='https://bugzilla.mindrot.org/show_bug.cgi?id=2680'>bz#2680</a>

 * <a href='https://man.openbsd.org/ssh.1'>ssh(1)</a>, <a href='https://man.openbsd.org/ssh-keygen.1'>ssh-keygen(1)</a>: Fix a number of case-sensitivity bugs in
   known_hosts processing. <a href='https://bugzilla.mindrot.org/show_bug.cgi?id=2591'>bz#2591</a> <a href='https://bugzilla.mindrot.org/show_bug.cgi?id=2685'>bz#2685</a>

 * <a href='https://man.openbsd.org/ssh.1'>ssh(1)</a>: Allow ssh to use certificates accompanied by a private key
   file but no corresponding plain *.pub public key. <a href='https://bugzilla.mindrot.org/show_bug.cgi?id=2617'>bz#2617</a>

 * <a href='https://man.openbsd.org/ssh.1'>ssh(1)</a>: When updating hostkeys using the UpdateHostKeys option,
   accept RSA keys if HostkeyAlgorithms contains any RSA keytype.
   Previously, ssh could ignore RSA keys when only the ssh-rsa-sha2-*
   methods were enabled in HostkeyAlgorithms and not the old ssh-rsa
   method. <a href='https://bugzilla.mindrot.org/show_bug.cgi?id=2650'>bz#2650</a>
    
 * <a href='https://man.openbsd.org/ssh.1'>ssh(1)</a>: Detect and report excessively long configuration file
   lines. <a href='https://bugzilla.mindrot.org/show_bug.cgi?id=2651'>bz#2651</a>

 * Merge a number of fixes found by Coverity and reported via Redhat
   and FreeBSD. Includes fixes for some memory and file descriptor
   leaks in error paths. <a href='https://bugzilla.mindrot.org/show_bug.cgi?id=2687'>bz#2687</a>
    
 * ssh-keyscan(1): Correctly hash hosts with a port number. <a href='https://bugzilla.mindrot.org/show_bug.cgi?id=2692'>bz#2692</a>

 * <a href='https://man.openbsd.org/ssh.1'>ssh(1)</a>, <a href='https://man.openbsd.org/sshd.8'>sshd(8)</a>: When logging long messages to stderr, don't truncate
   "\r\n" if the length of the message exceeds the buffer. <a href='https://bugzilla.mindrot.org/show_bug.cgi?id=2688'>bz#2688</a>

 * <a href='https://man.openbsd.org/ssh.1'>ssh(1)</a>: Fully quote [host]:port in generated ProxyJump/-J command-
   line; avoid confusion over IPv6 addresses and shells that treat
   square bracket characters specially.
    
 * <a href='https://man.openbsd.org/ssh-keygen.1'>ssh-keygen(1)</a>: Fix corruption of known_hosts when running
   "ssh-keygen -H" on a known_hosts containing already-hashed entries.

 * Fix various fallout and sharp edges caused by removing SSH protocol
   1 support from the server, including the server banner string being
   incorrectly terminated with only \n (instead of \r\n), confusing
   error messages from ssh-keyscan <a href='https://bugzilla.mindrot.org/show_bug.cgi?id=2583'>bz#2583</a> and a segfault in sshd
   if protocol v.1 was enabled for the client and sshd_config
   contained references to legacy keys <a href='https://bugzilla.mindrot.org/show_bug.cgi?id=2686'>bz#2686</a>.

 * <a href='https://man.openbsd.org/ssh.1'>ssh(1)</a>, <a href='https://man.openbsd.org/sshd.8'>sshd(8)</a>: Free fd_set on connection timeout. <a href='https://bugzilla.mindrot.org/show_bug.cgi?id=2683'>bz#2683</a>

 * <a href='https://man.openbsd.org/sshd.8'>sshd(8)</a>: Fix Unix domain socket forwarding for root (regression in
   OpenSSH 7.4).
    
 * <a href='https://man.openbsd.org/sftp.1'>sftp(1)</a>: Fix division by zero crash in "df" output when server
   returns zero total filesystem blocks/inodes.
 
 * <a href='https://man.openbsd.org/ssh.1'>ssh(1)</a>, <a href='https://man.openbsd.org/ssh-add.1'>ssh-add(1)</a>, <a href='https://man.openbsd.org/ssh-keygen.1'>ssh-keygen(1)</a>, <a href='https://man.openbsd.org/sshd.8'>sshd(8)</a>: Translate OpenSSL errors
   encountered during key loading to more meaningful error codes.
   <a href='https://bugzilla.mindrot.org/show_bug.cgi?id=2522'>bz#2522</a> <a href='https://bugzilla.mindrot.org/show_bug.cgi?id=2523'>bz#2523</a>

 * <a href='https://man.openbsd.org/ssh-keygen.1'>ssh-keygen(1)</a>: Sanitise escape sequences in key comments sent to
   printf but preserve valid UTF-8 when the locale supports it;
   <a href='https://bugzilla.mindrot.org/show_bug.cgi?id=2520'>bz#2520</a>

 * <a href='https://man.openbsd.org/ssh.1'>ssh(1)</a>, <a href='https://man.openbsd.org/sshd.8'>sshd(8)</a>: Return reason for port forwarding failures where
   feasible rather than always "administratively prohibited". <a href='https://bugzilla.mindrot.org/show_bug.cgi?id=2674'>bz#2674</a>

 * <a href='https://man.openbsd.org/sshd.8'>sshd(8)</a>: Fix deadlock when AuthorizedKeysCommand or
   AuthorizedPrincipalsCommand produces a lot of output and a key is
   matched early. <a href='https://bugzilla.mindrot.org/show_bug.cgi?id=2655'>bz#2655</a>

 * Regression tests: several reliability fixes. <a href='https://bugzilla.mindrot.org/show_bug.cgi?id=2654'>bz#2654</a> <a href='https://bugzilla.mindrot.org/show_bug.cgi?id=2658'>bz#2658</a> <a href='https://bugzilla.mindrot.org/show_bug.cgi?id=2659'>bz#2659</a>
    
 * <a href='https://man.openbsd.org/ssh.1'>ssh(1)</a>: Fix typo in ~C error message for bad port forward
   cancellation. <a href='https://bugzilla.mindrot.org/show_bug.cgi?id=2672'>bz#2672</a>

 * <a href='https://man.openbsd.org/ssh.1'>ssh(1)</a>: Show a useful error message when included config files
   can't be opened; <a href='https://bugzilla.mindrot.org/show_bug.cgi?id=2653'>bz#2653</a>

 * <a href='https://man.openbsd.org/sshd.8'>sshd(8)</a>: Make sshd set GSSAPIStrictAcceptorCheck=yes as the manual page
   (previously incorrectly) advertised. <a href='https://bugzilla.mindrot.org/show_bug.cgi?id=2637'>bz#2637</a>

 * <a href='https://man.openbsd.org/sshd_config.5'>sshd_config(5)</a>: Repair accidentally-deleted mention of %k token
   in AuthorizedKeysCommand; <a href='https://bugzilla.mindrot.org/show_bug.cgi?id=2656'>bz#2656</a>

 * <a href='https://man.openbsd.org/sshd.8'>sshd(8)</a>: Remove vestiges of previously removed LOGIN_PROGRAM; <a href='https://bugzilla.mindrot.org/show_bug.cgi?id=2665'>bz#2665</a>

 * <a href='https://man.openbsd.org/ssh-agent.1'>ssh-agent(1)</a>: Relax PKCS#11 whitelist to include libexec and
   common 32-bit compatibility library directories.

 * sftp-client(1): Fix non-exploitable integer overflow in SSH2_FXP_NAME
   response handling.

 * <a href='https://man.openbsd.org/ssh-agent.1'>ssh-agent(1)</a>: Fix regression in 7.4 of deleting PKCS#11-hosted
   keys. It was not possible to delete them except by specifying
   their full physical path. <a href='https://bugzilla.mindrot.org/show_bug.cgi?id=2682'>bz#2682</a>

Portability
-----------

 * <a href='https://man.openbsd.org/sshd.8'>sshd(8)</a>: Avoid sandbox errors for Linux S390 systems using an ICA
   crypto coprocessor.

 * <a href='https://man.openbsd.org/sshd.8'>sshd(8)</a>: Fix non-exploitable weakness in seccomp-bpf sandbox arg
   inspection.

 * <a href='https://man.openbsd.org/ssh.1'>ssh(1)</a>: Fix X11 forwarding on OSX where X11 was being started by
   launchd. <a href='https://bugzilla.mindrot.org/show_bug.cgi?id=2341'>bz#2341</a>

 * <a href='https://man.openbsd.org/ssh-keygen.1'>ssh-keygen(1)</a>, <a href='https://man.openbsd.org/ssh.1'>ssh(1)</a>, <a href='https://man.openbsd.org/sftp.1'>sftp(1)</a>: Fix output truncation for various that
   contain non-printable characters where the codeset in use is ASCII.

 * build: Fix builds that attempt to link a kerberised libldns. <a href='https://bugzilla.mindrot.org/show_bug.cgi?id=2603'>bz#2603</a>

 * build: Fix compilation problems caused by unconditionally defining
   _XOPEN_SOURCE in wide character detection.

 * <a href='https://man.openbsd.org/sshd.8'>sshd(8)</a>: Fix sandbox violations for clock_gettime VSDO syscall
   fallback on some Linux/X32 kernels. <a href='https://bugzilla.mindrot.org/show_bug.cgi?id=2142'>bz#2142</a>

Checksums:
==========

 - SHA1 (<a href='https://cdn.openbsd.org/pub/OpenBSD/OpenSSH/openssh-7.5.tar.gz'>openssh-7.5.tar.gz</a>) = 81384df377e38551f7659a4c250383d0bbd25341
 - SHA1 (<a href='https://cdn.openbsd.org/pub/OpenBSD/OpenSSH/portable/openssh-7.5p1.tar.gz'>openssh-7.5p1.tar.gz</a>) = 5e8f185d00afb4f4f89801e9b0f8b9cee9d87ebd

 - SHA256 (<a href='https://cdn.openbsd.org/pub/OpenBSD/OpenSSH/openssh-7.5.tar.gz'>openssh-7.5.tar.gz</a>) = Gmk8jOdGdKa7NixUN5J+bTMfeum5Vx8Nv+leAdQNq3U=
 - SHA256 (<a href='https://cdn.openbsd.org/pub/OpenBSD/OpenSSH/portable/openssh-7.5p1.tar.gz'>openssh-7.5p1.tar.gz</a>) = mEbjxfq58FR0ALTSwBeZL5FCIrP9H47ubH3GvF5Z+fA=

Please note that the SHA256 signatures are base64 encoded and not
hexadecimal (which is the default for most checksum tools). The PGP
key used to sign the releases is available as RELEASE_KEY.asc from
the mirror sites.

Reporting Bugs:
===============

- Please read <a href='http://www.openssh.com/report.html'>http://www.openssh.com/report.html</a>
  Security bugs should be reported directly to openssh@openssh.com

OpenSSH is brought to y